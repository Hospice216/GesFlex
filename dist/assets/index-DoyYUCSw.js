var e,t,s,r,a,n,i,o,l,c,d,u,h,m,p,f,x,g,v,y,j,b,w,N,_,k,S,C,T,E,M,P,A,D,O,R,I,L,q,F,z,$,W=e=>{throw TypeError(e)},U=(e,t,s)=>t.has(e)||W("Cannot "+s),V=(e,t,s)=>(U(e,t,"read from private field"),s?s.call(e):t.get(e)),B=(e,t,s)=>t.has(e)?W("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),H=(e,t,s,r)=>(U(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s),Y=(e,t,s)=>(U(e,t,"access private method"),s),G=(e,t,s,r)=>({set _(r){H(e,t,r,s)},get _(){return V(e,t,r)}});import{j as K,P as J,c as Q,a as X,u as Z,B as ee,b as te,d as se,e as re,f as ae,R as ne,g as ie,h as oe,i as le,k as ce,D as de,C as ue,l as he,m as me,n as pe,A as fe,o as xe,S as ge,O as ve,p as ye,q as je,r as be,T as we,s as Ne,t as _e,v as ke,w as Se,x as Ce,y as Te,I as Ee,z as Me,E as Pe,F as Ae,L as De,G as Oe,H as Re,J as Ie,K as Le,M as qe,N as Fe,Q as ze,U as $e,V as We,W as Ue,X as Ve,Y as Be,Z as He,_ as Ye}from"./ui-y_GYLaXr.js";import{a as Ge,r as Ke,R as Je,b as Qe,c as Xe,e as Ze,d as et}from"./vendor-BRxKgMa0.js";import{c as tt,R as st,L as rt,C as at,X as nt,Y as it,T as ot,a as lt,A as ct,b as dt,P as ut,d as ht,e as mt,f as pt,B as ft,g as xt,h as gt,i as vt,j as yt,k as jt,l as bt,m as wt}from"./charts-DRzp865s.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Nt=Ge;$=Nt.createRoot,Nt.hydrateRoot;let _t=0;const kt=new Map,St=e=>{if(kt.has(e))return;const t=setTimeout(()=>{kt.delete(e),Mt({type:"REMOVE_TOAST",toastId:e})},1e6);kt.set(e,t)},Ct=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?St(s):e.toasts.forEach(e=>{St(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},Tt=[];let Et={toasts:[]};function Mt(e){Et=Ct(Et,e),Tt.forEach(e=>{e(Et)})}function Pt({...e}){const t=(_t=(_t+1)%Number.MAX_SAFE_INTEGER,_t.toString()),s=()=>Mt({type:"DISMISS_TOAST",toastId:t});return Mt({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>Mt({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function At(){const[e,t]=Ke.useState(Et);return Ke.useEffect(()=>(Tt.push(t),()=>{const e=Tt.indexOf(t);e>-1&&Tt.splice(e,1)}),[e]),{...e,toast:Pt,dismiss:e=>Mt({type:"DISMISS_TOAST",toastId:e})}}var Dt=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Ot=Ke.forwardRef((e,t)=>K.jsx(J.span,{...e,ref:t,style:{...Dt,...e.style}}));Ot.displayName="VisuallyHidden";var Rt=Ot,It="ToastProvider",[Lt,qt,Ft]=X("Toast"),[zt,$t]=Q("Toast",[Ft]),[Wt,Ut]=zt(It),Vt=e=>{const{__scopeToast:t,label:s="Notification",duration:r=5e3,swipeDirection:a="right",swipeThreshold:n=50,children:i}=e,[o,l]=Ke.useState(null),[c,d]=Ke.useState(0),u=Ke.useRef(!1),h=Ke.useRef(!1);return s.trim(),K.jsx(Lt.Provider,{scope:t,children:K.jsx(Wt,{scope:t,label:s,duration:r,swipeDirection:a,swipeThreshold:n,toastCount:c,viewport:o,onViewportChange:l,onToastAdd:Ke.useCallback(()=>d(e=>e+1),[]),onToastRemove:Ke.useCallback(()=>d(e=>e-1),[]),isFocusedToastEscapeKeyDownRef:u,isClosePausedRef:h,children:i})})};Vt.displayName=It;var Bt="ToastViewport",Ht=["F8"],Yt="toast.viewportPause",Gt="toast.viewportResume",Kt=Ke.forwardRef((e,t)=>{const{__scopeToast:s,hotkey:r=Ht,label:a="Notifications ({hotkey})",...n}=e,i=Ut(Bt,s),o=qt(s),l=Ke.useRef(null),c=Ke.useRef(null),d=Ke.useRef(null),u=Ke.useRef(null),h=Z(t,u,i.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=i.toastCount>0;Ke.useEffect(()=>{const e=e=>{var t;0!==r.length&&r.every(t=>e[t]||e.code===t)&&(null==(t=u.current)||t.focus())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[r]),Ke.useEffect(()=>{const e=l.current,t=u.current;if(p&&e&&t){const s=()=>{if(!i.isClosePausedRef.current){const e=new CustomEvent(Yt);t.dispatchEvent(e),i.isClosePausedRef.current=!0}},r=()=>{if(i.isClosePausedRef.current){const e=new CustomEvent(Gt);t.dispatchEvent(e),i.isClosePausedRef.current=!1}},a=t=>{!e.contains(t.relatedTarget)&&r()},n=()=>{e.contains(document.activeElement)||r()};return e.addEventListener("focusin",s),e.addEventListener("focusout",a),e.addEventListener("pointermove",s),e.addEventListener("pointerleave",n),window.addEventListener("blur",s),window.addEventListener("focus",r),()=>{e.removeEventListener("focusin",s),e.removeEventListener("focusout",a),e.removeEventListener("pointermove",s),e.removeEventListener("pointerleave",n),window.removeEventListener("blur",s),window.removeEventListener("focus",r)}}},[p,i.isClosePausedRef]);const f=Ke.useCallback(({tabbingDirection:e})=>{const t=o().map(t=>{const s=t.ref.current,r=[s,...ms(s)];return"forwards"===e?r:r.reverse()});return("forwards"===e?t.reverse():t).flat()},[o]);return Ke.useEffect(()=>{const e=u.current;if(e){const t=t=>{var s,r,a;const n=t.altKey||t.ctrlKey||t.metaKey;if("Tab"===t.key&&!n){const n=document.activeElement,i=t.shiftKey;if(t.target===e&&i)return void(null==(s=c.current)||s.focus());const o=f({tabbingDirection:i?"backwards":"forwards"}),l=o.findIndex(e=>e===n);ps(o.slice(l+1))?t.preventDefault():i?null==(r=c.current)||r.focus():null==(a=d.current)||a.focus()}};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)}},[o,f]),K.jsxs(ee,{ref:l,role:"region","aria-label":a.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&K.jsx(Qt,{ref:c,onFocusFromOutsideViewport:()=>{ps(f({tabbingDirection:"forwards"}))}}),K.jsx(Lt.Slot,{scope:s,children:K.jsx(J.ol,{tabIndex:-1,...n,ref:h})}),p&&K.jsx(Qt,{ref:d,onFocusFromOutsideViewport:()=>{ps(f({tabbingDirection:"backwards"}))}})]})});Kt.displayName=Bt;var Jt="ToastFocusProxy",Qt=Ke.forwardRef((e,t)=>{const{__scopeToast:s,onFocusFromOutsideViewport:r,...a}=e,n=Ut(Jt,s);return K.jsx(Ot,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:e=>{var t;const s=e.relatedTarget;!(null==(t=n.viewport)?void 0:t.contains(s))&&r()}})});Qt.displayName=Jt;var Xt="Toast",Zt=Ke.forwardRef((e,t)=>{const{forceMount:s,open:r,defaultOpen:a,onOpenChange:n,...i}=e,[o,l]=te({prop:r,defaultProp:a??!0,onChange:n,caller:Xt});return K.jsx(se,{present:s||o,children:K.jsx(ss,{open:o,...i,ref:t,onClose:()=>l(!1),onPause:ae(e.onPause),onResume:ae(e.onResume),onSwipeStart:re(e.onSwipeStart,e=>{e.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:re(e.onSwipeMove,e=>{const{x:t,y:s}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${s}px`)}),onSwipeCancel:re(e.onSwipeCancel,e=>{e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:re(e.onSwipeEnd,e=>{const{x:t,y:s}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${s}px`),l(!1)})})})});Zt.displayName=Xt;var[es,ts]=zt(Xt,{onClose(){}}),ss=Ke.forwardRef((e,t)=>{const{__scopeToast:s,type:r="foreground",duration:a,open:n,onClose:i,onEscapeKeyDown:o,onPause:l,onResume:c,onSwipeStart:d,onSwipeMove:u,onSwipeCancel:h,onSwipeEnd:m,...p}=e,f=Ut(Xt,s),[x,g]=Ke.useState(null),v=Z(t,e=>g(e)),y=Ke.useRef(null),j=Ke.useRef(null),b=a||f.duration,w=Ke.useRef(0),N=Ke.useRef(b),_=Ke.useRef(0),{onToastAdd:k,onToastRemove:S}=f,C=ae(()=>{var e;(null==x?void 0:x.contains(document.activeElement))&&(null==(e=f.viewport)||e.focus()),i()}),T=Ke.useCallback(e=>{e&&e!==1/0&&(window.clearTimeout(_.current),w.current=(new Date).getTime(),_.current=window.setTimeout(C,e))},[C]);Ke.useEffect(()=>{const e=f.viewport;if(e){const t=()=>{T(N.current),null==c||c()},s=()=>{const e=(new Date).getTime()-w.current;N.current=N.current-e,window.clearTimeout(_.current),null==l||l()};return e.addEventListener(Yt,s),e.addEventListener(Gt,t),()=>{e.removeEventListener(Yt,s),e.removeEventListener(Gt,t)}}},[f.viewport,b,l,c,T]),Ke.useEffect(()=>{n&&!f.isClosePausedRef.current&&T(b)},[n,b,f.isClosePausedRef,T]),Ke.useEffect(()=>(k(),()=>S()),[k,S]);const E=Ke.useMemo(()=>x?ds(x):null,[x]);return f.viewport?K.jsxs(K.Fragment,{children:[E&&K.jsx(rs,{__scopeToast:s,role:"status","aria-live":"foreground"===r?"assertive":"polite","aria-atomic":!0,children:E}),K.jsx(es,{scope:s,onClose:C,children:Ge.createPortal(K.jsx(Lt.ItemSlot,{scope:s,children:K.jsx(ne,{asChild:!0,onEscapeKeyDown:re(o,()=>{f.isFocusedToastEscapeKeyDownRef.current||C(),f.isFocusedToastEscapeKeyDownRef.current=!1}),children:K.jsx(J.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":n?"open":"closed","data-swipe-direction":f.swipeDirection,...p,ref:v,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:re(e.onKeyDown,e=>{"Escape"===e.key&&(null==o||o(e.nativeEvent),e.nativeEvent.defaultPrevented||(f.isFocusedToastEscapeKeyDownRef.current=!0,C()))}),onPointerDown:re(e.onPointerDown,e=>{0===e.button&&(y.current={x:e.clientX,y:e.clientY})}),onPointerMove:re(e.onPointerMove,e=>{if(!y.current)return;const t=e.clientX-y.current.x,s=e.clientY-y.current.y,r=Boolean(j.current),a=["left","right"].includes(f.swipeDirection),n=["left","up"].includes(f.swipeDirection)?Math.min:Math.max,i=a?n(0,t):0,o=a?0:n(0,s),l="touch"===e.pointerType?10:2,c={x:i,y:o},h={originalEvent:e,delta:c};r?(j.current=c,us("toast.swipeMove",u,h,{discrete:!1})):hs(c,f.swipeDirection,l)?(j.current=c,us("toast.swipeStart",d,h,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(t)>l||Math.abs(s)>l)&&(y.current=null)}),onPointerUp:re(e.onPointerUp,e=>{const t=j.current,s=e.target;if(s.hasPointerCapture(e.pointerId)&&s.releasePointerCapture(e.pointerId),j.current=null,y.current=null,t){const s=e.currentTarget,r={originalEvent:e,delta:t};hs(t,f.swipeDirection,f.swipeThreshold)?us("toast.swipeEnd",m,r,{discrete:!0}):us("toast.swipeCancel",h,r,{discrete:!0}),s.addEventListener("click",e=>e.preventDefault(),{once:!0})}})})})}),f.viewport)})]}):null}),rs=e=>{const{__scopeToast:t,children:s,...r}=e,a=Ut(Xt,t),[n,i]=Ke.useState(!1),[o,l]=Ke.useState(!1);return function(e=()=>{}){const t=ae(e);oe(()=>{let e=0,s=0;return e=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(e),window.cancelAnimationFrame(s)}},[t])}(()=>i(!0)),Ke.useEffect(()=>{const e=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(e)},[]),o?null:K.jsx(ie,{asChild:!0,children:K.jsx(Ot,{...r,children:n&&K.jsxs(K.Fragment,{children:[a.label," ",s]})})})},as=Ke.forwardRef((e,t)=>{const{__scopeToast:s,...r}=e;return K.jsx(J.div,{...r,ref:t})});as.displayName="ToastTitle";var ns=Ke.forwardRef((e,t)=>{const{__scopeToast:s,...r}=e;return K.jsx(J.div,{...r,ref:t})});ns.displayName="ToastDescription";var is=Ke.forwardRef((e,t)=>{const{altText:s,...r}=e;return s.trim()?K.jsx(cs,{altText:s,asChild:!0,children:K.jsx(ls,{...r,ref:t})}):null});is.displayName="ToastAction";var os="ToastClose",ls=Ke.forwardRef((e,t)=>{const{__scopeToast:s,...r}=e,a=ts(os,s);return K.jsx(cs,{asChild:!0,children:K.jsx(J.button,{type:"button",...r,ref:t,onClick:re(e.onClick,a.onClose)})})});ls.displayName=os;var cs=Ke.forwardRef((e,t)=>{const{__scopeToast:s,altText:r,...a}=e;return K.jsx(J.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...a,ref:t})});function ds(e){const t=[];return Array.from(e.childNodes).forEach(e=>{if(e.nodeType===e.TEXT_NODE&&e.textContent&&t.push(e.textContent),function(e){return e.nodeType===e.ELEMENT_NODE}(e)){const s=e.ariaHidden||e.hidden||"none"===e.style.display,r=""===e.dataset.radixToastAnnounceExclude;if(!s)if(r){const s=e.dataset.radixToastAnnounceAlt;s&&t.push(s)}else t.push(...ds(e))}}),t}function us(e,t,s,{discrete:r}){const a=s.originalEvent.currentTarget,n=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:s});t&&a.addEventListener(e,t,{once:!0}),r?le(a,n):a.dispatchEvent(n)}var hs=(e,t,s=0)=>{const r=Math.abs(e.x),a=Math.abs(e.y),n=r>a;return"left"===t||"right"===t?n&&r>s:!n&&a>s};function ms(e){const t=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)t.push(s.currentNode);return t}function ps(e){const t=document.activeElement;return e.some(e=>e===t||(e.focus(),document.activeElement!==t))}var fs=Vt,xs=Kt,gs=Zt,vs=as,ys=ns,js=is,bs=ls;const ws=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,Ns=tt,_s=(e,t)=>s=>{var r;if(null==(null==t?void 0:t.variants))return Ns(e,null==s?void 0:s.class,null==s?void 0:s.className);const{variants:a,defaultVariants:n}=t,i=Object.keys(a).map(e=>{const t=null==s?void 0:s[e],r=null==n?void 0:n[e];if(null===t)return null;const i=ws(t)||ws(r);return a[e][i]}),o=s&&Object.entries(s).reduce((e,t)=>{let[s,r]=t;return void 0===r||(e[s]=r),e},{}),l=null==t||null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:s,className:r,...a}=t;return Object.entries(a).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...o}[t]):{...n,...o}[t]===s})?[...e,s,r]:e},[]);return Ns(e,i,l,null==s?void 0:s.class,null==s?void 0:s.className)};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var ks={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=(e,t)=>{const s=Ke.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:i="",children:o,...l},c)=>{return Ke.createElement("svg",{ref:c,...ks,width:r,height:r,stroke:s,strokeWidth:n?24*Number(a)/Number(r):a,className:["lucide",`lucide-${d=e,d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,i].join(" "),...l},[...t.map(([e,t])=>Ke.createElement(e,t)),...Array.isArray(o)?o:[o]]);var d});return s.displayName=`${e}`,s},Cs=Ss("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ts=Ss("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Es=Ss("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),Ms=Ss("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Ps=Ss("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),As=Ss("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Ds=Ss("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Os=Ss("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Rs=Ss("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Is=Ss("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ls=Ss("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),qs=Ss("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Fs=Ss("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),zs=Ss("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),$s=Ss("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Ws=Ss("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Us=Ss("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Vs=Ss("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Bs=Ss("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Hs=Ss("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),Ys=Ss("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Gs=Ss("Dice6",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),Ks=Ss("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Js=Ss("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Qs=Ss("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Xs=Ss("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Zs=Ss("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),er=Ss("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]),tr=Ss("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),sr=Ss("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),rr=Ss("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ar=Ss("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),nr=Ss("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),ir=Ss("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),or=Ss("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),lr=Ss("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),cr=Ss("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),dr=Ss("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),ur=Ss("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),hr=Ss("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}]]),mr=Ss("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),pr=Ss("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),fr=Ss("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),xr=Ss("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),gr=Ss("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),vr=Ss("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),yr=Ss("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),jr=Ss("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),br=Ss("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),wr=Ss("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Nr=Ss("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),_r=Ss("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),kr=Ss("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Sr=Ss("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),Cr=Ss("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Tr=Ss("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Er=Ss("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Mr=Ss("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Pr=Ss("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),Ar=Ss("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Dr=Ss("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Or=Ss("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Rr=Ss("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ir=Ss("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]),Lr=Ss("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),qr=Ss("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Fr=Ss("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),zr=e=>{const t=Vr(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{const s=e.split("-");return""===s[0]&&1!==s.length&&s.shift(),$r(s,t)||Ur(e)},getConflictingClassGroupIds:(e,t)=>{const a=s[e]||[];return t&&r[e]?[...a,...r[e]]:a}}},$r=(e,t)=>{var s;if(0===e.length)return t.classGroupId;const r=e[0],a=t.nextPart.get(r),n=a?$r(e.slice(1),a):void 0;if(n)return n;if(0===t.validators.length)return;const i=e.join("-");return null==(s=t.validators.find(({validator:e})=>e(i)))?void 0:s.classGroupId},Wr=/^\[(.+)\]$/,Ur=e=>{if(Wr.test(e)){const t=Wr.exec(e)[1],s=null==t?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},Vr=e=>{const{theme:t,prefix:s}=e,r={nextPart:new Map,validators:[]};return Gr(Object.entries(e.classGroups),s).forEach(([e,s])=>{Br(s,r,e,t)}),r},Br=(e,t,s,r)=>{e.forEach(e=>{if("string"==typeof e){return void((""===e?t:Hr(t,e)).classGroupId=s)}if("function"==typeof e)return Yr(e)?void Br(e(r),t,s,r):void t.validators.push({validator:e,classGroupId:s});Object.entries(e).forEach(([e,a])=>{Br(a,Hr(t,e),s,r)})})},Hr=(e,t)=>{let s=e;return t.split("-").forEach(e=>{s.nextPart.has(e)||s.nextPart.set(e,{nextPart:new Map,validators:[]}),s=s.nextPart.get(e)}),s},Yr=e=>e.isThemeGetter,Gr=(e,t)=>t?e.map(([e,s])=>[e,s.map(e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,s])=>[t+e,s])):e)]):e,Kr=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,r=new Map;const a=(a,n)=>{s.set(a,n),t++,t>e&&(t=0,r=s,s=new Map)};return{get(e){let t=s.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(a(e,t),t):void 0},set(e,t){s.has(e)?s.set(e,t):a(e,t)}}},Jr=e=>{const{separator:t,experimentalParseClassName:s}=e,r=1===t.length,a=t[0],n=t.length,i=e=>{const s=[];let i,o=0,l=0;for(let u=0;u<e.length;u++){let c=e[u];if(0===o){if(c===a&&(r||e.slice(u,u+n)===t)){s.push(e.slice(l,u)),l=u+n;continue}if("/"===c){i=u;continue}}"["===c?o++:"]"===c&&o--}const c=0===s.length?e:e.substring(l),d=c.startsWith("!");return{modifiers:s,hasImportantModifier:d,baseClassName:d?c.substring(1):c,maybePostfixModifierPosition:i&&i>l?i-l:void 0}};return s?e=>s({className:e,parseClassName:i}):i},Qr=e=>{if(e.length<=1)return e;const t=[];let s=[];return e.forEach(e=>{"["===e[0]?(t.push(...s.sort(),e),s=[]):s.push(e)}),t.push(...s.sort()),t},Xr=/\s+/;function Zr(){let e,t,s=0,r="";for(;s<arguments.length;)(e=arguments[s++])&&(t=ea(e))&&(r&&(r+=" "),r+=t);return r}const ea=e=>{if("string"==typeof e)return e;let t,s="";for(let r=0;r<e.length;r++)e[r]&&(t=ea(e[r]))&&(s&&(s+=" "),s+=t);return s};function ta(e,...t){let s,r,a,n=function(o){const l=t.reduce((e,t)=>t(e),e());return s=(e=>({cache:Kr(e.cacheSize),parseClassName:Jr(e),...zr(e)}))(l),r=s.cache.get,a=s.cache.set,n=i,i(o)};function i(e){const t=r(e);if(t)return t;const n=((e,t)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:a}=t,n=[],i=e.trim().split(Xr);let o="";for(let l=i.length-1;l>=0;l-=1){const e=i[l],{modifiers:t,hasImportantModifier:c,baseClassName:d,maybePostfixModifierPosition:u}=s(e);let h=Boolean(u),m=r(h?d.substring(0,u):d);if(!m){if(!h){o=e+(o.length>0?" "+o:o);continue}if(m=r(d),!m){o=e+(o.length>0?" "+o:o);continue}h=!1}const p=Qr(t).join(":"),f=c?p+"!":p,x=f+m;if(n.includes(x))continue;n.push(x);const g=a(m,h);for(let s=0;s<g.length;++s){const e=g[s];n.push(f+e)}o=e+(o.length>0?" "+o:o)}return o})(e,s);return a(e,n),n}return function(){return n(Zr.apply(null,arguments))}}const sa=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},ra=/^\[(?:([a-z-]+):)?(.+)\]$/i,aa=/^\d+\/\d+$/,na=new Set(["px","full","screen"]),ia=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,oa=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,la=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ca=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,da=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ua=e=>ma(e)||na.has(e)||aa.test(e),ha=e=>Sa(e,"length",Ca),ma=e=>Boolean(e)&&!Number.isNaN(Number(e)),pa=e=>Sa(e,"number",ma),fa=e=>Boolean(e)&&Number.isInteger(Number(e)),xa=e=>e.endsWith("%")&&ma(e.slice(0,-1)),ga=e=>ra.test(e),va=e=>ia.test(e),ya=new Set(["length","size","percentage"]),ja=e=>Sa(e,ya,Ta),ba=e=>Sa(e,"position",Ta),wa=new Set(["image","url"]),Na=e=>Sa(e,wa,Ma),_a=e=>Sa(e,"",Ea),ka=()=>!0,Sa=(e,t,s)=>{const r=ra.exec(e);return!!r&&(r[1]?"string"==typeof t?r[1]===t:t.has(r[1]):s(r[2]))},Ca=e=>oa.test(e)&&!la.test(e),Ta=()=>!1,Ea=e=>ca.test(e),Ma=e=>da.test(e),Pa=ta(()=>{const e=sa("colors"),t=sa("spacing"),s=sa("blur"),r=sa("brightness"),a=sa("borderColor"),n=sa("borderRadius"),i=sa("borderSpacing"),o=sa("borderWidth"),l=sa("contrast"),c=sa("grayscale"),d=sa("hueRotate"),u=sa("invert"),h=sa("gap"),m=sa("gradientColorStops"),p=sa("gradientColorStopPositions"),f=sa("inset"),x=sa("margin"),g=sa("opacity"),v=sa("padding"),y=sa("saturate"),j=sa("scale"),b=sa("sepia"),w=sa("skew"),N=sa("space"),_=sa("translate"),k=()=>["auto",ga,t],S=()=>[ga,t],C=()=>["",ua,ha],T=()=>["auto",ma,ga],E=()=>["","0",ga],M=()=>[ma,ga];return{cacheSize:500,separator:":",theme:{colors:[ka],spacing:[ua,ha],blur:["none","",va,ga],brightness:M(),borderColor:[e],borderRadius:["none","","full",va,ga],borderSpacing:S(),borderWidth:C(),contrast:M(),grayscale:E(),hueRotate:M(),invert:E(),gap:S(),gradientColorStops:[e],gradientColorStopPositions:[xa,ha],inset:k(),margin:k(),opacity:M(),padding:S(),saturate:M(),scale:M(),sepia:E(),skew:M(),space:S(),translate:S()},classGroups:{aspect:[{aspect:["auto","square","video",ga]}],container:["container"],columns:[{columns:[va]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",ga]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[f]}],"inset-x":[{"inset-x":[f]}],"inset-y":[{"inset-y":[f]}],start:[{start:[f]}],end:[{end:[f]}],top:[{top:[f]}],right:[{right:[f]}],bottom:[{bottom:[f]}],left:[{left:[f]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",fa,ga]}],basis:[{basis:k()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ga]}],grow:[{grow:E()}],shrink:[{shrink:E()}],order:[{order:["first","last","none",fa,ga]}],"grid-cols":[{"grid-cols":[ka]}],"col-start-end":[{col:["auto",{span:["full",fa,ga]},ga]}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":[ka]}],"row-start-end":[{row:["auto",{span:[fa,ga]},ga]}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ga]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ga]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ga,t]}],"min-w":[{"min-w":[ga,t,"min","max","fit"]}],"max-w":[{"max-w":[ga,t,"none","full","min","max","fit","prose",{screen:[va]},va]}],h:[{h:[ga,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ga,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ga,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ga,t,"auto","min","max","fit"]}],"font-size":[{text:["base",va,ha]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",pa]}],"font-family":[{font:[ka]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ga]}],"line-clamp":[{"line-clamp":["none",ma,pa]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ua,ga]}],"list-image":[{"list-image":["none",ga]}],"list-style-type":[{list:["none","disc","decimal",ga]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ua,ha]}],"underline-offset":[{"underline-offset":["auto",ua,ga]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ga]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ga]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",ba]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ja]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Na]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[n]}],"rounded-s":[{"rounded-s":[n]}],"rounded-e":[{"rounded-e":[n]}],"rounded-t":[{"rounded-t":[n]}],"rounded-r":[{"rounded-r":[n]}],"rounded-b":[{"rounded-b":[n]}],"rounded-l":[{"rounded-l":[n]}],"rounded-ss":[{"rounded-ss":[n]}],"rounded-se":[{"rounded-se":[n]}],"rounded-ee":[{"rounded-ee":[n]}],"rounded-es":[{"rounded-es":[n]}],"rounded-tl":[{"rounded-tl":[n]}],"rounded-tr":[{"rounded-tr":[n]}],"rounded-br":[{"rounded-br":[n]}],"rounded-bl":[{"rounded-bl":[n]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[ua,ga]}],"outline-w":[{outline:[ua,ha]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:C()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[ua,ha]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",va,_a]}],"shadow-color":[{shadow:[ka]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",va,ga]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[u]}],saturate:[{saturate:[y]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ga]}],duration:[{duration:M()}],ease:[{ease:["linear","in","out","in-out",ga]}],delay:[{delay:M()}],animate:[{animate:["none","spin","ping","pulse","bounce",ga]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[fa,ga]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[w]}],"skew-y":[{"skew-y":[w]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ga]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ga]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ga]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ua,ha,pa]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}});function Aa(...e){return Pa(tt(e))}const Da=fs,Oa=Ke.forwardRef(({className:e,...t},s)=>K.jsx(xs,{ref:s,className:Aa("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Oa.displayName=xs.displayName;const Ra=_s("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ia=Ke.forwardRef(({className:e,variant:t,...s},r)=>K.jsx(gs,{ref:r,className:Aa(Ra({variant:t}),e),...s}));Ia.displayName=gs.displayName;Ke.forwardRef(({className:e,...t},s)=>K.jsx(js,{ref:s,className:Aa("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t})).displayName=js.displayName;const La=Ke.forwardRef(({className:e,...t},s)=>K.jsx(bs,{ref:s,className:Aa("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:K.jsx(qr,{className:"h-4 w-4"})}));La.displayName=bs.displayName;const qa=Ke.forwardRef(({className:e,...t},s)=>K.jsx(vs,{ref:s,className:Aa("text-sm font-semibold",e),...t}));qa.displayName=vs.displayName;const Fa=Ke.forwardRef(({className:e,...t},s)=>K.jsx(ys,{ref:s,className:Aa("text-sm opacity-90",e),...t}));function za(){const{toasts:e}=At();return K.jsxs(Da,{children:[e.map(function({id:e,title:t,description:s,action:r,...a}){return K.jsxs(Ia,{...a,children:[K.jsxs("div",{className:"grid gap-1",children:[t&&K.jsx(qa,{children:t}),s&&K.jsx(Fa,{children:s})]}),r,K.jsx(La,{})]},e)}),K.jsx(Oa,{})]})}Fa.displayName=ys.displayName;var $a=(e,t,s,r,a,n,i,o)=>{let l=document.documentElement,c=["light","dark"];function d(t){(Array.isArray(e)?e:[e]).forEach(e=>{let s="class"===e,r=s&&n?a.map(e=>n[e]||e):a;s?(l.classList.remove(...r),l.classList.add(n&&n[t]?n[t]:t)):l.setAttribute(e,t)}),function(e){o&&c.includes(e)&&(l.style.colorScheme=e)}(t)}if(r)d(r);else try{let e=localStorage.getItem(t)||s;d(i&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e)}catch(u){}},Wa=Ke.createContext(void 0),Ua={setTheme:e=>{},themes:[]};Ke.memo(({forcedTheme:e,storageKey:t,attribute:s,enableSystem:r,enableColorScheme:a,defaultTheme:n,value:i,themes:o,nonce:l,scriptProps:c})=>{let d=JSON.stringify([s,t,n,e,o,i,r,a]).slice(1,-1);return Ke.createElement("script",{...c,suppressHydrationWarning:!0,nonce:"undefined"==typeof window?l:"",dangerouslySetInnerHTML:{__html:`(${$a.toString()})(${d})`}})});const Va=Array(12).fill(0),Ba=({visible:e,className:t})=>Je.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Je.createElement("div",{className:"sonner-spinner"},Va.map((e,t)=>Je.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),Ha=Je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Je.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Ya=Je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Je.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Ga=Je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ka=Je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ja=Je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Je.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Je.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}));let Qa=1;const Xa=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:s,...r}=e,a="number"==typeof(null==e?void 0:e.id)||(null==(t=e.id)?void 0:t.length)>0?e.id:Qa++,n=this.toasts.find(e=>e.id===a),i=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),n?this.toasts=this.toasts.map(t=>t.id===a?(this.publish({...t,...e,id:a,title:s}),{...t,...e,id:a,dismissible:i,title:s}):t):this.addToast({title:s,...r,dismissible:i,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let s;void 0!==t.loading&&(s=this.create({...t,promise:e,type:"loading",message:t.loading,description:"function"!=typeof t.description?t.description:void 0}));const r=Promise.resolve(e instanceof Function?e():e);let a,n=void 0!==s;const i=r.then(async e=>{a=["resolve",e];if(Je.isValidElement(e))n=!1,this.create({id:s,type:"default",message:e});else if(Za(e)&&!e.ok){n=!1;const r="function"==typeof t.error?await t.error(`HTTP error! status: ${e.status}`):t.error,a="function"==typeof t.description?await t.description(`HTTP error! status: ${e.status}`):t.description,i="object"==typeof r&&!Je.isValidElement(r)?r:{message:r};this.create({id:s,type:"error",description:a,...i})}else if(e instanceof Error){n=!1;const r="function"==typeof t.error?await t.error(e):t.error,a="function"==typeof t.description?await t.description(e):t.description,i="object"==typeof r&&!Je.isValidElement(r)?r:{message:r};this.create({id:s,type:"error",description:a,...i})}else if(void 0!==t.success){n=!1;const r="function"==typeof t.success?await t.success(e):t.success,a="function"==typeof t.description?await t.description(e):t.description,i="object"==typeof r&&!Je.isValidElement(r)?r:{message:r};this.create({id:s,type:"success",description:a,...i})}}).catch(async e=>{if(a=["reject",e],void 0!==t.error){n=!1;const r="function"==typeof t.error?await t.error(e):t.error,a="function"==typeof t.description?await t.description(e):t.description,i="object"==typeof r&&!Je.isValidElement(r)?r:{message:r};this.create({id:s,type:"error",description:a,...i})}}).finally(()=>{n&&(this.dismiss(s),s=void 0),null==t.finally||t.finally.call(t)}),o=()=>new Promise((e,t)=>i.then(()=>"reject"===a[0]?t(a[1]):e(a[1])).catch(t));return"string"!=typeof s&&"number"!=typeof s?{unwrap:o}:Object.assign(s,{unwrap:o})},this.custom=(e,t)=>{const s=(null==t?void 0:t.id)||Qa++;return this.create({jsx:e(s),id:s,...t}),s},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Za=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,en=(e,t)=>{const s=(null==t?void 0:t.id)||Qa++;return Xa.addToast({title:e,...t,id:s}),s};function tn(e){return void 0!==e.label}Object.assign(en,{success:Xa.success,info:Xa.info,warning:Xa.warning,error:Xa.error,custom:Xa.custom,message:Xa.message,promise:Xa.promise,dismiss:Xa.dismiss,loading:Xa.loading},{getHistory:()=>Xa.toasts,getToasts:()=>Xa.getActiveToasts()}),function(e){if("undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");const sn=3,rn=14;function an(...e){return e.filter(Boolean).join(" ")}const nn=e=>{var t,s,r,a,n,i,o,l,c;const{invert:d,toast:u,unstyled:h,interacting:m,setHeights:p,visibleToasts:f,heights:x,index:g,toasts:v,expanded:y,removeToast:j,defaultRichColors:b,closeButton:w,style:N,cancelButtonStyle:_,actionButtonStyle:k,className:S="",descriptionClassName:C="",duration:T,position:E,gap:M,expandByDefault:P,classNames:A,icons:D,closeButtonAriaLabel:O="Close toast"}=e,[R,I]=Je.useState(null),[L,q]=Je.useState(null),[F,z]=Je.useState(!1),[$,W]=Je.useState(!1),[U,V]=Je.useState(!1),[B,H]=Je.useState(!1),[Y,G]=Je.useState(!1),[K,J]=Je.useState(0),[Q,X]=Je.useState(0),Z=Je.useRef(u.duration||T||4e3),ee=Je.useRef(null),te=Je.useRef(null),se=0===g,re=g+1<=f,ae=u.type,ne=!1!==u.dismissible,ie=u.className||"",oe=u.descriptionClassName||"",le=Je.useMemo(()=>x.findIndex(e=>e.toastId===u.id)||0,[x,u.id]),ce=Je.useMemo(()=>{var e;return null!=(e=u.closeButton)?e:w},[u.closeButton,w]),de=Je.useMemo(()=>u.duration||T||4e3,[u.duration,T]),ue=Je.useRef(0),he=Je.useRef(0),me=Je.useRef(0),pe=Je.useRef(null),[fe,xe]=E.split("-"),ge=Je.useMemo(()=>x.reduce((e,t,s)=>s>=le?e:e+t.height,0),[x,le]),ve=(()=>{const[e,t]=Je.useState(document.hidden);return Je.useEffect(()=>{const e=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),ye=u.invert||d,je="loading"===ae;he.current=Je.useMemo(()=>le*M+ge,[le,ge]),Je.useEffect(()=>{Z.current=de},[de]),Je.useEffect(()=>{z(!0)},[]),Je.useEffect(()=>{const e=te.current;if(e){const t=e.getBoundingClientRect().height;return X(t),p(e=>[{toastId:u.id,height:t,position:u.position},...e]),()=>p(e=>e.filter(e=>e.toastId!==u.id))}},[p,u.id]),Je.useLayoutEffect(()=>{if(!F)return;const e=te.current,t=e.style.height;e.style.height="auto";const s=e.getBoundingClientRect().height;e.style.height=t,X(s),p(e=>e.find(e=>e.toastId===u.id)?e.map(e=>e.toastId===u.id?{...e,height:s}:e):[{toastId:u.id,height:s,position:u.position},...e])},[F,u.title,u.description,p,u.id,u.jsx,u.action,u.cancel]);const be=Je.useCallback(()=>{W(!0),J(he.current),p(e=>e.filter(e=>e.toastId!==u.id)),setTimeout(()=>{j(u)},200)},[u,j,p,he]);Je.useEffect(()=>{if(u.promise&&"loading"===ae||u.duration===1/0||"loading"===u.type)return;let e;return y||m||ve?(()=>{if(me.current<ue.current){const e=(new Date).getTime()-ue.current;Z.current=Z.current-e}me.current=(new Date).getTime()})():Z.current!==1/0&&(ue.current=(new Date).getTime(),e=setTimeout(()=>{null==u.onAutoClose||u.onAutoClose.call(u,u),be()},Z.current)),()=>clearTimeout(e)},[y,m,u,ae,ve,be]),Je.useEffect(()=>{u.delete&&(be(),null==u.onDismiss||u.onDismiss.call(u,u))},[be,u.delete]);const we=u.icon||(null==D?void 0:D[ae])||(e=>{switch(e){case"success":return Ha;case"info":return Ga;case"warning":return Ya;case"error":return Ka;default:return null}})(ae);var Ne,_e,ke,Se;return Je.createElement("li",{tabIndex:0,ref:te,className:an(S,ie,null==A?void 0:A.toast,null==u||null==(t=u.classNames)?void 0:t.toast,null==A?void 0:A.default,null==A?void 0:A[ae],null==u||null==(s=u.classNames)?void 0:s[ae]),"data-sonner-toast":"","data-rich-colors":null!=(Ne=u.richColors)?Ne:b,"data-styled":!Boolean(u.jsx||u.unstyled||h),"data-mounted":F,"data-promise":Boolean(u.promise),"data-swiped":Y,"data-removed":$,"data-visible":re,"data-y-position":fe,"data-x-position":xe,"data-index":g,"data-front":se,"data-swiping":U,"data-dismissible":ne,"data-type":ae,"data-invert":ye,"data-swipe-out":B,"data-swipe-direction":L,"data-expanded":Boolean(y||P&&F),"data-testid":u.testId,style:{"--index":g,"--toasts-before":g,"--z-index":v.length-g,"--offset":`${$?K:he.current}px`,"--initial-height":P?"auto":`${Q}px`,...N,...u.style},onDragEnd:()=>{V(!1),I(null),pe.current=null},onPointerDown:e=>{2!==e.button&&!je&&ne&&(ee.current=new Date,J(he.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(V(!0),pe.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,t,s;if(B||!ne)return;pe.current=null;const r=Number((null==(e=te.current)?void 0:e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),a=Number((null==(t=te.current)?void 0:t.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),n=(new Date).getTime()-(null==(s=ee.current)?void 0:s.getTime()),i="x"===R?r:a,o=Math.abs(i)/n;if(Math.abs(i)>=45||o>.11)return J(he.current),null==u.onDismiss||u.onDismiss.call(u,u),q("x"===R?r>0?"right":"left":a>0?"down":"up"),be(),void H(!0);var l,c;null==(l=te.current)||l.style.setProperty("--swipe-amount-x","0px"),null==(c=te.current)||c.style.setProperty("--swipe-amount-y","0px"),G(!1),V(!1),I(null)},onPointerMove:t=>{var s,r,a;if(!pe.current||!ne)return;if((null==(s=window.getSelection())?void 0:s.toString().length)>0)return;const n=t.clientY-pe.current.y,i=t.clientX-pe.current.x;var o;const l=null!=(o=e.swipeDirections)?o:function(e){const[t,s]=e.split("-"),r=[];return t&&r.push(t),s&&r.push(s),r}(E);!R&&(Math.abs(i)>1||Math.abs(n)>1)&&I(Math.abs(i)>Math.abs(n)?"x":"y");let c={x:0,y:0};const d=e=>1/(1.5+Math.abs(e)/20);if("y"===R){if(l.includes("top")||l.includes("bottom"))if(l.includes("top")&&n<0||l.includes("bottom")&&n>0)c.y=n;else{const e=n*d(n);c.y=Math.abs(e)<Math.abs(n)?e:n}}else if("x"===R&&(l.includes("left")||l.includes("right")))if(l.includes("left")&&i<0||l.includes("right")&&i>0)c.x=i;else{const e=i*d(i);c.x=Math.abs(e)<Math.abs(i)?e:i}(Math.abs(c.x)>0||Math.abs(c.y)>0)&&G(!0),null==(r=te.current)||r.style.setProperty("--swipe-amount-x",`${c.x}px`),null==(a=te.current)||a.style.setProperty("--swipe-amount-y",`${c.y}px`)}},ce&&!u.jsx&&"loading"!==ae?Je.createElement("button",{"aria-label":O,"data-disabled":je,"data-close-button":!0,onClick:je||!ne?()=>{}:()=>{be(),null==u.onDismiss||u.onDismiss.call(u,u)},className:an(null==A?void 0:A.closeButton,null==u||null==(r=u.classNames)?void 0:r.closeButton)},null!=(_e=null==D?void 0:D.close)?_e:Ja):null,(ae||u.icon||u.promise)&&null!==u.icon&&(null!==(null==D?void 0:D[ae])||u.icon)?Je.createElement("div",{"data-icon":"",className:an(null==A?void 0:A.icon,null==u||null==(a=u.classNames)?void 0:a.icon)},u.promise||"loading"===u.type&&!u.icon?u.icon||((null==D?void 0:D.loading)?Je.createElement("div",{className:an(null==A?void 0:A.loader,null==u||null==(Se=u.classNames)?void 0:Se.loader,"sonner-loader"),"data-visible":"loading"===ae},D.loading):Je.createElement(Ba,{className:an(null==A?void 0:A.loader,null==u||null==(ke=u.classNames)?void 0:ke.loader),visible:"loading"===ae})):null,"loading"!==u.type?we:null):null,Je.createElement("div",{"data-content":"",className:an(null==A?void 0:A.content,null==u||null==(n=u.classNames)?void 0:n.content)},Je.createElement("div",{"data-title":"",className:an(null==A?void 0:A.title,null==u||null==(i=u.classNames)?void 0:i.title)},u.jsx?u.jsx:"function"==typeof u.title?u.title():u.title),u.description?Je.createElement("div",{"data-description":"",className:an(C,oe,null==A?void 0:A.description,null==u||null==(o=u.classNames)?void 0:o.description)},"function"==typeof u.description?u.description():u.description):null),Je.isValidElement(u.cancel)?u.cancel:u.cancel&&tn(u.cancel)?Je.createElement("button",{"data-button":!0,"data-cancel":!0,style:u.cancelButtonStyle||_,onClick:e=>{tn(u.cancel)&&ne&&(null==u.cancel.onClick||u.cancel.onClick.call(u.cancel,e),be())},className:an(null==A?void 0:A.cancelButton,null==u||null==(l=u.classNames)?void 0:l.cancelButton)},u.cancel.label):null,Je.isValidElement(u.action)?u.action:u.action&&tn(u.action)?Je.createElement("button",{"data-button":!0,"data-action":!0,style:u.actionButtonStyle||k,onClick:e=>{tn(u.action)&&(null==u.action.onClick||u.action.onClick.call(u.action,e),e.defaultPrevented||be())},className:an(null==A?void 0:A.actionButton,null==u||null==(c=u.classNames)?void 0:c.actionButton)},u.action.label):null)};function on(){if("undefined"==typeof window)return"ltr";if("undefined"==typeof document)return"ltr";const e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}function ln(e,t){const s={};return[e,t].forEach((e,t)=>{const r=1===t,a=r?"--mobile-offset":"--offset",n=r?"16px":"24px";function i(e){["top","right","bottom","left"].forEach(t=>{s[`${a}-${t}`]="number"==typeof e?`${e}px`:e})}"number"==typeof e||"string"==typeof e?i(e):"object"==typeof e?["top","right","bottom","left"].forEach(t=>{void 0===e[t]?s[`${a}-${t}`]=n:s[`${a}-${t}`]="number"==typeof e[t]?`${e[t]}px`:e[t]}):i(n)}),s}const cn=Je.forwardRef(function(e,t){const{id:s,invert:r,position:a="bottom-right",hotkey:n=["altKey","KeyT"],expand:i,closeButton:o,className:l,offset:c,mobileOffset:d,theme:u="light",richColors:h,duration:m,style:p,visibleToasts:f=sn,toastOptions:x,dir:g=on(),gap:v=rn,icons:y,containerAriaLabel:j="Notifications"}=e,[b,w]=Je.useState([]),N=Je.useMemo(()=>s?b.filter(e=>e.toasterId===s):b.filter(e=>!e.toasterId),[b,s]),_=Je.useMemo(()=>Array.from(new Set([a].concat(N.filter(e=>e.position).map(e=>e.position)))),[N,a]),[k,S]=Je.useState([]),[C,T]=Je.useState(!1),[E,M]=Je.useState(!1),[P,A]=Je.useState("system"!==u?u:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),D=Je.useRef(null),O=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),R=Je.useRef(null),I=Je.useRef(!1),L=Je.useCallback(e=>{w(t=>{var s;return(null==(s=t.find(t=>t.id===e.id))?void 0:s.delete)||Xa.dismiss(e.id),t.filter(({id:t})=>t!==e.id)})},[]);return Je.useEffect(()=>Xa.subscribe(e=>{e.dismiss?requestAnimationFrame(()=>{w(t=>t.map(t=>t.id===e.id?{...t,delete:!0}:t))}):setTimeout(()=>{Qe.flushSync(()=>{w(t=>{const s=t.findIndex(t=>t.id===e.id);return-1!==s?[...t.slice(0,s),{...t[s],...e},...t.slice(s+1)]:[e,...t]})})})}),[b]),Je.useEffect(()=>{if("system"!==u)return void A(u);if("system"===u&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?A("dark"):A("light")),"undefined"==typeof window)return;const e=window.matchMedia("(prefers-color-scheme: dark)");try{e.addEventListener("change",({matches:e})=>{A(e?"dark":"light")})}catch(t){e.addListener(({matches:e})=>{try{A(e?"dark":"light")}catch(t){}})}},[u]),Je.useEffect(()=>{b.length<=1&&T(!1)},[b]),Je.useEffect(()=>{const e=e=>{var t;var s;n.every(t=>e[t]||e.code===t)&&(T(!0),null==(s=D.current)||s.focus());"Escape"!==e.code||document.activeElement!==D.current&&!(null==(t=D.current)?void 0:t.contains(document.activeElement))||T(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),Je.useEffect(()=>{if(D.current)return()=>{R.current&&(R.current.focus({preventScroll:!0}),R.current=null,I.current=!1)}},[D.current]),Je.createElement("section",{ref:t,"aria-label":`${j} ${O}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},_.map((t,s)=>{var a;const[n,u]=t.split("-");return N.length?Je.createElement("ol",{key:t,dir:"auto"===g?on():g,tabIndex:-1,ref:D,className:l,"data-sonner-toaster":!0,"data-sonner-theme":P,"data-y-position":n,"data-x-position":u,style:{"--front-toast-height":`${(null==(a=k[0])?void 0:a.height)||0}px`,"--width":"356px","--gap":`${v}px`,...p,...ln(c,d)},onBlur:e=>{I.current&&!e.currentTarget.contains(e.relatedTarget)&&(I.current=!1,R.current&&(R.current.focus({preventScroll:!0}),R.current=null))},onFocus:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||I.current||(I.current=!0,R.current=e.relatedTarget)},onMouseEnter:()=>T(!0),onMouseMove:()=>T(!0),onMouseLeave:()=>{E||T(!1)},onDragEnd:()=>T(!1),onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||M(!0)},onPointerUp:()=>M(!1)},N.filter(e=>!e.position&&0===s||e.position===t).map((s,a)=>{var n,l;return Je.createElement(nn,{key:s.id,icons:y,index:a,toast:s,defaultRichColors:h,duration:null!=(n=null==x?void 0:x.duration)?n:m,className:null==x?void 0:x.className,descriptionClassName:null==x?void 0:x.descriptionClassName,invert:r,visibleToasts:f,closeButton:null!=(l=null==x?void 0:x.closeButton)?l:o,interacting:E,position:t,style:null==x?void 0:x.style,unstyled:null==x?void 0:x.unstyled,classNames:null==x?void 0:x.classNames,cancelButtonStyle:null==x?void 0:x.cancelButtonStyle,actionButtonStyle:null==x?void 0:x.actionButtonStyle,closeButtonAriaLabel:null==x?void 0:x.closeButtonAriaLabel,removeToast:L,toasts:N.filter(e=>e.position==s.position),heights:k.filter(e=>e.position==s.position),setHeights:S,expandByDefault:i,gap:v,expanded:C,swipeDirections:e.swipeDirections})})):null}))}),dn=({...e})=>{const{theme:t="system"}=null!=(s=Ke.useContext(Wa))?s:Ua;var s;return K.jsx(cn,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var[un,hn]=Q("Tooltip",[ce]),mn=ce(),pn="TooltipProvider",fn=700,xn="tooltip.open",[gn,vn]=un(pn),yn=e=>{const{__scopeTooltip:t,delayDuration:s=fn,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:n}=e,i=Ke.useRef(!0),o=Ke.useRef(!1),l=Ke.useRef(0);return Ke.useEffect(()=>{const e=l.current;return()=>window.clearTimeout(e)},[]),K.jsx(gn,{scope:t,isOpenDelayedRef:i,delayDuration:s,onOpen:Ke.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:Ke.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:Ke.useCallback(e=>{o.current=e},[]),disableHoverableContent:a,children:n})};yn.displayName=pn;var jn="Tooltip",[bn,wn]=un(jn),Nn=e=>{const{__scopeTooltip:t,children:s,open:r,defaultOpen:a,onOpenChange:n,disableHoverableContent:i,delayDuration:o}=e,l=vn(jn,e.__scopeTooltip),c=mn(t),[d,u]=Ke.useState(null),h=me(),m=Ke.useRef(0),p=i??l.disableHoverableContent,f=o??l.delayDuration,x=Ke.useRef(!1),[g,v]=te({prop:r,defaultProp:a??!1,onChange:e=>{e?(l.onOpen(),document.dispatchEvent(new CustomEvent(xn))):l.onClose(),null==n||n(e)},caller:jn}),y=Ke.useMemo(()=>g?x.current?"delayed-open":"instant-open":"closed",[g]),j=Ke.useCallback(()=>{window.clearTimeout(m.current),m.current=0,x.current=!1,v(!0)},[v]),b=Ke.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v(!1)},[v]),w=Ke.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{x.current=!0,v(!0),m.current=0},f)},[f,v]);return Ke.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),K.jsx(pe,{...c,children:K.jsx(bn,{scope:t,contentId:h,open:g,stateAttribute:y,trigger:d,onTriggerChange:u,onTriggerEnter:Ke.useCallback(()=>{l.isOpenDelayedRef.current?w():j()},[l.isOpenDelayedRef,w,j]),onTriggerLeave:Ke.useCallback(()=>{p?b():(window.clearTimeout(m.current),m.current=0)},[b,p]),onOpen:j,onClose:b,disableHoverableContent:p,children:s})})};Nn.displayName=jn;var _n="TooltipTrigger",kn=Ke.forwardRef((e,t)=>{const{__scopeTooltip:s,...r}=e,a=wn(_n,s),n=vn(_n,s),i=mn(s),o=Ke.useRef(null),l=Z(t,o,a.onTriggerChange),c=Ke.useRef(!1),d=Ke.useRef(!1),u=Ke.useCallback(()=>c.current=!1,[]);return Ke.useEffect(()=>()=>document.removeEventListener("pointerup",u),[u]),K.jsx(fe,{asChild:!0,...i,children:K.jsx(J.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:l,onPointerMove:re(e.onPointerMove,e=>{"touch"!==e.pointerType&&(d.current||n.isPointerInTransitRef.current||(a.onTriggerEnter(),d.current=!0))}),onPointerLeave:re(e.onPointerLeave,()=>{a.onTriggerLeave(),d.current=!1}),onPointerDown:re(e.onPointerDown,()=>{a.open&&a.onClose(),c.current=!0,document.addEventListener("pointerup",u,{once:!0})}),onFocus:re(e.onFocus,()=>{c.current||a.onOpen()}),onBlur:re(e.onBlur,a.onClose),onClick:re(e.onClick,a.onClose)})})});kn.displayName=_n;var[Sn,Cn]=un("TooltipPortal",{forceMount:void 0}),Tn="TooltipContent",En=Ke.forwardRef((e,t)=>{const s=Cn(Tn,e.__scopeTooltip),{forceMount:r=s.forceMount,side:a="top",...n}=e,i=wn(Tn,e.__scopeTooltip);return K.jsx(se,{present:r||i.open,children:i.disableHoverableContent?K.jsx(On,{side:a,...n,ref:t}):K.jsx(Mn,{side:a,...n,ref:t})})}),Mn=Ke.forwardRef((e,t)=>{const s=wn(Tn,e.__scopeTooltip),r=vn(Tn,e.__scopeTooltip),a=Ke.useRef(null),n=Z(t,a),[i,o]=Ke.useState(null),{trigger:l,onClose:c}=s,d=a.current,{onPointerInTransitChange:u}=r,h=Ke.useCallback(()=>{o(null),u(!1)},[u]),m=Ke.useCallback((e,t)=>{const s=e.currentTarget,r={x:e.clientX,y:e.clientY},a=function(e,t,s=5){const r=[];switch(t){case"top":r.push({x:e.x-s,y:e.y+s},{x:e.x+s,y:e.y+s});break;case"bottom":r.push({x:e.x-s,y:e.y-s},{x:e.x+s,y:e.y-s});break;case"left":r.push({x:e.x+s,y:e.y-s},{x:e.x+s,y:e.y+s});break;case"right":r.push({x:e.x-s,y:e.y-s},{x:e.x-s,y:e.y+s})}return r}(r,function(e,t){const s=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),n=Math.abs(t.left-e.x);switch(Math.min(s,r,a,n)){case n:return"left";case a:return"right";case s:return"top";case r:return"bottom";default:throw new Error("unreachable")}}(r,s.getBoundingClientRect())),n=function(e){const t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),function(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const e=t[t.length-1],r=t[t.length-2];if(!((e.x-r.x)*(s.y-r.y)>=(e.y-r.y)*(s.x-r.x)))break;t.pop()}t.push(s)}t.pop();const s=[];for(let r=e.length-1;r>=0;r--){const t=e[r];for(;s.length>=2;){const e=s[s.length-1],r=s[s.length-2];if(!((e.x-r.x)*(t.y-r.y)>=(e.y-r.y)*(t.x-r.x)))break;s.pop()}s.push(t)}return s.pop(),1===t.length&&1===s.length&&t[0].x===s[0].x&&t[0].y===s[0].y?t:t.concat(s)}(t)}([...a,...function(e){const{top:t,right:s,bottom:r,left:a}=e;return[{x:a,y:t},{x:s,y:t},{x:s,y:r},{x:a,y:r}]}(t.getBoundingClientRect())]);o(n),u(!0)},[u]);return Ke.useEffect(()=>()=>h(),[h]),Ke.useEffect(()=>{if(l&&d){const e=e=>m(e,d),t=e=>m(e,l);return l.addEventListener("pointerleave",e),d.addEventListener("pointerleave",t),()=>{l.removeEventListener("pointerleave",e),d.removeEventListener("pointerleave",t)}}},[l,d,m,h]),Ke.useEffect(()=>{if(i){const e=e=>{const t=e.target,s={x:e.clientX,y:e.clientY},r=(null==l?void 0:l.contains(t))||(null==d?void 0:d.contains(t)),a=!function(e,t){const{x:s,y:r}=e;let a=!1;for(let n=0,i=t.length-1;n<t.length;i=n++){const e=t[n],o=t[i],l=e.x,c=e.y,d=o.x,u=o.y;c>r!=u>r&&s<(d-l)*(r-c)/(u-c)+l&&(a=!a)}return a}(s,i);r?h():a&&(h(),c())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[l,d,i,c,h]),K.jsx(On,{...e,ref:n})}),[Pn,An]=un(jn,{isInside:!1}),Dn=he("TooltipContent"),On=Ke.forwardRef((e,t)=>{const{__scopeTooltip:s,children:r,"aria-label":a,onEscapeKeyDown:n,onPointerDownOutside:i,...o}=e,l=wn(Tn,s),c=mn(s),{onClose:d}=l;return Ke.useEffect(()=>(document.addEventListener(xn,d),()=>document.removeEventListener(xn,d)),[d]),Ke.useEffect(()=>{if(l.trigger){const e=e=>{const t=e.target;(null==t?void 0:t.contains(l.trigger))&&d()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[l.trigger,d]),K.jsx(de,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:e=>e.preventDefault(),onDismiss:d,children:K.jsxs(ue,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[K.jsx(Dn,{children:r}),K.jsx(Pn,{scope:s,isInside:!0,children:K.jsx(Rt,{id:l.contentId,role:"tooltip",children:a||r})})]})})});En.displayName=Tn;var Rn="TooltipArrow";Ke.forwardRef((e,t)=>{const{__scopeTooltip:s,...r}=e,a=mn(s);return An(Rn,s).isInside?null:K.jsx(xe,{...a,...r,ref:t})}).displayName=Rn;var In=En;const Ln=yn,qn=Nn,Fn=kn,zn=Ke.forwardRef(({className:e,sideOffset:t=4,...s},r)=>K.jsx(In,{ref:r,sideOffset:t,className:Aa("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s}));zn.displayName=In.displayName;var $n=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Wn="undefined"==typeof window||"Deno"in globalThis;function Un(){}function Vn(e,t){return"function"==typeof e?e(t):e}function Bn(e,t){const{type:s="all",exact:r,fetchStatus:a,predicate:n,queryKey:i,stale:o}=e;if(i)if(r){if(t.queryHash!==Yn(i,t.options))return!1}else if(!Kn(t.queryKey,i))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return("boolean"!=typeof o||t.isStale()===o)&&((!a||a===t.state.fetchStatus)&&!(n&&!n(t)))}function Hn(e,t){const{exact:s,status:r,predicate:a,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(s){if(Gn(t.options.mutationKey)!==Gn(n))return!1}else if(!Kn(t.options.mutationKey,n))return!1}return(!r||t.state.status===r)&&!(a&&!a(t))}function Yn(e,t){return((null==t?void 0:t.queryKeyHashFn)||Gn)(e)}function Gn(e){return JSON.stringify(e,(e,t)=>Xn(t)?Object.keys(t).sort().reduce((e,s)=>(e[s]=t[s],e),{}):t)}function Kn(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(s=>Kn(e[s],t[s])))}function Jn(e,t){if(e===t)return e;const s=Qn(e)&&Qn(t);if(s||Xn(e)&&Xn(t)){const r=s?e:Object.keys(e),a=r.length,n=s?t:Object.keys(t),i=n.length,o=s?[]:{},l=new Set(r);let c=0;for(let d=0;d<i;d++){const r=s?d:n[d];(!s&&l.has(r)||s)&&void 0===e[r]&&void 0===t[r]?(o[r]=void 0,c++):(o[r]=Jn(e[r],t[r]),o[r]===e[r]&&void 0!==e[r]&&c++)}return a===i&&c===a?e:o}return t}function Qn(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Xn(e){if(!Zn(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!Zn(s)&&(!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function Zn(e){return"[object Object]"===Object.prototype.toString.call(e)}function ei(e,t,s){return"function"==typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?Jn(e,t):t}function ti(e,t,s=0){const r=[...e,t];return s&&r.length>s?r.slice(1):r}function si(e,t,s=0){const r=[t,...e];return s&&r.length>s?r.slice(0,-1):r}var ri=Symbol();function ai(e,t){return!e.queryFn&&(null==t?void 0:t.initialPromise)?()=>t.initialPromise:e.queryFn&&e.queryFn!==ri?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}var ni=new(r=class extends $n{constructor(){super(),B(this,e),B(this,t),B(this,s),H(this,s,e=>{if(!Wn&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){V(this,t)||this.setEventListener(V(this,s))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=V(this,t))||e.call(this),H(this,t,void 0))}setEventListener(e){var r;H(this,s,e),null==(r=V(this,t))||r.call(this),H(this,t,e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(t){V(this,e)!==t&&(H(this,e,t),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var t;return"boolean"==typeof V(this,e)?V(this,e):"hidden"!==(null==(t=globalThis.document)?void 0:t.visibilityState)}},e=new WeakMap,t=new WeakMap,s=new WeakMap,r),ii=new(o=class extends $n{constructor(){super(),B(this,a,!0),B(this,n),B(this,i),H(this,i,e=>{if(!Wn&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}})}onSubscribe(){V(this,n)||this.setEventListener(V(this,i))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=V(this,n))||e.call(this),H(this,n,void 0))}setEventListener(e){var t;H(this,i,e),null==(t=V(this,n))||t.call(this),H(this,n,e(this.setOnline.bind(this)))}setOnline(e){V(this,a)!==e&&(H(this,a,e),this.listeners.forEach(t=>{t(e)}))}isOnline(){return V(this,a)}},a=new WeakMap,n=new WeakMap,i=new WeakMap,o);function oi(e){return Math.min(1e3*2**e,3e4)}function li(e){return"online"!==(e??"online")||ii.isOnline()}var ci=class extends Error{constructor(e){super("CancelledError"),this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent}};function di(e){return e instanceof ci}function ui(e){let t,s=!1,r=0,a=!1;const n=function(){let e,t;const s=new Promise((s,r)=>{e=s,t=r});function r(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch(()=>{}),s.resolve=t=>{r({status:"fulfilled",value:t}),e(t)},s.reject=e=>{r({status:"rejected",reason:e}),t(e)},s}(),i=()=>ni.isFocused()&&("always"===e.networkMode||ii.isOnline())&&e.canRun(),o=()=>li(e.networkMode)&&e.canRun(),l=s=>{var r;a||(a=!0,null==(r=e.onSuccess)||r.call(e,s),null==t||t(),n.resolve(s))},c=s=>{var r;a||(a=!0,null==(r=e.onError)||r.call(e,s),null==t||t(),n.reject(s))},d=()=>new Promise(s=>{var r;t=e=>{(a||i())&&s(e)},null==(r=e.onPause)||r.call(e)}).then(()=>{var s;t=void 0,a||null==(s=e.onContinue)||s.call(e)}),u=()=>{if(a)return;let t;const n=0===r?e.initialPromise:void 0;try{t=n??e.fn()}catch(o){t=Promise.reject(o)}Promise.resolve(t).then(l).catch(t=>{var n;if(a)return;const o=e.retry??(Wn?0:3),l=e.retryDelay??oi,h="function"==typeof l?l(r,t):l,m=!0===o||"number"==typeof o&&r<o||"function"==typeof o&&o(r,t);var p;!s&&m?(r++,null==(n=e.onFail)||n.call(e,r,t),(p=h,new Promise(e=>{setTimeout(e,p)})).then(()=>i()?void 0:d()).then(()=>{s?c(t):u()})):c(t)})};return{promise:n,cancel:t=>{var s;a||(c(new ci(t)),null==(s=e.abort)||s.call(e))},continue:()=>(null==t||t(),n),cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:o,start:()=>(o()?u():d().then(u),n)}}var hi=e=>setTimeout(e,0);var mi=function(){let e=[],t=0,s=e=>{e()},r=e=>{e()},a=hi;const n=r=>{t?e.push(r):a(()=>{s(r)})};return{batch:n=>{let i;t++;try{i=n()}finally{t--,t||(()=>{const t=e;e=[],t.length&&a(()=>{r(()=>{t.forEach(e=>{s(e)})})})})()}return i},batchCalls:e=>(...t)=>{n(()=>{e(...t)})},schedule:n,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{r=e},setScheduler:e=>{a=e}}}(),pi=(c=class{constructor(){B(this,l)}destroy(){this.clearGcTimeout()}scheduleGc(){var e;this.clearGcTimeout(),"number"==typeof(e=this.gcTime)&&e>=0&&e!==1/0&&H(this,l,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Wn?1/0:3e5))}clearGcTimeout(){V(this,l)&&(clearTimeout(V(this,l)),H(this,l,void 0))}},l=new WeakMap,c),fi=(y=class extends pi{constructor(e){super(),B(this,g),B(this,d),B(this,u),B(this,h),B(this,m),B(this,p),B(this,f),B(this,x),H(this,x,!1),H(this,f,e.defaultOptions),this.setOptions(e.options),this.observers=[],H(this,m,e.client),H(this,h,V(this,m).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,H(this,d,function(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,r=s?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}(this.options)),this.state=e.state??V(this,d),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return null==(e=V(this,p))?void 0:e.promise}setOptions(e){this.options={...V(this,f),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||V(this,h).remove(this)}setData(e,t){const s=ei(this.state.data,e,this.options);return Y(this,g,v).call(this,{data:s,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt,manual:null==t?void 0:t.manual}),s}setState(e,t){Y(this,g,v).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var t,s;const r=null==(t=V(this,p))?void 0:t.promise;return null==(s=V(this,p))||s.cancel(e),r?r.then(Un).catch(Un):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(V(this,d))}isActive(){return this.observers.some(e=>{return!1!==(t=e.options.enabled,s=this,"function"==typeof t?t(s):t);var t,s})}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ri||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===Vn(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!function(e,t){return Math.max(e+(t||0)-Date.now(),0)}(this.state.dataUpdatedAt,e))}onFocus(){var e;const t=this.observers.find(e=>e.shouldFetchOnWindowFocus());null==t||t.refetch({cancelRefetch:!1}),null==(e=V(this,p))||e.continue()}onOnline(){var e;const t=this.observers.find(e=>e.shouldFetchOnReconnect());null==t||t.refetch({cancelRefetch:!1}),null==(e=V(this,p))||e.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),V(this,h).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(V(this,p)&&(V(this,x)?V(this,p).cancel({revert:!0}):V(this,p).cancelRetry()),this.scheduleGc()),V(this,h).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Y(this,g,v).call(this,{type:"invalidate"})}fetch(e,t){var s,r,a;if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(V(this,p))return V(this,p).continueRetry(),V(this,p).promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const n=new AbortController,i=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(H(this,x,!0),n.signal)})},o=()=>{const e=ai(this.options,t),s=(()=>{const e={client:V(this,m),queryKey:this.queryKey,meta:this.meta};return i(e),e})();return H(this,x,!1),this.options.persister?this.options.persister(e,s,this):e(s)},l=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:V(this,m),state:this.state,fetchFn:o};return i(e),e})();null==(s=this.options.behavior)||s.onFetch(l,this),H(this,u,this.state),"idle"!==this.state.fetchStatus&&this.state.fetchMeta===(null==(r=l.fetchOptions)?void 0:r.meta)||Y(this,g,v).call(this,{type:"fetch",meta:null==(a=l.fetchOptions)?void 0:a.meta});const c=e=>{var t,s,r,a;di(e)&&e.silent||Y(this,g,v).call(this,{type:"error",error:e}),di(e)||(null==(s=(t=V(this,h).config).onError)||s.call(t,e,this),null==(a=(r=V(this,h).config).onSettled)||a.call(r,this.state.data,e,this)),this.scheduleGc()};return H(this,p,ui({initialPromise:null==t?void 0:t.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:e=>{var t,s,r,a;if(void 0!==e){try{this.setData(e)}catch(n){return void c(n)}null==(s=(t=V(this,h).config).onSuccess)||s.call(t,e,this),null==(a=(r=V(this,h).config).onSettled)||a.call(r,e,this.state.error,this),this.scheduleGc()}else c(new Error(`${this.queryHash} data is undefined`))},onError:c,onFail:(e,t)=>{Y(this,g,v).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{Y(this,g,v).call(this,{type:"pause"})},onContinue:()=>{Y(this,g,v).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),V(this,p).start()}},d=new WeakMap,u=new WeakMap,h=new WeakMap,m=new WeakMap,p=new WeakMap,f=new WeakMap,x=new WeakMap,g=new WeakSet,v=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...(s=t.data,r=this.options,{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:li(r.networkMode)?"fetching":"paused",...void 0===s&&{error:null,status:"pending"}}),fetchMeta:e.meta??null};case"success":return H(this,u,void 0),{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return di(a)&&a.revert&&V(this,u)?{...V(this,u),fetchStatus:"idle"}:{...t,error:a,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}var s,r})(this.state),mi.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),V(this,h).notify({query:this,type:"updated",action:e})})},y);var xi=(b=class extends $n{constructor(e={}){super(),B(this,j),this.config=e,H(this,j,new Map)}build(e,t,s){const r=t.queryKey,a=t.queryHash??Yn(r,t);let n=this.get(a);return n||(n=new fi({client:e,queryKey:r,queryHash:a,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(n)),n}add(e){V(this,j).has(e.queryHash)||(V(this,j).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=V(this,j).get(e.queryHash);t&&(e.destroy(),t===e&&V(this,j).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){mi.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return V(this,j).get(e)}getAll(){return[...V(this,j).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>Bn(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>Bn(e,t)):t}notify(e){mi.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){mi.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){mi.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},j=new WeakMap,b),gi=(C=class extends pi{constructor(e){super(),B(this,k),B(this,w),B(this,N),B(this,_),this.mutationId=e.mutationId,H(this,N,e.mutationCache),H(this,w,[]),this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){V(this,w).includes(e)||(V(this,w).push(e),this.clearGcTimeout(),V(this,N).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){H(this,w,V(this,w).filter(t=>t!==e)),this.scheduleGc(),V(this,N).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){V(this,w).length||("pending"===this.state.status?this.scheduleGc():V(this,N).remove(this))}continue(){var e;return(null==(e=V(this,_))?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var t,s,r,a,n,i,o,l,c,d,u,h,m,p,f,x,g,v,y,j;const b=()=>{Y(this,k,S).call(this,{type:"continue"})};H(this,_,ui({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{Y(this,k,S).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{Y(this,k,S).call(this,{type:"pause"})},onContinue:b,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>V(this,N).canRun(this)}));const w="pending"===this.state.status,C=!V(this,_).canStart();try{if(w)b();else{Y(this,k,S).call(this,{type:"pending",variables:e,isPaused:C}),await(null==(s=(t=V(this,N).config).onMutate)?void 0:s.call(t,e,this));const n=await(null==(a=(r=this.options).onMutate)?void 0:a.call(r,e));n!==this.state.context&&Y(this,k,S).call(this,{type:"pending",context:n,variables:e,isPaused:C})}const m=await V(this,_).start();return await(null==(i=(n=V(this,N).config).onSuccess)?void 0:i.call(n,m,e,this.state.context,this)),await(null==(l=(o=this.options).onSuccess)?void 0:l.call(o,m,e,this.state.context)),await(null==(d=(c=V(this,N).config).onSettled)?void 0:d.call(c,m,null,this.state.variables,this.state.context,this)),await(null==(h=(u=this.options).onSettled)?void 0:h.call(u,m,null,e,this.state.context)),Y(this,k,S).call(this,{type:"success",data:m}),m}catch(T){try{throw await(null==(p=(m=V(this,N).config).onError)?void 0:p.call(m,T,e,this.state.context,this)),await(null==(x=(f=this.options).onError)?void 0:x.call(f,T,e,this.state.context)),await(null==(v=(g=V(this,N).config).onSettled)?void 0:v.call(g,void 0,T,this.state.variables,this.state.context,this)),await(null==(j=(y=this.options).onSettled)?void 0:j.call(y,void 0,T,e,this.state.context)),T}finally{Y(this,k,S).call(this,{type:"error",error:T})}}finally{V(this,N).runNext(this)}}},w=new WeakMap,N=new WeakMap,_=new WeakMap,k=new WeakSet,S=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),mi.batch(()=>{V(this,w).forEach(t=>{t.onMutationUpdate(e)}),V(this,N).notify({mutation:this,type:"updated",action:e})})},C);var vi=(P=class extends $n{constructor(e={}){super(),B(this,T),B(this,E),B(this,M),this.config=e,H(this,T,new Set),H(this,E,new Map),H(this,M,0)}build(e,t,s){const r=new gi({mutationCache:this,mutationId:++G(this,M)._,options:e.defaultMutationOptions(t),state:s});return this.add(r),r}add(e){V(this,T).add(e);const t=yi(e);if("string"==typeof t){const s=V(this,E).get(t);s?s.push(e):V(this,E).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(V(this,T).delete(e)){const t=yi(e);if("string"==typeof t){const s=V(this,E).get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&V(this,E).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=yi(e);if("string"==typeof t){const s=V(this,E).get(t),r=null==s?void 0:s.find(e=>"pending"===e.state.status);return!r||r===e}return!0}runNext(e){var t;const s=yi(e);if("string"==typeof s){const r=null==(t=V(this,E).get(s))?void 0:t.find(t=>t!==e&&t.state.isPaused);return(null==r?void 0:r.continue())??Promise.resolve()}return Promise.resolve()}clear(){mi.batch(()=>{V(this,T).forEach(e=>{this.notify({type:"removed",mutation:e})}),V(this,T).clear(),V(this,E).clear()})}getAll(){return Array.from(V(this,T))}find(e){const t={exact:!0,...e};return this.getAll().find(e=>Hn(t,e))}findAll(e={}){return this.getAll().filter(t=>Hn(e,t))}notify(e){mi.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return mi.batch(()=>Promise.all(e.map(e=>e.continue().catch(Un))))}},T=new WeakMap,E=new WeakMap,M=new WeakMap,P);function yi(e){var t;return null==(t=e.options.scope)?void 0:t.id}function ji(e){return{onFetch:(t,s)=>{var r,a,n,i,o;const l=t.options,c=null==(n=null==(a=null==(r=t.fetchOptions)?void 0:r.meta)?void 0:a.fetchMore)?void 0:n.direction,d=(null==(i=t.state.data)?void 0:i.pages)||[],u=(null==(o=t.state.data)?void 0:o.pageParams)||[];let h={pages:[],pageParams:[]},m=0;const p=async()=>{let s=!1;const r=ai(t.options,t.fetchOptions),a=async(e,a,n)=>{if(s)return Promise.reject();if(null==a&&e.pages.length)return Promise.resolve(e);const i=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:a,direction:n?"backward":"forward",meta:t.options.meta};var r;return r=e,Object.defineProperty(r,"signal",{enumerable:!0,get:()=>(t.signal.aborted?s=!0:t.signal.addEventListener("abort",()=>{s=!0}),t.signal)}),e})(),o=await r(i),{maxPages:l}=t.options,c=n?si:ti;return{pages:c(e.pages,o,l),pageParams:c(e.pageParams,a,l)}};if(c&&d.length){const e="backward"===c,t={pages:d,pageParams:u},s=(e?wi:bi)(l,t);h=await a(t,s,e)}else{const t=e??d.length;do{const e=0===m?u[0]??l.initialPageParam:bi(l,h);if(m>0&&null==e)break;h=await a(h,e),m++}while(m<t)}return h};t.options.persister?t.fetchFn=()=>{var e,r;return null==(r=(e=t.options).persister)?void 0:r.call(e,p,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=p}}}function bi(e,{pages:t,pageParams:s}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,s[r],s):void 0}function wi(e,{pages:t,pageParams:s}){var r;return t.length>0?null==(r=e.getPreviousPageParam)?void 0:r.call(e,t[0],t,s[0],s):void 0}var Ni,_i,ki=(z=class{constructor(e={}){B(this,A),B(this,D),B(this,O),B(this,R),B(this,I),B(this,L),B(this,q),B(this,F),H(this,A,e.queryCache||new xi),H(this,D,e.mutationCache||new vi),H(this,O,e.defaultOptions||{}),H(this,R,new Map),H(this,I,new Map),H(this,L,0)}mount(){G(this,L)._++,1===V(this,L)&&(H(this,q,ni.subscribe(async e=>{e&&(await this.resumePausedMutations(),V(this,A).onFocus())})),H(this,F,ii.subscribe(async e=>{e&&(await this.resumePausedMutations(),V(this,A).onOnline())})))}unmount(){var e,t;G(this,L)._--,0===V(this,L)&&(null==(e=V(this,q))||e.call(this),H(this,q,void 0),null==(t=V(this,F))||t.call(this),H(this,F,void 0))}isFetching(e){return V(this,A).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return V(this,D).findAll({...e,status:"pending"}).length}getQueryData(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=V(this,A).get(s.queryHash))?void 0:t.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=V(this,A).build(this,t),r=s.state.data;return void 0===r?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(Vn(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return V(this,A).findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,s){const r=this.defaultQueryOptions({queryKey:e}),a=V(this,A).get(r.queryHash),n=function(e,t){return"function"==typeof e?e(t):e}(t,null==a?void 0:a.state.data);if(void 0!==n)return V(this,A).build(this,r).setData(n,{...s,manual:!0})}setQueriesData(e,t,s){return mi.batch(()=>V(this,A).findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,s)]))}getQueryState(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=V(this,A).get(s.queryHash))?void 0:t.state}removeQueries(e){const t=V(this,A);mi.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const s=V(this,A);return mi.batch(()=>(s.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},r=mi.batch(()=>V(this,A).findAll(e).map(e=>e.cancel(s)));return Promise.all(r).then(Un).catch(Un)}invalidateQueries(e,t={}){return mi.batch(()=>(V(this,A).findAll(e).forEach(e=>{e.invalidate()}),"none"===(null==e?void 0:e.refetchType)?Promise.resolve():this.refetchQueries({...e,type:(null==e?void 0:e.refetchType)??(null==e?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},r=mi.batch(()=>V(this,A).findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,s);return s.throwOnError||(t=t.catch(Un)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(r).then(Un)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=V(this,A).build(this,t);return s.isStaleByTime(Vn(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Un).catch(Un)}fetchInfiniteQuery(e){return e.behavior=ji(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Un).catch(Un)}ensureInfiniteQueryData(e){return e.behavior=ji(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return ii.isOnline()?V(this,D).resumePausedMutations():Promise.resolve()}getQueryCache(){return V(this,A)}getMutationCache(){return V(this,D)}getDefaultOptions(){return V(this,O)}setDefaultOptions(e){H(this,O,e)}setQueryDefaults(e,t){V(this,R).set(Gn(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...V(this,R).values()],s={};return t.forEach(t=>{Kn(e,t.queryKey)&&Object.assign(s,t.defaultOptions)}),s}setMutationDefaults(e,t){V(this,I).set(Gn(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...V(this,I).values()],s={};return t.forEach(t=>{Kn(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...V(this,O).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Yn(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ri&&(t.enabled=!1),t}defaultMutationOptions(e){return(null==e?void 0:e._defaulted)?e:{...V(this,O).mutations,...(null==e?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){V(this,A).clear(),V(this,D).clear()}},A=new WeakMap,D=new WeakMap,O=new WeakMap,R=new WeakMap,I=new WeakMap,L=new WeakMap,q=new WeakMap,F=new WeakMap,z),Si=Ke.createContext(void 0),Ci=({client:e,children:t})=>(Ke.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),K.jsx(Si.Provider,{value:e,children:t}));
/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function Ti(){return Ti=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Ti.apply(this,arguments)}(_i=Ni||(Ni={})).Pop="POP",_i.Push="PUSH",_i.Replace="REPLACE";const Ei="popstate";function Mi(e){return void 0===e&&(e={}),function(e,t,s,r){void 0===r&&(r={});let{window:a=document.defaultView,v5Compat:n=!1}=r,i=a.history,o=Ni.Pop,l=null,c=d();null==c&&(c=0,i.replaceState(Ti({},i.state,{idx:c}),""));function d(){return(i.state||{idx:null}).idx}function u(){o=Ni.Pop;let e=d(),t=null==e?null:e-c;c=e,l&&l({action:o,location:f.location,delta:t})}function h(e,t){o=Ni.Push;let s=Oi(f.location,e,t);c=d()+1;let r=Di(s,c),u=f.createHref(s);try{i.pushState(r,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;a.location.assign(u)}n&&l&&l({action:o,location:f.location,delta:1})}function m(e,t){o=Ni.Replace;let s=Oi(f.location,e,t);c=d();let r=Di(s,c),a=f.createHref(s);i.replaceState(r,"",a),n&&l&&l({action:o,location:f.location,delta:0})}function p(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,s="string"==typeof e?e:Ri(e);return s=s.replace(/ $/,"%20"),Pi(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}let f={get action(){return o},get location(){return e(a,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Ei,u),l=e,()=>{a.removeEventListener(Ei,u),l=null}},createHref:e=>t(a,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:h,replace:m,go:e=>i.go(e)};return f}(function(e,t){let{pathname:s,search:r,hash:a}=e.location;return Oi("",{pathname:s,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:Ri(t)},0,e)}function Pi(e,t){if(!1===e||null==e)throw new Error(t)}function Ai(e,t){if(!e)try{throw new Error(t)}catch(s){}}function Di(e,t){return{usr:e.state,key:e.key,idx:t}}function Oi(e,t,s,r){return void 0===s&&(s=null),Ti({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?Ii(t):t,{state:s,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function Ri(e){let{pathname:t="/",search:s="",hash:r=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function Ii(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}var Li,qi;function Fi(e,t,s){return void 0===s&&(s="/"),function(e,t,s){let r="string"==typeof t?Ii(t):t,a=Zi(r.pathname||"/",s);if(null==a)return null;let n=zi(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s]);return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(n);let i=null;for(let o=0;null==i&&o<n.length;++o){let e=Xi(a);i=Ji(n[o],e)}return i}(e,t,s)}function zi(e,t,s,r){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===r&&(r="");let a=(e,a,n)=>{let i={relativePath:void 0===n?e.path||"":n,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(Pi(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));let o=ro([r,i.relativePath]),l=s.concat(i);e.children&&e.children.length>0&&(Pi(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),zi(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:Ki(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let r of $i(e.path))a(e,t,r);else a(e,t)}),t}function $i(e){let t=e.split("/");if(0===t.length)return[];let[s,...r]=t,a=s.endsWith("?"),n=s.replace(/\?$/,"");if(0===r.length)return a?[n,""]:[n];let i=$i(r.join("/")),o=[];return o.push(...i.map(e=>""===e?n:[n,e].join("/"))),a&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}(qi=Li||(Li={})).data="data",qi.deferred="deferred",qi.redirect="redirect",qi.error="error";const Wi=/^:[\w-]+$/,Ui=3,Vi=2,Bi=1,Hi=10,Yi=-2,Gi=e=>"*"===e;function Ki(e,t){let s=e.split("/"),r=s.length;return s.some(Gi)&&(r+=Yi),t&&(r+=Vi),s.filter(e=>!Gi(e)).reduce((e,t)=>e+(Wi.test(t)?Ui:""===t?Bi:Hi),r)}function Ji(e,t,s){let{routesMeta:r}=e,a={},n="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],s=o===r.length-1,l="/"===n?t:t.slice(n.length)||"/",c=Qi({path:e.relativePath,caseSensitive:e.caseSensitive,end:s},l),d=e.route;if(!c)return null;Object.assign(a,c.params),i.push({params:a,pathname:ro([n,c.pathname]),pathnameBase:ao(ro([n,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(n=ro([n,c.pathnameBase]))}return i}function Qi(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,r]=function(e,t,s){void 0===t&&(t=!1);void 0===s&&(s=!0);Ai("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(r.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let n=new RegExp(a,t?void 0:"i");return[n,r]}(e.path,e.caseSensitive,e.end),a=t.match(s);if(!a)return null;let n=a[0],i=n.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((e,t,s)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[s]||"";i=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[s];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:n,pathnameBase:i,pattern:e}}function Xi(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return Ai(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function Zi(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,r=e.charAt(s);return r&&"/"!==r?null:e.slice(s)||"/"}function eo(e,t,s,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function to(e,t){let s=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?s.map((e,t)=>t===s.length-1?e.pathname:e.pathnameBase):s.map(e=>e.pathnameBase)}function so(e,t,s,r){let a;void 0===r&&(r=!1),"string"==typeof e?a=Ii(e):(a=Ti({},e),Pi(!a.pathname||!a.pathname.includes("?"),eo("?","pathname","search",a)),Pi(!a.pathname||!a.pathname.includes("#"),eo("#","pathname","hash",a)),Pi(!a.search||!a.search.includes("#"),eo("#","search","hash",a)));let n,i=""===e||""===a.pathname,o=i?"/":a.pathname;if(null==o)n=s;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}n=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:s,search:r="",hash:a=""}="string"==typeof e?Ii(e):e,n=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:n,search:no(r),hash:io(a)}}(a,n),c=o&&"/"!==o&&o.endsWith("/"),d=(i||"."===o)&&s.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}const ro=e=>e.join("/").replace(/\/\/+/g,"/"),ao=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),no=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",io=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";const oo=["post","put","patch","delete"];new Set(oo);const lo=["get",...oo];
/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function co(){return co=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},co.apply(this,arguments)}new Set(lo);const uo=Ke.createContext(null),ho=Ke.createContext(null),mo=Ke.createContext(null),po=Ke.createContext(null),fo=Ke.createContext({outlet:null,matches:[],isDataRoute:!1}),xo=Ke.createContext(null);function go(){return null!=Ke.useContext(po)}function vo(){return go()||Pi(!1),Ke.useContext(po).location}function yo(e){Ke.useContext(mo).static||Ke.useLayoutEffect(e)}function jo(){let{isDataRoute:e}=Ke.useContext(fo);return e?function(){let{router:e}=function(){let e=Ke.useContext(uo);return e||Pi(!1),e}(Co.UseNavigateStable),t=Eo(To.UseNavigateStable),s=Ke.useRef(!1);return yo(()=>{s.current=!0}),Ke.useCallback(function(r,a){void 0===a&&(a={}),s.current&&("number"==typeof r?e.navigate(r):e.navigate(r,co({fromRouteId:t},a)))},[e,t])}():function(){go()||Pi(!1);let e=Ke.useContext(uo),{basename:t,future:s,navigator:r}=Ke.useContext(mo),{matches:a}=Ke.useContext(fo),{pathname:n}=vo(),i=JSON.stringify(to(a,s.v7_relativeSplatPath)),o=Ke.useRef(!1);return yo(()=>{o.current=!0}),Ke.useCallback(function(s,a){if(void 0===a&&(a={}),!o.current)return;if("number"==typeof s)return void r.go(s);let l=so(s,JSON.parse(i),n,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:ro([t,l.pathname])),(a.replace?r.replace:r.push)(l,a.state,a)},[t,r,i,n,e])}()}function bo(e,t){let{relative:s}=void 0===t?{}:t,{future:r}=Ke.useContext(mo),{matches:a}=Ke.useContext(fo),{pathname:n}=vo(),i=JSON.stringify(to(a,r.v7_relativeSplatPath));return Ke.useMemo(()=>so(e,JSON.parse(i),n,"path"===s),[e,i,n,s])}function wo(e,t){return function(e,t,s,r){go()||Pi(!1);let{navigator:a}=Ke.useContext(mo),{matches:n}=Ke.useContext(fo),i=n[n.length-1],o=i?i.params:{};!i||i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c,d=vo();if(t){var u;let e="string"==typeof t?Ii(t):t;"/"===l||(null==(u=e.pathname)?void 0:u.startsWith(l))||Pi(!1),c=e}else c=d;let h=c.pathname||"/",m=h;if("/"!==l){let e=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(e.length).join("/")}let p=Fi(e,{pathname:m}),f=function(e,t,s,r){var a;void 0===t&&(t=[]);void 0===s&&(s=null);void 0===r&&(r=null);if(null==e){var n;if(!s)return null;if(s.errors)e=s.matches;else{if(!(null!=(n=r)&&n.v7_partialHydration&&0===t.length&&!s.initialized&&s.matches.length>0))return null;e=s.matches}}let i=e,o=null==(a=s)?void 0:a.errors;if(null!=o){let e=i.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||Pi(!1),i=i.slice(0,Math.min(i.length,e+1))}let l=!1,c=-1;if(s&&r&&r.v7_partialHydration)for(let d=0;d<i.length;d++){let e=i[d];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=d),e.route.id){let{loaderData:t,errors:r}=s,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){l=!0,i=c>=0?i.slice(0,c+1):[i[0]];break}}}return i.reduceRight((e,r,a)=>{let n,d=!1,u=null,h=null;var m;s&&(n=o&&r.route.id?o[r.route.id]:void 0,u=r.route.errorElement||_o,l&&(c<0&&0===a?(Mo[m="route-fallback"]||(Mo[m]=!0),d=!0,h=null):c===a&&(d=!0,h=r.route.hydrateFallbackElement||null)));let p=t.concat(i.slice(0,a+1)),f=()=>{let t;return t=n?u:d?h:r.route.Component?Ke.createElement(r.route.Component,null):r.route.element?r.route.element:e,Ke.createElement(So,{match:r,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?Ke.createElement(ko,{location:s.location,revalidation:s.revalidation,component:u,error:n,children:f(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):f()},null)}(p&&p.map(e=>Object.assign({},e,{params:Object.assign({},o,e.params),pathname:ro([l,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:ro([l,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),n,s,r);if(t&&f)return Ke.createElement(po.Provider,{value:{location:co({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Ni.Pop}},f);return f}(e,t)}function No(){let e=function(){var e;let t=Ke.useContext(xo),s=function(){let e=Ke.useContext(ho);return e||Pi(!1),e}(),r=Eo();if(void 0!==t)return t;return null==(e=s.errors)?void 0:e[r]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Ke.createElement(Ke.Fragment,null,Ke.createElement("h2",null,"Unexpected Application Error!"),Ke.createElement("h3",{style:{fontStyle:"italic"}},t),s?Ke.createElement("pre",{style:r},s):null,null)}const _o=Ke.createElement(No,null);class ko extends Ke.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){}render(){return void 0!==this.state.error?Ke.createElement(fo.Provider,{value:this.props.routeContext},Ke.createElement(xo.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function So(e){let{routeContext:t,match:s,children:r}=e,a=Ke.useContext(uo);return a&&a.static&&a.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=s.route.id),Ke.createElement(fo.Provider,{value:t},r)}var Co=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Co||{}),To=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(To||{});function Eo(e){let t=function(){let e=Ke.useContext(fo);return e||Pi(!1),e}(),s=t.matches[t.matches.length-1];return s.route.id||Pi(!1),s.route.id}const Mo={};function Po(e){Pi(!1)}function Ao(e){let{basename:t="/",children:s=null,location:r,navigationType:a=Ni.Pop,navigator:n,static:i=!1,future:o}=e;go()&&Pi(!1);let l=t.replace(/^\/*/,"/"),c=Ke.useMemo(()=>({basename:l,navigator:n,static:i,future:co({v7_relativeSplatPath:!1},o)}),[l,o,n,i]);"string"==typeof r&&(r=Ii(r));let{pathname:d="/",search:u="",hash:h="",state:m=null,key:p="default"}=r,f=Ke.useMemo(()=>{let e=Zi(d,l);return null==e?null:{location:{pathname:e,search:u,hash:h,state:m,key:p},navigationType:a}},[l,d,u,h,m,p,a]);return null==f?null:Ke.createElement(mo.Provider,{value:c},Ke.createElement(po.Provider,{children:s,value:f}))}function Do(e){let{children:t,location:s}=e;return wo(Oo(t),s)}function Oo(e,t){void 0===t&&(t=[]);let s=[];return Ke.Children.forEach(e,(e,r)=>{if(!Ke.isValidElement(e))return;let a=[...t,r];if(e.type===Ke.Fragment)return void s.push.apply(s,Oo(e.props.children,a));e.type!==Po&&Pi(!1),e.props.index&&e.props.children&&Pi(!1);let n={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(n.children=Oo(e.props.children,a)),s.push(n)}),s}
/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ro(){return Ro=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Ro.apply(this,arguments)}function Io(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}new Promise(()=>{});const Lo=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qo=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(gb){}const Fo=Ke.createContext({isTransitioning:!1}),zo=Xe.startTransition;function $o(e){let{basename:t,children:s,future:r,window:a}=e,n=Ke.useRef();null==n.current&&(n.current=Mi({window:a,v5Compat:!0}));let i=n.current,[o,l]=Ke.useState({action:i.action,location:i.location}),{v7_startTransition:c}=r||{},d=Ke.useCallback(e=>{c&&zo?zo(()=>l(e)):l(e)},[l,c]);return Ke.useLayoutEffect(()=>i.listen(d),[i,d]),Ke.useEffect(()=>{return null==(e=r)||e.v7_startTransition,void(null==e||e.v7_relativeSplatPath);var e},[r]),Ke.createElement(Ao,{basename:t,children:s,location:o.location,navigationType:o.action,navigator:i,future:r})}const Wo="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Uo=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vo=Ke.forwardRef(function(e,t){let s,{onClick:r,relative:a,reloadDocument:n,replace:i,state:o,target:l,to:c,preventScrollReset:d,viewTransition:u}=e,h=Io(e,Lo),{basename:m}=Ke.useContext(mo),p=!1;if("string"==typeof c&&Uo.test(c)&&(s=c,Wo))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),s=Zi(t.pathname,m);t.origin===e.origin&&null!=s?c=s+t.search+t.hash:p=!0}catch(gb){}let f=function(e,t){let{relative:s}=void 0===t?{}:t;go()||Pi(!1);let{basename:r,navigator:a}=Ke.useContext(mo),{hash:n,pathname:i,search:o}=bo(e,{relative:s}),l=i;return"/"!==r&&(l="/"===i?r:ro([r,i])),a.createHref({pathname:l,search:o,hash:n})}(c,{relative:a}),x=function(e,t){let{target:s,replace:r,state:a,preventScrollReset:n,relative:i,viewTransition:o}=void 0===t?{}:t,l=jo(),c=vo(),d=bo(e,{relative:i});return Ke.useCallback(t=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(t,s)){t.preventDefault();let s=void 0!==r?r:Ri(c)===Ri(d);l(e,{replace:s,state:a,preventScrollReset:n,relative:i,viewTransition:o})}},[c,l,d,r,a,s,e,n,i,o])}(c,{replace:i,state:o,target:l,preventScrollReset:d,relative:a,viewTransition:u});return Ke.createElement("a",Ro({},h,{href:s||f,onClick:p||n?r:function(e){r&&r(e),e.defaultPrevented||x(e)},ref:t,target:l}))}),Bo=Ke.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:r=!1,className:a="",end:n=!1,style:i,to:o,viewTransition:l,children:c}=e,d=Io(e,qo),u=bo(o,{relative:d.relative}),h=vo(),m=Ke.useContext(ho),{navigator:p,basename:f}=Ke.useContext(mo),x=null!=m&&function(e,t){void 0===t&&(t={});let s=Ke.useContext(Fo);null==s&&Pi(!1);let{basename:r}=function(){let e=Ke.useContext(uo);return e||Pi(!1),e}(Ho.useViewTransitionState),a=bo(e,{relative:t.relative});if(!s.isTransitioning)return!1;let n=Zi(s.currentLocation.pathname,r)||s.currentLocation.pathname,i=Zi(s.nextLocation.pathname,r)||s.nextLocation.pathname;return null!=Qi(a.pathname,i)||null!=Qi(a.pathname,n)}(u)&&!0===l,g=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,v=h.pathname,y=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(v=v.toLowerCase(),y=y?y.toLowerCase():null,g=g.toLowerCase()),y&&f&&(y=Zi(y,f)||y);const j="/"!==g&&g.endsWith("/")?g.length-1:g.length;let b,w=v===g||!n&&v.startsWith(g)&&"/"===v.charAt(j),N=null!=y&&(y===g||!n&&y.startsWith(g)&&"/"===y.charAt(g.length)),_={isActive:w,isPending:N,isTransitioning:x},k=w?s:void 0;b="function"==typeof a?a(_):[a,w?"active":null,N?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let S="function"==typeof i?i(_):i;return Ke.createElement(Vo,Ro({},d,{"aria-current":k,className:b,ref:t,style:S,to:o,viewTransition:l}),"function"==typeof c?c(_):c)});var Ho,Yo,Go,Ko;(Yo=Ho||(Ho={})).UseScrollRestoration="useScrollRestoration",Yo.UseSubmit="useSubmit",Yo.UseSubmitFetcher="useSubmitFetcher",Yo.UseFetcher="useFetcher",Yo.useViewTransitionState="useViewTransitionState",(Ko=Go||(Go={})).UseFetcher="useFetcher",Ko.UseFetchers="useFetchers",Ko.UseScrollRestoration="useScrollRestoration";const Jo={},Qo=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/gesflex-pro/"+e}(e))in Jo)return;Jo[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),t?new Promise((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})};class Xo extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Zo extends Xo{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class el extends Xo{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tl extends Xo{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var sl,rl;(rl=sl||(sl={})).Any="any",rl.ApNortheast1="ap-northeast-1",rl.ApNortheast2="ap-northeast-2",rl.ApSouth1="ap-south-1",rl.ApSoutheast1="ap-southeast-1",rl.ApSoutheast2="ap-southeast-2",rl.CaCentral1="ca-central-1",rl.EuCentral1="eu-central-1",rl.EuWest1="eu-west-1",rl.EuWest2="eu-west-2",rl.EuWest3="eu-west-3",rl.SaEast1="sa-east-1",rl.UsEast1="us-east-1",rl.UsWest1="us-west-1",rl.UsWest2="us-west-2";var al=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};class nl{constructor(e,{headers:t={},customFetch:s,region:r=sl.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Qo(async()=>{const{default:e}=await Promise.resolve().then(()=>vl);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return al(this,void 0,void 0,function*(){try{const{headers:r,method:a,body:n}=t;let i={},{region:o}=t;o||(o=this.region);const l=new URL(`${this.url}/${e}`);let c;o&&"any"!==o&&(i["x-region"]=o,l.searchParams.set("forceFunctionRegion",o)),n&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&n instanceof Blob||n instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",c=n):"string"==typeof n?(i["Content-Type"]="text/plain",c=n):"undefined"!=typeof FormData&&n instanceof FormData?c=n:(i["Content-Type"]="application/json",c=JSON.stringify(n)));const d=yield this.fetch(l.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),r),body:c}).catch(e=>{throw new Zo(e)}),u=d.headers.get("x-relay-error");if(u&&"true"===u)throw new el(d);if(!d.ok)throw new tl(d);let h,m=(null!==(s=d.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return h="application/json"===m?yield d.json():"application/octet-stream"===m?yield d.blob():"text/event-stream"===m?d:"multipart/form-data"===m?yield d.formData():yield d.text(),{data:h,error:null,response:d}}catch(r){return{data:null,error:r,response:r instanceof tl||r instanceof el?r.context:void 0}}})}}var il={},ol={},ll={},cl={},dl={},ul={},hl=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const ml=hl.fetch,pl=hl.fetch.bind(hl),fl=hl.Headers,xl=hl.Request,gl=hl.Response,vl=Object.freeze(Object.defineProperty({__proto__:null,Headers:fl,Request:xl,Response:gl,default:pl,fetch:ml},Symbol.toStringTag,{value:"Module"})),yl=Ze(vl);var jl={};Object.defineProperty(jl,"__esModule",{value:!0});let bl=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};jl.default=bl;var wl=et&&et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ul,"__esModule",{value:!0});const Nl=wl(yl),_l=wl(jl);ul.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=Nl.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,r;let a=null,n=null,i=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(n="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&c&&c.length>1&&(i=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(n)&&(n.length>1?(a={code:"PGRST116",details:`Results contain ${n.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},n=null,i=null,o=406,l="Not Acceptable"):n=1===n.length?n[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(n=[],a=null,o=200,l="OK")}catch(c){404===e.status&&""===t?(o=204,l="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(r=null==a?void 0:a.details)||void 0===r?void 0:r.includes("0 rows"))&&(a=null,o=200,l="OK"),a&&this.shouldThrowOnError)throw new _l.default(a)}return{error:a,data:n,count:i,status:o,statusText:l}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};var kl=et&&et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dl,"__esModule",{value:!0});const Sl=kl(ul);let Cl=class extends Sl.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:a=r}={}){const n=a?`${a}.order`:"order",i=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const a=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(n,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:a=!1,format:n="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.Accept)&&void 0!==i?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};dl.default=Cl;var Tl=et&&et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(cl,"__esModule",{value:!0});const El=Tl(dl);let Ml=class extends El.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let a="";"plain"===r?a="pl":"phrase"===r?a="ph":"websearch"===r&&(a="w");const n=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};cl.default=Ml;var Pl=et&&et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ll,"__esModule",{value:!0});const Al=Pl(cl);ll.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let a=!1;const n=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e)).join("");return this.url.searchParams.set("select",n),s&&(this.headers.Prefer=`count=${s}`),new Al.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new Al.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:a=!0}={}){const n=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&n.push(this.headers.Prefer),r&&n.push(`count=${r}`),a||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new Al.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Al.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Al.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Dl={},Ol={};Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.version=void 0,Ol.version="0.0.0-automated",Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.DEFAULT_HEADERS=void 0;const Rl=Ol;Dl.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Rl.version}`};var Il=et&&et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ol,"__esModule",{value:!0});const Ll=Il(ll),ql=Il(cl),Fl=Dl;ol.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Fl.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new Ll.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:a}={}){let n;const i=new URL(`${this.url}/rpc/${e}`);let o;s||r?(n=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{i.searchParams.append(e,t)})):(n="POST",o=t);const l=Object.assign({},this.headers);return a&&(l.Prefer=`count=${a}`),new ql.default({method:n,url:i,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var zl=et&&et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(il,"__esModule",{value:!0}),il.PostgrestError=il.PostgrestBuilder=il.PostgrestTransformBuilder=il.PostgrestFilterBuilder=il.PostgrestQueryBuilder=il.PostgrestClient=void 0;const $l=zl(ol);il.PostgrestClient=$l.default;const Wl=zl(ll);il.PostgrestQueryBuilder=Wl.default;const Ul=zl(cl);il.PostgrestFilterBuilder=Ul.default;const Vl=zl(dl);il.PostgrestTransformBuilder=Vl.default;const Bl=zl(ul);il.PostgrestBuilder=Bl.default;const Hl=zl(jl);il.PostgrestError=Hl.default;var Yl=il.default={PostgrestClient:$l.default,PostgrestQueryBuilder:Wl.default,PostgrestFilterBuilder:Ul.default,PostgrestTransformBuilder:Vl.default,PostgrestBuilder:Bl.default,PostgrestError:Hl.default};const{PostgrestClient:Gl,PostgrestQueryBuilder:Kl,PostgrestFilterBuilder:Jl,PostgrestTransformBuilder:Ql,PostgrestBuilder:Xl,PostgrestError:Zl}=Yl;class ec{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process&&process.versions&&process.versions.node){const e=parseInt(process.versions.node.split(".")[0]);return e>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${e} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${e} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const tc=1e4;var sc,rc,ac,nc,ic,oc,lc,cc,dc,uc,hc;(rc=sc||(sc={}))[rc.connecting=0]="connecting",rc[rc.open=1]="open",rc[rc.closing=2]="closing",rc[rc.closed=3]="closed",(nc=ac||(ac={})).closed="closed",nc.errored="errored",nc.joined="joined",nc.joining="joining",nc.leaving="leaving",(oc=ic||(ic={})).close="phx_close",oc.error="phx_error",oc.join="phx_join",oc.reply="phx_reply",oc.leave="phx_leave",oc.access_token="access_token",(lc||(lc={})).websocket="websocket",(dc=cc||(cc={})).Connecting="connecting",dc.Open="open",dc.Closing="closing",dc.Closed="closed";class mc{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),a=t.getUint8(2);let n=this.HEADER_LENGTH+2;const i=s.decode(e.slice(n,n+r));n+=r;const o=s.decode(e.slice(n,n+a));n+=a;return{ref:null,topic:i,event:o,payload:JSON.parse(s.decode(e.slice(n,e.byteLength)))}}}class pc{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(hc=uc||(uc={})).abstime="abstime",hc.bool="bool",hc.date="date",hc.daterange="daterange",hc.float4="float4",hc.float8="float8",hc.int2="int2",hc.int4="int4",hc.int4range="int4range",hc.int8="int8",hc.int8range="int8range",hc.json="json",hc.jsonb="jsonb",hc.money="money",hc.numeric="numeric",hc.oid="oid",hc.reltime="reltime",hc.text="text",hc.time="time",hc.timestamp="timestamp",hc.timestamptz="timestamptz",hc.timetz="timetz",hc.tsrange="tsrange",hc.tstzrange="tstzrange";const fc=(e,t,s={})=>{var r;const a=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((s,r)=>(s[r]=xc(r,e,t,a),s),{})},xc=(e,t,s,r)=>{const a=t.find(t=>t.name===e),n=null==a?void 0:a.type,i=s[e];return n&&!r.includes(n)?gc(n,i):vc(i)},gc=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return wc(t,s)}switch(e){case uc.bool:return yc(t);case uc.float4:case uc.float8:case uc.int2:case uc.int4:case uc.int8:case uc.numeric:case uc.oid:return jc(t);case uc.json:case uc.jsonb:return bc(t);case uc.timestamp:return Nc(t);case uc.abstime:case uc.date:case uc.daterange:case uc.int4range:case uc.int8range:case uc.money:case uc.reltime:case uc.text:case uc.time:case uc.timestamptz:case uc.timetz:case uc.tsrange:case uc.tstzrange:default:return vc(t)}},vc=e=>e,yc=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},jc=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},bc=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},wc=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const n=e.slice(1,s);try{r=JSON.parse("["+n+"]")}catch(a){r=n?n.split(","):[]}return r.map(e=>gc(t,e))}return e},Nc=e=>"string"==typeof e?e.replace(" ","T"):e,_c=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class kc{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Sc,Cc,Tc,Ec,Mc,Pc,Ac,Dc;(Cc=Sc||(Sc={})).SYNC="sync",Cc.JOIN="join",Cc.LEAVE="leave";class Oc{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Oc.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=Oc.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],r()}),this.channel._on(s.diff,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Oc.syncDiff(this.state,e,t,s),r())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const a=this.cloneDeep(e),n=this.transformState(t),i={},o={};return this.map(a,(e,t)=>{n[e]||(o[e]=t)}),this.map(n,(e,t)=>{const s=a[e];if(s){const r=t.map(e=>e.presence_ref),a=s.map(e=>e.presence_ref),n=t.filter(e=>a.indexOf(e.presence_ref)<0),l=s.filter(e=>r.indexOf(e.presence_ref)<0);n.length>0&&(i[e]=n),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(a,{joins:i,leaves:o},s,r)}static syncDiff(e,t,s,r){const{joins:a,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(a,(t,r)=>{var a;const n=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(r),n.length>0){const s=e[t].map(e=>e.presence_ref),r=n.filter(e=>s.indexOf(e.presence_ref)<0);e[t].unshift(...r)}s(t,n,r)}),this.map(n,(t,s)=>{let a=e[t];if(!a)return;const n=s.map(e=>e.presence_ref);a=a.filter(e=>n.indexOf(e.presence_ref)<0),e[t]=a,r(t,a,s),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Ec=Tc||(Tc={})).ALL="*",Ec.INSERT="INSERT",Ec.UPDATE="UPDATE",Ec.DELETE="DELETE",(Pc=Mc||(Mc={})).BROADCAST="broadcast",Pc.PRESENCE="presence",Pc.POSTGRES_CHANGES="postgres_changes",Pc.SYSTEM="system",(Dc=Ac||(Ac={})).SUBSCRIBED="SUBSCRIBED",Dc.TIMED_OUT="TIMED_OUT",Dc.CLOSED="CLOSED",Dc.CHANNEL_ERROR="CHANNEL_ERROR";class Rc{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=ac.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new kc(this,ic.join,this.params,this.timeout),this.rejoinTimer=new pc(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ac.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ac.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=ac.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ac.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=ac.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ic.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Oc(this),this.broadcastEndpointURL=_c(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.state==ac.closed){const{config:{broadcast:a,presence:n,private:i}}=this.params,o=null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==r?r:[],l=!!this.bindings[Mc.PRESENCE]&&this.bindings[Mc.PRESENCE].length>0,c={},d={broadcast:a,presence:Object.assign(Object.assign({},n),{enabled:l}),postgres_changes:o,private:i};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(Ac.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(Ac.CLOSED)),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,a=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,n=[];for(let s=0;s<a;s++){const a=r[s],{filter:{event:i,schema:o,table:l,filter:c}}=a,d=t&&t[s];if(!d||d.event!==i||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),this.state=ac.errored,void(null==e||e(Ac.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=n,void(e&&e(Ac.SUBSCRIBED))}null==e||e(Ac.SUBSCRIBED)}).receive("error",t=>{this.state=ac.errored,null==e||e(Ac.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(Ac.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===ac.joined&&e===Mc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var r,a,n;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(a=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===a?void 0:a.broadcast)||void 0===n?void 0:n.ack)||s("ok"),i.receive("ok",()=>s("ok")),i.receive("error",()=>s("error")),i.receive("timeout",()=>s("timed out"))});{const{event:n,payload:i}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ac.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ic.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new kc(this,ic.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null==s||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ac.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const r=new AbortController,a=setTimeout(()=>r.abort(),s),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),n}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new kc(this,e,t,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,a;const n=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=ic;if(s&&[i,o,l,c].indexOf(n)>=0&&s!==this._joinRef())return;let d=this._onMessage(n,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===n}).map(e=>e.callback(d,s)):null===(a=this.bindings[n])||void 0===a||a.filter(e=>{var s,r,a,i,o,l;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,i=null===(s=e.filter)||void 0===s?void 0:s.event;return n&&(null===(r=t.ids)||void 0===r?void 0:r.includes(n))&&("*"===i||(null==i?void 0:i.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const s=null===(o=null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n}).map(e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:r,type:a,errors:n}=e,i={schema:t,table:s,commit_timestamp:r,eventType:a,new:{},old:{},errors:n};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,s)})}_isClosed(){return this.state===ac.closed}_isJoined(){return this.state===ac.joined}_isJoining(){return this.state===ac.joining}_isLeaving(){return this.state===ac.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&Rc.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ic.close,{},e)}_onError(e){this._on(ic.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ac.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=fc(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=fc(e.columns,e.old_record)),t}}const Ic=()=>{},Lc=25e3,qc=10,Fc=100,zc=[1e3,2e3,5e3,1e4];class $c{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=tc,this.transport=null,this.heartbeatIntervalMs=Lc,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ic,this.ref=0,this.reconnectTimer=null,this.logger=Ic,this.conn=null,this.sendBuffer=[],this.serializer=new mc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Qo(async()=>{const{default:e}=await Promise.resolve().then(()=>vl);return{default:e}},void 0).then(({default:t})=>t(...e)).catch(e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${lc.websocket}`,this.httpEndpoint=_c(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ec.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case sc.connecting:return cc.Connecting;case sc.open:return cc.Open;case sc.closing:return cc.Closing;default:return cc.Closed}}isConnected(){return this.connectionState()===cc.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(e=>e.topic===s);if(r)return r;{const s=new Rc(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:r,ref:a}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${s} (${a})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Fc);this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}else this.heartbeatCallback("disconnected")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{"phoenix"===e.topic&&"phx_reply"===e.event&&this.heartbeatCallback("ok"===e.payload.status?"ok":"error"),e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:s,payload:r,ref:a}=e,n=a?`(${a})`:"",i=r.status||"";this.log("receive",`${i} ${t} ${s} ${n}`.trim(),r),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,r,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ic.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const s={access_token:t,version:"realtime-js/2.15.1"};t&&e.updateJoinPayload(s),e.joinedOnce&&e._isJoined()&&e._push(ic.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(gb){this.log("error",`error in ${e} callback`,gb)}})}catch(gb){this.log("error",`error triggering ${e} callbacks`,gb)}}_setupReconnectionTimer(){this.reconnectTimer=new pc(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},qc)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,r,a,n,i,o,l;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(s=null==e?void 0:e.timeout)&&void 0!==s?s:tc,this.heartbeatIntervalMs=null!==(r=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==r?r:Lc,this.worker=null!==(a=null==e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(n=null==e?void 0:e.accessToken)&&void 0!==n?n:null,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(i=null==e?void 0:e.reconnectAfterMs)&&void 0!==i?i:e=>zc[e-1]||1e4,this.encode=null!==(o=null==e?void 0:e.encode)&&void 0!==o?o:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(l=null==e?void 0:e.decode)&&void 0!==l?l:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class Wc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Uc(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class Vc extends Wc{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Bc extends Wc{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Hc=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};const Yc=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Qo(async()=>{const{default:e}=await Promise.resolve().then(()=>vl);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},Gc=e=>{if(Array.isArray(e))return e.map(e=>Gc(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,s])=>{const r=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=Gc(s)}),t};var Kc=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};const Jc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qc=(e,t,s)=>Kc(void 0,void 0,void 0,function*(){const r=yield Hc(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Qo(()=>Promise.resolve().then(()=>vl),void 0)).Response:Response});e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then(s=>{const r=e.status||500,a=(null==s?void 0:s.statusCode)||r+"";t(new Vc(Jc(s),r,a))}).catch(e=>{t(new Bc(Jc(e),e))}):t(new Bc(Jc(e),e))}),Xc=(e,t,s,r)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&r?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(r)?(a.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(r)):a.body=r,(null==t?void 0:t.duplex)&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),s)):a};function Zc(e,t,s,r,a,n){return Kc(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(s,Xc(t,r,a,n)).then(e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>Qc(e,o,r))})})}function ed(e,t,s,r){return Kc(this,void 0,void 0,function*(){return Zc(e,"GET",t,s,r)})}function td(e,t,s,r,a){return Kc(this,void 0,void 0,function*(){return Zc(e,"POST",t,r,a,s)})}function sd(e,t,s,r,a){return Kc(this,void 0,void 0,function*(){return Zc(e,"PUT",t,r,a,s)})}function rd(e,t,s,r,a){return Kc(this,void 0,void 0,function*(){return Zc(e,"DELETE",t,r,a,s)})}var ad=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};const nd={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},id={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class od{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Yc(r)}uploadOrUpdate(e,t,s,r){return ad(this,void 0,void 0,function*(){try{let a;const n=Object.assign(Object.assign({},id),r);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)});const o=n.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(a=new FormData,a.append("cacheControl",n.cacheControl),o&&a.append("metadata",this.encodeMetadata(o)),a.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(a=s,a.append("cacheControl",n.cacheControl),o&&a.append("metadata",this.encodeMetadata(o))):(a=s,i["cache-control"]=`max-age=${n.cacheControl}`,i["content-type"]=n.contentType,o&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(i=Object.assign(Object.assign({},i),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield("PUT"==e?sd:td)(this.fetch,`${this.url}/object/${c}`,a,Object.assign({headers:i},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{}));return{data:{path:l,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(Uc(a))return{data:null,error:a};throw a}})}upload(e,t,s){return ad(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return ad(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),n=this._getFinalPath(a),i=new URL(this.url+`/object/upload/sign/${n}`);i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:id.upsert},r),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType);return{data:{path:a,fullPath:(yield sd(this.fetch,i.toString(),e,{headers:n})).Key},error:null}}catch(o){if(Uc(o))return{data:null,error:o};throw o}})}createSignedUploadUrl(e,t){return ad(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const a=yield td(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),n=new URL(this.url+a.url),i=n.searchParams.get("token");if(!i)throw new Wc("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:i},error:null}}catch(s){if(Uc(s))return{data:null,error:s};throw s}})}update(e,t,s){return ad(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return ad(this,void 0,void 0,function*(){try{return{data:yield td(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(Uc(r))return{data:null,error:r};throw r}})}copy(e,t,s){return ad(this,void 0,void 0,function*(){try{return{data:{path:(yield td(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(Uc(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return ad(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),a=yield td(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${n}`)},{data:a,error:null}}catch(r){if(Uc(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return ad(this,void 0,void 0,function*(){try{const r=yield td(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${a}`):null})),error:null}}catch(r){if(Uc(r))return{data:null,error:r};throw r}})}download(e,t){return ad(this,void 0,void 0,function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),a=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield ed(this.fetch,`${this.url}/${s}/${t}${a}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(n){if(Uc(n))return{data:null,error:n};throw n}})}info(e){return ad(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield ed(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Gc(e),error:null}}catch(s){if(Uc(s))return{data:null,error:s};throw s}})}exists(e){return ad(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return Kc(this,void 0,void 0,function*(){return Zc(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Uc(s)&&s instanceof Bc){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],a=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&r.push(a);const n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&r.push(i);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${s}${o}`)}}}remove(e){return ad(this,void 0,void 0,function*(){try{return{data:yield rd(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Uc(t))return{data:null,error:t};throw t}})}list(e,t,s){return ad(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},nd),t),{prefix:e||""});return{data:yield td(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(Uc(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ld={"X-Client-Info":"storage-js/2.10.5"};var cd=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};class dd{constructor(e,t={},s,r){const a=new URL(e);if(null==r?void 0:r.useNewHostname){/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."))}this.url=a.href,this.headers=Object.assign(Object.assign({},ld),t),this.fetch=Yc(s)}listBuckets(){return cd(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Uc(e))return{data:null,error:e};throw e}})}getBucket(e){return cd(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Uc(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return cd(this,void 0,void 0,function*(){try{return{data:yield td(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Uc(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return cd(this,void 0,void 0,function*(){try{return{data:yield sd(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Uc(s))return{data:null,error:s};throw s}})}emptyBucket(e){return cd(this,void 0,void 0,function*(){try{return{data:yield td(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Uc(t))return{data:null,error:t};throw t}})}deleteBucket(e){return cd(this,void 0,void 0,function*(){try{return{data:yield rd(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Uc(t))return{data:null,error:t};throw t}})}}class ud extends dd{constructor(e,t={},s,r){super(e,t,s,r)}from(e){return new od(this.url,this.headers,e,this.fetch)}}let hd="";hd="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const md={headers:{"X-Client-Info":`supabase-js-${hd}/2.55.0`}},pd={schema:"public"},fd={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},xd={};var gd=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};const vd=(e,t,s)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?pl:fetch),(...e)=>t(...e)})(s),a="undefined"==typeof Headers?fl:Headers;return(s,n)=>gd(void 0,void 0,void 0,function*(){var i;const o=null!==(i=yield t())&&void 0!==i?i:e;let l=new a(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(s,Object.assign(Object.assign({},n),{headers:l}))})};var yd=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};const jd="2.71.1",bd=3e4,wd=9e4,Nd={"X-Client-Info":`gotrue-js/${jd}`},_d="X-Supabase-Api-Version",kd={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Sd=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Cd extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Td(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Ed extends Cd{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class Md extends Cd{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Pd extends Cd{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class Ad extends Pd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Dd extends Pd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Od extends Pd{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Rd extends Pd{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Id extends Pd{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ld extends Pd{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function qd(e){return Td(e)&&"AuthRetryableFetchError"===e.name}class Fd extends Pd{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class zd extends Pd{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const $d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Wd=" \t\n\r=".split(""),Ud=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Wd.length;t+=1)e[Wd[t].charCodeAt(0)]=-2;for(let t=0;t<$d.length;t+=1)e[$d[t].charCodeAt(0)]=t;return e})();function Vd(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s($d[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s($d[e]),t.queuedBits-=6}}function Bd(e,t,s){const r=Ud[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Hd(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},n=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,r,s)};for(let i=0;i<e.length;i+=1)Bd(e.charCodeAt(i),a,n);return t.join("")}function Yd(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Gd(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Bd(e.charCodeAt(a),s,r);return new Uint8Array(t)}function Kd(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}Yd(r,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function Jd(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>Vd(e,s,r)),Vd(null,s,r),t.join("")}const Qd=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Xd={tested:!1,writable:!1},Zd=()=>{if(!Qd())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(gb){return!1}if(Xd.tested)return Xd.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Xd.tested=!0,Xd.writable=!0}catch(gb){Xd.tested=!0,Xd.writable=!1}return Xd.writable};const eu=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Qo(async()=>{const{default:e}=await Promise.resolve().then(()=>vl);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},tu=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},su=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}},ru=async(e,t)=>{await e.removeItem(t)};class au{constructor(){this.promise=new au.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function nu(e){const t=e.split(".");if(3!==t.length)throw new zd("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!Sd.test(t[s]))throw new zd("JWT not in base64url format");return{header:JSON.parse(Hd(t[0])),payload:JSON.parse(Hd(t[1])),signature:Gd(t[2]),raw:{header:t[0],payload:t[1]}}}function iu(e){return("0"+e.toString(16)).substr(-2)}async function ou(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lu(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,iu).join("")}();let a=r;s&&(a+="/PASSWORD_RECOVERY"),await tu(e,`${t}-code-verifier`,a);const n=await ou(r);return[n,r===n?"plain":"s256"]}au.promiseConstructor=Promise;const cu=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const du=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function uu(e){if(!du.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hu(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function mu(e){return JSON.parse(JSON.stringify(e))}const pu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),fu=[502,503,504];async function xu(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new Ld(pu(e),0);if(fu.includes(e.status))throw new Ld(pu(e),e.status);let r,a;try{r=await e.json()}catch(gb){throw new Md(pu(gb),gb)}const n=function(e){const t=e.headers.get(_d);if(!t)return null;if(!t.match(cu))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(gb){return null}}(e);if(n&&n.getTime()>=kd.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?a=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(a=r.error_code),a){if("weak_password"===a)throw new Fd(pu(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Ad}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new Fd(pu(r),e.status,r.weak_password.reasons);throw new Ed(pu(r),e.status||500,a)}async function gu(e,t,s,r){var a;const n=Object.assign({},null==r?void 0:r.headers);n[_d]||(n[_d]=kd.name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);const i=null!==(a=null==r?void 0:r.query)&&void 0!==a?a:{};(null==r?void 0:r.redirectTo)&&(i.redirect_to=r.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,s,r,a,n){const i=((e,t,s,r)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),s))})(t,r,a,n);let o;try{o=await e(s,Object.assign({},i))}catch(gb){throw new Ld(pu(gb),0)}o.ok||await xu(o);if(null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(gb){await xu(gb)}}(e,t,s+o,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function vu(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function yu(e){const t=vu(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function ju(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function bu(e){return{data:e,error:null}}function wu(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:n}=e,i=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(s[r[a]]=e[r[a]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:n},user:Object.assign({},i)},error:null}}function Nu(e){return e}const _u=["global","local","others"];class ku{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=eu(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=_u[0]){if(_u.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${_u.join(", ")}`);try{return await gu(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Td(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await gu(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ju})}catch(s){if(Td(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(s[r[a]]=e[r[a]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await gu(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:wu,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Td(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await gu(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ju})}catch(t){if(Td(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,a,n,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await gu(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(a=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==a?a:""},xform:Nu});if(c.error)throw c.error;const d=await c.json(),u=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Td(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){uu(e);try{return await gu(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ju})}catch(t){if(Td(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){uu(e);try{return await gu(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ju})}catch(s){if(Td(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){uu(e);try{return await gu(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ju})}catch(s){if(Td(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){uu(e.userId);try{const{data:t,error:s}=await gu(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(Td(t))return{data:null,error:t};throw t}}async _deleteFactor(e){uu(e.userId),uu(e.id);try{return{data:await gu(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Td(t))return{data:null,error:t};throw t}}}function Su(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const Cu=!!(globalThis&&Zd()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Tu extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Eu extends Tu{}async function Mu(e,t,s){const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort()},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(!r){if(0===t)throw new Eu(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Cu)try{await globalThis.navigator.locks.query()}catch(gb){}return await s()}try{return await s()}finally{}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(gb){"undefined"!=typeof self&&(self.globalThis=self)}}();const Pu={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Nd,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Au(e,t,s){return await s()}const Du={};class Ou{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ou.nextInstanceID,Ou.nextInstanceID+=1,this.instanceID>0&&Qd();const r=Object.assign(Object.assign({},Pu),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new ku({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=eu(r.fetch),this.lock=r.lock||Au,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Qd()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Mu:this.lock=Au,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:Zd()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Su(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=Su(this.memoryStorage)),Qd()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(gb){}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=Du[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Du[this.storageKey]=Object.assign(Object.assign({},Du[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Du[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Du[this.storageKey]=Object.assign(Object.assign({},Du[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${jd}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(gb){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Qd()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return Td(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:n,redirectType:i}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Td(t)?{error:t}:{error:new Md("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const a=await gu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:vu}),{data:n,error:i}=a;if(i||!n)return{data:{user:null,session:null},error:i};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Td(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,r;try{let a;if("email"in e){const{email:s,password:r,options:n}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await lu(this.storage,this.storageKey)),a=await gu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},xform:vu})}else{if(!("phone"in e))throw new Od("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:i}=e;a=await gu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(s=null==i?void 0:i.data)&&void 0!==s?s:{},channel:null!==(r=null==i?void 0:i.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:vu})}}const{data:n,error:i}=a;if(i||!n)return{data:{user:null,session:null},error:i};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Td(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:a}=e;t=await gu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:yu})}else{if(!("phone"in e))throw new Od("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:a}=e;t=await gu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:yu})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new Dd}}catch(t){if(Td(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,r,a,n,i,o,l,c,d,u,h;let m,p;if("message"in e)m=e.message,p=e.signature;else{const{chain:u,wallet:h,statement:f,options:x}=e;let g;if(Qd())if("object"==typeof h)g=h;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");g=e.solana}else{if("object"!=typeof h||!(null==x?void 0:x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=h}const v=new URL(null!==(t=null==x?void 0:x.url)&&void 0!==t?t:window.location.href);if("signIn"in g&&g.signIn){const e=await g.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==x?void 0:x.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),f?{statement:f}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");m="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in g&&"function"==typeof g.signMessage&&"publicKey"in g&&"object"==typeof g&&g.publicKey&&"toBase58"in g.publicKey&&"function"==typeof g.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${v.host} wants you to sign in with your Solana account:`,g.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(r=null===(s=null==x?void 0:x.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==r?r:(new Date).toISOString()}`,...(null===(a=null==x?void 0:x.signInWithSolana)||void 0===a?void 0:a.notBefore)?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...(null===(n=null==x?void 0:x.signInWithSolana)||void 0===n?void 0:n.expirationTime)?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...(null===(i=null==x?void 0:x.signInWithSolana)||void 0===i?void 0:i.chainId)?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...(null===(o=null==x?void 0:x.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...(null===(l=null==x?void 0:x.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...(null===(d=null===(c=null==x?void 0:x.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...x.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await g.signMessage((new TextEncoder).encode(m),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:s}=await gu(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Jd(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:vu});if(s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new Dd}}catch(f){if(Td(f))return{data:{user:null,session:null},error:f};throw f}}async _exchangeCodeForSession(e){const t=await su(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:a}=await gu(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:vu});if(await ru(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new Dd}}catch(a){if(Td(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:a,nonce:n}=e,i=await gu(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:a,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:vu}),{data:o,error:l}=i;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Dd}}catch(t){if(Td(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,a,n;try{if("email"in e){const{email:r,options:a}=e;let n=null,i=null;"pkce"===this.flowType&&([n,i]=await lu(this.storage,this.storageKey));const{error:o}=await gu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(s=null==a?void 0:a.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:n,code_challenge_method:i},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:i,error:o}=await gu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(a=null==s?void 0:s.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new Od("You must provide either an email or phone number.")}catch(i){if(Td(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,s;try{let r,a;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:n,error:i}=await gu(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:vu});if(i)throw i;if(!n)throw new Error("An error occurred on token verification.");const o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Td(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let a=null,n=null;return"pkce"===this.flowType&&([a,n]=await lu(this.storage,this.storageKey)),await gu(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:n}),headers:this.headers,xform:bu})}catch(a){if(Td(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Ad;const{error:r}=await gu(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Td(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:a}=e,{error:n}=await gu(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){const{phone:s,type:r,options:a}=e,{data:n,error:i}=await gu(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:i}}throw new Od("You must provide either an email or phone number and a type")}catch(t){if(Td(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(gb){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(gb){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await su(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<wd;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const t=await su(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=hu()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await gu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ju}):await this._useSession(async e=>{var t,s,r;const{data:a,error:n}=e;if(n)throw n;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await gu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:ju}):{data:{user:null},error:new Ad}})}catch(t){if(Td(t))return function(e){return Td(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await ru(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:a}=s;if(a)throw a;if(!r.session)throw new Ad;const n=r.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await lu(this.storage,this.storageKey));const{data:l,error:c}=await gu(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:n.access_token,xform:ju});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}})}catch(s){if(Td(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ad;const t=Date.now()/1e3;let s=t,r=!0,a=null;const{payload:n}=nu(e.access_token);if(n.exp&&(s=n.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:r,error:n}=await this._getUser(e.access_token);if(n)throw n;a={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Td(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:r,error:a}=t;if(a)throw a;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new Ad;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Td(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Qd())throw new Rd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Rd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Id("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Rd("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Id("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:a,refresh_token:n,expires_in:i,expires_at:o,token_type:l}=e;if(!(a&&i&&n&&l))throw new Rd("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const{data:h,error:m}=await this._getUser(a);if(m)throw m;const p={provider_token:s,provider_refresh_token:r,access_token:a,expires_in:d,expires_at:u,refresh_token:n,token_type:l,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(s){if(Td(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await su(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:a}=t;if(a)return{error:a};const n=null===(s=r.session)||void 0===s?void 0:s.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return Td(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await ru(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:r},error:a}=t;if(a)throw a;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(a){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await lu(this.storage,this.storageKey,!0));try{return await gu(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Td(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Td(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async t=>{var s,r,a,n,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await gu(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==i?i:void 0})});if(r)throw r;return Qd()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(Td(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:a,error:n}=t;if(n)throw n;return await gu(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})})}catch(t){if(Td(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await gu(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:vu})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&qd(t)&&Date.now()+s-a<bd},new Promise((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await s(a);if(!r(a,null,t))return void e(t)}catch(gb){if(!r(a,gb))return void t(gb)}})()}))}catch(a){if(this._debug(t,"error",a),Td(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Qd()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await su(this.storage,this.storageKey);if(a&&this.userStorage){let t=await su(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await tu(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:hu()}else if(a&&!a.user&&!a.user){const e=await su(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(a.user=e.user,await ru(this.storage,this.storageKey+"-user"),await tu(this.storage,this.storageKey,a)):a.user=hu()}if(this._debug(s,"session from storage",a),!this._isValidSession(a))return this._debug(s,"session is not valid"),void(null!==a&&await this._removeSession());const n=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<wd;if(this._debug(s,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(qd(e)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null==e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(r){this._debug(s,"error getting user data, skipping SIGNED_IN notification",r)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return void this._debug(s,"error",a)}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Ad;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new au;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new Ad;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(a){if(this._debug(r,"error",a),Td(a)){const e={session:null,error:a};return qd(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(gb){r.push(gb)}});if(await Promise.all(a),r.length>0){for(let e=0;e<r.length;e+=1);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await tu(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const r=mu(e);await tu(this.storage,this.storageKey,r)}else{const e=mu(t);await tu(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await ru(this.storage,this.storageKey),await ru(this.storage,this.storageKey+"-code-verifier"),await ru(this.storage,this.storageKey+"-user"),this.userStorage&&await ru(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Qd()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(gb){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),bd);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-e)/bd);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)})}catch(gb){}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(gb){if(!(gb.isAcquireTimeout||gb instanceof Tu))throw gb;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qd()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await lu(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await gu(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(t){if(Td(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:a,error:n}=t;if(n)return{data:null,error:n};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await gu(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(s=null==a?void 0:a.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(t){if(Td(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:n,error:i}=await gu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:i})})}catch(t){if(Td(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await gu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(t){if(Td(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter(e=>"totp"===e.factor_type&&"verified"===e.status),a=s.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:s,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:n}=nu(r.access_token);let i=null;n.aal&&(i=n.aal);let o=i;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:n.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(t=>t.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(t=>t.kid===e),s&&this.jwks_cached_at+6e5>r)return s;const{data:a,error:n}=await gu(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return a.keys&&0!==a.keys.length?(this.jwks=a,this.jwks_cached_at=r,s=a.keys.find(t=>t.kid===e),s||null):null}async getClaims(e,t={}){try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:r,payload:a,signature:n,raw:{header:i,payload:o}}=nu(s);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const l=r.alg&&!r.alg.startsWith("HS")&&r.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(r.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:a,header:r,signature:n},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!(await crypto.subtle.verify(c,d,n,Kd(`${i}.${o}`))))throw new zd("Invalid JWT signature");return{data:{claims:a,header:r,signature:n},error:null}}catch(s){if(Td(s))return{data:null,error:s};throw s}}}Ou.nextInstanceID=0;const Ru=Ou;class Iu extends Ru{constructor(e){super(e)}}var Lu=function(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{l(r.next(e))}catch(gb){n(gb)}}function o(e){try{l(r.throw(e))}catch(gb){n(gb)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})};class qu{constructor(e,t,s){var r,a,n;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const i=(o=e).endsWith("/")?o:o+"/";var o;const l=new URL(i);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d=function(e,t){var s,r;const{db:a,auth:n,realtime:i,global:o}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},null!==(s=null==u?void 0:u.headers)&&void 0!==s?s:{}),null!==(r=null==o?void 0:o.headers)&&void 0!==r?r:{})}),accessToken:()=>yd(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=s?s:{},{db:pd,realtime:xd,auth:Object.assign(Object.assign({},fd),{storageKey:c}),global:md});this.storageKey=null!==(r=d.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(a=d.global.headers)&&void 0!==a?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(n=d.auth)&&void 0!==n?n:{},this.headers,d.global.fetch),this.fetch=vd(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Gl(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new ud(this.storageUrl.href,this.headers,this.fetch,null==s?void 0:s.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new nl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Lu(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:a,flowType:n,lock:i,debug:o},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Iu({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),l),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:n,lock:i,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new $c(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}!function(){if("undefined"!=typeof window)return!1;if("undefined"==typeof process)return!1;const e=process.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);!!t&&parseInt(t[1],10)}();const Fu=(zu={auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}},new qu("https://nyhsodozcijlfkmveabi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im55aHNvZG96Y2lqbGZrbXZlYWJpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3MjM0ODQsImV4cCI6MjA3MDI5OTQ4NH0.s7lbiFh-lChmxE6qVbKMjYy_XmjBpqbMzdml0yT225I",zu));var zu;const $u=Ke.createContext(void 0);function Wu({children:e}){const[t,s]=Ke.useState(null),[r,a]=Ke.useState(null),[n,i]=Ke.useState(!0),[o,l]=Ke.useState(!1),c=jo(),d=async()=>{await Fu.auth.signOut(),a(null),c("/login",{replace:!0})};Ke.useEffect(()=>{Fu.auth.getSession().then(({data:{session:e}})=>{s((null==e?void 0:e.user)??null),(null==e?void 0:e.user)?u(e.user.id):i(!1)});const{data:{subscription:e}}=Fu.auth.onAuthStateChange((e,t)=>{s((null==t?void 0:t.user)??null),(null==t?void 0:t.user)?setTimeout(()=>{u(t.user.id)},0):(a(null),i(!1))});return()=>e.unsubscribe()},[]),Ke.useEffect(()=>{if(!n&&!o)if(t){const e=window.location.pathname;if(!r)return;switch(r.status){case"pending":"/pending"!==e&&c("/pending",{replace:!0});break;case"rejected":d();break;case"active":"/login"!==e&&"/pending"!==e||(["SuperAdmin","Admin"].includes(r.role)?c("/admin",{replace:!0}):c("/dashboard",{replace:!0}))}}else{"/login"!==window.location.pathname&&c("/login",{replace:!0})}},[t,r,n,o,c]),Ke.useEffect(()=>{!n&&t&&r&&"rejected"===r.status&&d()},[null==r?void 0:r.status,t,n,d]);const u=async e=>{var t,s;i(!0);try{const{data:r,error:n}=await Fu.from("users").select("*").eq("auth_id",e).maybeSingle();if(n)a(null);else if(r)a(r);else try{l(!0);const{data:r}=await Fu.auth.getUser(),n=null==r?void 0:r.user,i=(null==n?void 0:n.email)??"",o=(null==(t=null==n?void 0:n.user_metadata)?void 0:t.first_name)??"Utilisateur",c=(null==(s=null==n?void 0:n.user_metadata)?void 0:s.last_name)??"Nouveau",{data:d,error:u}=await Fu.from("users").insert({auth_id:e,email:i,first_name:o,last_name:c,role:"Vendeur",status:"pending"}).select("*").maybeSingle();a(u?null:d??null),l(!1)}catch(gb){a(null),l(!1)}}catch(r){a(null)}finally{i(!1)}},h={user:t,userProfile:r,loading:n,signIn:async(e,t)=>{const{error:s}=await Fu.auth.signInWithPassword({email:e,password:t});if(s)throw s},signUp:async(e,t,s,r)=>{const a=`${window.location.origin}/`,{error:n}=await Fu.auth.signUp({email:e,password:t,options:{emailRedirectTo:a,data:{first_name:s,last_name:r}}});if(n)throw n},signOut:d};return K.jsx($u.Provider,{value:h,children:e})}function Uu(){const e=Ke.useContext($u);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}function Vu({children:e,allowedRoles:t}){const{user:s,userProfile:r,loading:a}=Uu();return a?K.jsx("div",{className:"min-h-screen flex items-center justify-center",children:K.jsxs("div",{className:"text-center",children:[K.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),K.jsx("p",{className:"text-muted-foreground",children:"Chargement..."})]})}):s&&r?"active"!==r.status?null:t&&!t.includes(r.role)?K.jsx("div",{className:"min-h-screen flex items-center justify-center",children:K.jsxs("div",{className:"text-center",children:[K.jsx("h1",{className:"text-2xl font-bold text-destructive mb-4",children:"Accs refus"}),K.jsx("p",{className:"text-muted-foreground",children:"Vous n'avez pas les permissions ncessaires pour accder  cette page."})]})}):K.jsx(K.Fragment,{children:e}):null}const Bu=_s("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-gradient-primary text-primary-foreground hover:shadow-elevated transform hover:scale-[1.02]",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-gradient-success text-success-foreground hover:shadow-elevated transform hover:scale-[1.02]",warning:"bg-warning text-warning-foreground hover:bg-warning/90"},size:{default:"h-12 px-6 py-3",sm:"h-10 rounded-lg px-4",lg:"h-14 rounded-xl px-8 text-base",icon:"h-12 w-12",touch:"h-14 px-6 text-base min-w-[120px]"}},defaultVariants:{variant:"default",size:"default"}}),Hu=Ke.forwardRef(({className:e,variant:t,size:s,asChild:r=!1,...a},n)=>{const i=r?ge:"button";return K.jsx(i,{className:Aa(Bu({variant:t,size:s,className:e})),ref:n,...a})});Hu.displayName="Button";const Yu=Ke.forwardRef(({className:e,type:t,...s},r)=>K.jsx("input",{type:t,className:Aa("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...s}));Yu.displayName="Input";var Gu="horizontal",Ku=["horizontal","vertical"],Ju=Ke.forwardRef((e,t)=>{const{decorative:s,orientation:r=Gu,...a}=e,n=function(e){return Ku.includes(e)}(r)?r:Gu,i=s?{role:"none"}:{"aria-orientation":"vertical"===n?n:void 0,role:"separator"};return K.jsx(J.div,{"data-orientation":n,...i,...a,ref:t})});Ju.displayName="Separator";var Qu=Ju;const Xu=Ke.forwardRef(({className:e,orientation:t="horizontal",decorative:s=!0,...r},a)=>K.jsx(Qu,{ref:a,decorative:s,orientation:t,className:Aa("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...r}));Xu.displayName=Qu.displayName;const Zu=_e,eh=ye,th=Ke.forwardRef(({className:e,...t},s)=>K.jsx(ve,{className:Aa("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));th.displayName=ve.displayName;const sh=_s("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),rh=Ke.forwardRef(({side:e="right",className:t,children:s,...r},a)=>K.jsxs(eh,{children:[K.jsx(th,{}),K.jsxs(je,{ref:a,className:Aa(sh({side:e}),t),...r,children:[s,K.jsxs(be,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[K.jsx(qr,{className:"h-4 w-4"}),K.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));rh.displayName=je.displayName;Ke.forwardRef(({className:e,...t},s)=>K.jsx(we,{ref:s,className:Aa("text-lg font-semibold text-foreground",e),...t})).displayName=we.displayName;function ah({className:e,...t}){return K.jsx("div",{className:Aa("animate-pulse rounded-md bg-muted",e),...t})}Ke.forwardRef(({className:e,...t},s)=>K.jsx(Ne,{ref:s,className:Aa("text-sm text-muted-foreground",e),...t})).displayName=Ne.displayName;const nh=Ke.createContext(null);function ih(){const e=Ke.useContext(nh);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const oh=Ke.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:s,className:r,style:a,children:n,...i},o)=>{const l=function(){const[e,t]=Ke.useState(void 0);return Ke.useEffect(()=>{const e=window.matchMedia("(max-width: 767px)"),s=()=>{t(window.innerWidth<768)};return e.addEventListener("change",s),t(window.innerWidth<768),()=>e.removeEventListener("change",s)},[]),!!e}(),[c,d]=Ke.useState(!1),[u,h]=Ke.useState(e),m=t??u,p=Ke.useCallback(e=>{const t="function"==typeof e?e(m):e;s?s(t):h(t),document.cookie=`sidebar:state=${t}; path=/; max-age=604800`},[s,m]),f=Ke.useCallback(()=>l?d(e=>!e):p(e=>!e),[l,p,d]);Ke.useEffect(()=>{const e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),f())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[f]);const x=m?"expanded":"collapsed",g=Ke.useMemo(()=>({state:x,open:m,setOpen:p,isMobile:l,openMobile:c,setOpenMobile:d,toggleSidebar:f}),[x,m,p,l,c,d,f]);return K.jsx(nh.Provider,{value:g,children:K.jsx(Ln,{delayDuration:0,children:K.jsx("div",{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...a},className:Aa("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:o,...i,children:n})})})});oh.displayName="SidebarProvider";const lh=Ke.forwardRef(({side:e="left",variant:t="sidebar",collapsible:s="offcanvas",className:r,children:a,...n},i)=>{const{isMobile:o,state:l,openMobile:c,setOpenMobile:d}=ih();return"none"===s?K.jsx("div",{className:Aa("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...n,children:a}):o?K.jsx(Zu,{open:c,onOpenChange:d,...n,children:K.jsx(rh,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:e,children:K.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):K.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":l,"data-collapsible":"collapsed"===l?s:"","data-variant":t,"data-side":e,children:[K.jsx("div",{className:Aa("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===t||"inset"===t?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),K.jsx("div",{className:Aa("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex","left"===e?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===t||"inset"===t?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...n,children:K.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});lh.displayName="Sidebar";const ch=Ke.forwardRef(({className:e,onClick:t,...s},r)=>{const{toggleSidebar:a}=ih();return K.jsxs(Hu,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Aa("h-7 w-7",e),onClick:e=>{null==t||t(e),a()},...s,children:[K.jsx(hr,{}),K.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});ch.displayName="SidebarTrigger";Ke.forwardRef(({className:e,...t},s)=>{const{toggleSidebar:r}=ih();return K.jsx("button",{ref:s,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:Aa("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})}).displayName="SidebarRail";Ke.forwardRef(({className:e,...t},s)=>K.jsx("main",{ref:s,className:Aa("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t})).displayName="SidebarInset";Ke.forwardRef(({className:e,...t},s)=>K.jsx(Yu,{ref:s,"data-sidebar":"input",className:Aa("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t})).displayName="SidebarInput";const dh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,"data-sidebar":"header",className:Aa("flex flex-col gap-2 p-2",e),...t}));dh.displayName="SidebarHeader";Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,"data-sidebar":"footer",className:Aa("flex flex-col gap-2 p-2",e),...t})).displayName="SidebarFooter";Ke.forwardRef(({className:e,...t},s)=>K.jsx(Xu,{ref:s,"data-sidebar":"separator",className:Aa("mx-2 w-auto bg-sidebar-border",e),...t})).displayName="SidebarSeparator";const uh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,"data-sidebar":"content",className:Aa("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));uh.displayName="SidebarContent";const hh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,"data-sidebar":"group",className:Aa("relative flex w-full min-w-0 flex-col p-2",e),...t}));hh.displayName="SidebarGroup";const mh=Ke.forwardRef(({className:e,asChild:t=!1,...s},r)=>{const a=t?ge:"div";return K.jsx(a,{ref:r,"data-sidebar":"group-label",className:Aa("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...s})});mh.displayName="SidebarGroupLabel";Ke.forwardRef(({className:e,asChild:t=!1,...s},r)=>{const a=t?ge:"button";return K.jsx(a,{ref:r,"data-sidebar":"group-action",className:Aa("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...s})}).displayName="SidebarGroupAction";const ph=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,"data-sidebar":"group-content",className:Aa("w-full text-sm",e),...t}));ph.displayName="SidebarGroupContent";const fh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("ul",{ref:s,"data-sidebar":"menu",className:Aa("flex w-full min-w-0 flex-col gap-1",e),...t}));fh.displayName="SidebarMenu";const xh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("li",{ref:s,"data-sidebar":"menu-item",className:Aa("group/menu-item relative",e),...t}));xh.displayName="SidebarMenuItem";const gh=_s("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),vh=Ke.forwardRef(({asChild:e=!1,isActive:t=!1,variant:s="default",size:r="default",tooltip:a,className:n,...i},o)=>{const l=e?ge:"button",{isMobile:c,state:d}=ih(),u=K.jsx(l,{ref:o,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:Aa(gh({variant:s,size:r}),n),...i});return a?("string"==typeof a&&(a={children:a}),K.jsxs(qn,{children:[K.jsx(Fn,{asChild:!0,children:u}),K.jsx(zn,{side:"right",align:"center",hidden:"collapsed"!==d||c,...a})]})):u});vh.displayName="SidebarMenuButton";Ke.forwardRef(({className:e,asChild:t=!1,showOnHover:s=!1,...r},a)=>{const n=t?ge:"button";return K.jsx(n,{ref:a,"data-sidebar":"menu-action",className:Aa("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",s&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})}).displayName="SidebarMenuAction";Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,"data-sidebar":"menu-badge",className:Aa("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t})).displayName="SidebarMenuBadge";Ke.forwardRef(({className:e,showIcon:t=!1,...s},r)=>{const a=Ke.useMemo(()=>`${Math.floor(40*Math.random())+50}%`,[]);return K.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:Aa("rounded-md h-8 flex gap-2 px-2 items-center",e),...s,children:[t&&K.jsx(ah,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),K.jsx(ah,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})}).displayName="SidebarMenuSkeleton";Ke.forwardRef(({className:e,...t},s)=>K.jsx("ul",{ref:s,"data-sidebar":"menu-sub",className:Aa("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t})).displayName="SidebarMenuSub";Ke.forwardRef(({...e},t)=>K.jsx("li",{ref:t,...e})).displayName="SidebarMenuSubItem";Ke.forwardRef(({asChild:e=!1,size:t="md",isActive:s,className:r,...a},n)=>{const i=e?ge:"a";return K.jsx(i,{ref:n,"data-sidebar":"menu-sub-button","data-size":t,"data-active":s,className:Aa("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===t&&"text-xs","md"===t&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})}).displayName="SidebarMenuSubButton";const yh=[{title:"Tableau de bord",url:"/dashboard",icon:sr,roles:["Vendeur","Manager","Admin","SuperAdmin"]},{title:"Produits",url:"/products",icon:dr,roles:["Vendeur","Manager","Admin","SuperAdmin"]},{title:"Arrivage",url:"/arrivals",icon:Pr,roles:["Manager","Admin","SuperAdmin"]},{title:"Achat",url:"/purchases",icon:_r,roles:["Admin","SuperAdmin"]},{title:"Ventes",url:"/sales",icon:Er,roles:["Vendeur","Manager","Admin","SuperAdmin"]},{title:"Retour & changes",url:"/returns",icon:vr,roles:["Vendeur","Manager","Admin","SuperAdmin"]},{title:"Transferts",url:"/transfers",icon:Pr,roles:["Manager","Admin","SuperAdmin"]},{title:"Inventaire",url:"/inventory",icon:Ir,roles:["Manager","Admin","SuperAdmin"]}],jh=[{title:"Utilisateurs",url:"/users",icon:Rr,roles:["Admin","SuperAdmin"]},{title:"Magasins",url:"/stores",icon:Sr,roles:["Admin","SuperAdmin"]},{title:"Fournisseurs",url:"/suppliers",icon:Os,roles:["Admin","SuperAdmin"]},{title:"Gestion Financire",url:"/financial",icon:Ks,roles:["Admin","SuperAdmin"]},{title:"Analytics",url:"/analytics",icon:fr,roles:["Admin","SuperAdmin"]},{title:"Rapports",url:"/reports",icon:As,roles:["Admin","SuperAdmin"]},{title:"Gamification",url:"/gamification",icon:Mr,roles:["Admin","SuperAdmin"]},{title:"Configuration",url:"/configuration",icon:wr,roles:["Admin","SuperAdmin"]}],bh=[{title:"Mon Profil",url:"/profile",icon:Or,roles:["Vendeur","Manager","Admin","SuperAdmin"]}];function wh({userRole:e="Vendeur"}){const{state:t}=ih();vo().pathname;const s="collapsed"===t,r=({isActive:e})=>e?"bg-primary/10 text-primary font-medium border-r-2 border-primary":"hover:bg-accent/50 text-muted-foreground hover:text-foreground",a=yh.filter(t=>t.roles.includes(e)),n=jh.filter(t=>t.roles.includes(e)),i=bh.filter(t=>t.roles.includes(e));return K.jsxs(lh,{className:(s?"w-16":"w-64")+" border-r bg-gradient-to-b from-primary/5 to-background transition-all duration-300",children:[K.jsx(dh,{className:"p-4",children:K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center",children:K.jsx(gr,{className:"w-5 h-5 text-white"})}),!s&&K.jsxs("div",{children:[K.jsx("h1",{className:"text-xl font-bold text-primary",children:"GesFlex"}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Gestion de vente"})]})]})}),K.jsxs(uh,{className:"px-2",children:[K.jsxs(hh,{children:[K.jsx(mh,{className:s?"sr-only":"",children:"Navigation principale"}),K.jsx(ph,{children:K.jsx(fh,{children:a.map(e=>K.jsx(xh,{children:K.jsx(vh,{asChild:!0,className:"h-12",children:K.jsxs(Bo,{to:e.url,className:r,children:[K.jsx(e.icon,{className:"w-5 h-5 shrink-0"}),!s&&K.jsx("span",{className:"text-sm",children:e.title})]})})},e.title))})})]}),n.length>0&&K.jsxs(hh,{children:[K.jsx(mh,{className:s?"sr-only":"",children:"Administration"}),K.jsx(ph,{children:K.jsx(fh,{children:n.map(e=>K.jsx(xh,{children:K.jsx(vh,{asChild:!0,className:"h-12",children:K.jsxs(Bo,{to:e.url,className:r,children:[K.jsx(e.icon,{className:"w-5 h-5 shrink-0"}),!s&&K.jsx("span",{className:"text-sm",children:e.title})]})})},e.title))})})]}),i.length>0&&K.jsxs(hh,{children:[K.jsx(mh,{className:s?"sr-only":"",children:"Utilisateur"}),K.jsx(ph,{children:K.jsx(fh,{children:i.map(e=>K.jsx(xh,{children:K.jsx(vh,{asChild:!0,className:"h-12",children:K.jsxs(Bo,{to:e.url,className:r,children:[K.jsx(e.icon,{className:"w-5 h-5 shrink-0"}),!s&&K.jsx("span",{className:"text-sm",children:e.title})]})})},e.title))})})]})]})]})}const Nh=Re,_h=Ie;Ke.forwardRef(({className:e,inset:t,children:s,...r},a)=>K.jsxs(ke,{ref:a,className:Aa("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...r,children:[s,K.jsx($s,{className:"ml-auto h-4 w-4"})]})).displayName=ke.displayName;Ke.forwardRef(({className:e,...t},s)=>K.jsx(Se,{ref:s,className:Aa("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})).displayName=Se.displayName;const kh=Ke.forwardRef(({className:e,sideOffset:t=4,...s},r)=>K.jsx(Ce,{children:K.jsx(Te,{ref:r,sideOffset:t,className:Aa("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})}));kh.displayName=Te.displayName;const Sh=Ke.forwardRef(({className:e,inset:t,...s},r)=>K.jsx(Ee,{ref:r,className:Aa("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...s}));Sh.displayName=Ee.displayName;Ke.forwardRef(({className:e,children:t,checked:s,...r},a)=>K.jsxs(Me,{ref:a,className:Aa("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:s,...r,children:[K.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:K.jsx(Pe,{children:K.jsx(qs,{className:"h-4 w-4"})})}),t]})).displayName=Me.displayName;Ke.forwardRef(({className:e,children:t,...s},r)=>K.jsxs(Ae,{ref:r,className:Aa("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[K.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:K.jsx(Pe,{children:K.jsx(Us,{className:"h-2 w-2 fill-current"})})}),t]})).displayName=Ae.displayName;const Ch=Ke.forwardRef(({className:e,inset:t,...s},r)=>K.jsx(De,{ref:r,className:Aa("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...s}));Ch.displayName=De.displayName;const Th=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Oe,{ref:s,className:Aa("-mx-1 my-1 h-px bg-muted",e),...t}));function Eh({children:e}){const{signOut:t,userProfile:s}=Uu();return K.jsx(oh,{children:K.jsxs("div",{className:"min-h-screen flex w-full bg-background",children:[K.jsx(wh,{userRole:(null==s?void 0:s.role)||"Vendeur"}),K.jsxs("div",{className:"flex-1 flex flex-col",children:[K.jsx("header",{className:"h-16 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 sticky top-0 z-40",children:K.jsxs("div",{className:"flex items-center justify-between h-full px-4",children:[K.jsxs("div",{className:"flex items-center gap-4",children:[K.jsx(ch,{className:"lg:hidden"}),K.jsxs("div",{className:"hidden lg:block",children:[K.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"GesFlex Pro"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Gestion d'entreprise de vente"})]})]}),K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsxs(Hu,{variant:"ghost",size:"icon",className:"relative",children:[K.jsx(Ds,{className:"h-5 w-5"}),K.jsx("span",{className:"absolute -top-1 -right-1 h-4 w-4 bg-destructive rounded-full text-xs text-white flex items-center justify-center",children:"3"})]}),K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsxs(Hu,{variant:"ghost",className:"flex items-center gap-2 h-10",children:[K.jsx("div",{className:"w-8 h-8 bg-gradient-primary rounded-full flex items-center justify-center",children:K.jsx(Or,{className:"w-4 h-4 text-white"})}),K.jsxs("div",{className:"hidden md:block text-left",children:[K.jsxs("p",{className:"text-sm font-medium",children:[null==s?void 0:s.first_name," ",null==s?void 0:s.last_name]}),K.jsx("p",{className:"text-xs text-muted-foreground",children:null==s?void 0:s.role})]})]})}),K.jsxs(kh,{align:"end",className:"w-56",children:[K.jsx(Ch,{children:"Mon compte"}),K.jsx(Th,{}),K.jsxs(Sh,{children:[K.jsx(Or,{className:"mr-2 h-4 w-4"}),"Profil"]}),K.jsxs(Sh,{children:[K.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Notifications"]}),K.jsx(Th,{}),K.jsxs(Sh,{onClick:()=>{t()},className:"text-destructive",children:[K.jsx(ar,{className:"mr-2 h-4 w-4"}),"Se dconnecter"]})]})]})]})]})}),K.jsx("main",{className:"flex-1 p-4 md:p-6 space-y-6",children:e})]})]})})}Th.displayName=Oe.displayName;const Mh=()=>{const e=jo();return Ke.useEffect(()=>{e("/login")},[e]),K.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:K.jsxs("div",{className:"text-center",children:[K.jsx("h1",{className:"text-4xl font-bold mb-4",children:"GesFlex Pro"}),K.jsx("p",{className:"text-xl text-muted-foreground",children:"Chargement..."})]})})};var Ph=Ke.forwardRef((e,t)=>K.jsx(J.label,{...e,ref:t,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null==(s=e.onMouseDown)||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Ph.displayName="Label";var Ah=Ph;const Dh=_s("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Oh=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Ah,{ref:s,className:Aa(Dh(),e),...t}));Oh.displayName=Ah.displayName;const Rh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,className:Aa("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Rh.displayName="Card";const Ih=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,className:Aa("flex flex-col space-y-1.5 p-6",e),...t}));Ih.displayName="CardHeader";const Lh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("h3",{ref:s,className:Aa("text-2xl font-semibold leading-none tracking-tight",e),...t}));Lh.displayName="CardTitle";const qh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("p",{ref:s,className:Aa("text-sm text-muted-foreground",e),...t}));qh.displayName="CardDescription";const Fh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,className:Aa("p-6 pt-0",e),...t}));Fh.displayName="CardContent";Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,className:Aa("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter";const zh=_s("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),$h=Ke.forwardRef(({className:e,variant:t,...s},r)=>K.jsx("div",{ref:r,role:"alert",className:Aa(zh({variant:t}),e),...s}));$h.displayName="Alert";Ke.forwardRef(({className:e,...t},s)=>K.jsx("h5",{ref:s,className:Aa("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";const Wh=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{ref:s,className:Aa("text-sm [&_p]:leading-relaxed",e),...t}));function Uh(){const[e,t]=Ke.useState(!1),[s,r]=Ke.useState(!0),[a,n]=Ke.useState(!1),[i,o]=Ke.useState(""),[l,c]=Ke.useState(""),{signIn:d,signUp:u}=Uu();return K.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-accent/5 p-4",children:K.jsxs(Rh,{className:"w-full max-w-md bg-gradient-card shadow-elevated",children:[K.jsxs(Ih,{className:"space-y-4 text-center",children:[K.jsx("div",{className:"w-16 h-16 bg-gradient-primary rounded-2xl flex items-center justify-center mx-auto",children:K.jsx(gr,{className:"w-8 h-8 text-white"})}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Lh,{className:"text-2xl font-bold",children:s?"GesFlex":"Inscription"}),K.jsx(qh,{children:s?"Connectez-vous  votre compte":"Crez votre compte GesFlex"})]})]}),K.jsxs(Fh,{children:[i&&K.jsxs($h,{variant:"destructive",className:"mb-4",children:[K.jsx(Cs,{className:"h-4 w-4"}),K.jsx(Wh,{children:i})]}),l&&K.jsx($h,{className:"mb-4 border-success text-success",children:K.jsx(Wh,{children:l})}),K.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0),o(""),c("");const t=new FormData(e.target),a=t.get("email"),i=t.get("password"),l=t.get("firstName"),h=t.get("lastName");try{s?await d(a,i):(await u(a,i,l,h),c("Compte cr avec succs ! Vous pouvez maintenant vous connecter."),r(!0))}catch(m){o(m.message||"Une erreur est survenue")}finally{n(!1)}},className:"space-y-4",children:[!s&&K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"firstName",children:"Prnom"}),K.jsx(Yu,{id:"firstName",name:"firstName",placeholder:"Votre prnom",required:!0,className:"h-12"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"lastName",children:"Nom"}),K.jsx(Yu,{id:"lastName",name:"lastName",placeholder:"Votre nom",required:!0,className:"h-12"})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"email",children:"Email"}),K.jsx(Yu,{id:"email",name:"email",type:"email",placeholder:"votre.email@exemple.com",required:!0,className:"h-12"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"password",children:"Mot de passe"}),K.jsxs("div",{className:"relative",children:[K.jsx(Yu,{id:"password",name:"password",type:e?"text":"password",placeholder:"Votre mot de passe",required:!0,className:"h-12 pr-12"}),K.jsx(Hu,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8",onClick:()=>t(!e),children:e?K.jsx(Qs,{className:"h-4 w-4"}):K.jsx(Xs,{className:"h-4 w-4"})})]})]}),K.jsx(Hu,{type:"submit",className:"w-full",size:"lg",disabled:a,children:a?"Chargement...":s?"Se connecter":"S'inscrire"})]}),K.jsx("div",{className:"mt-6 text-center",children:K.jsxs("p",{className:"text-sm text-muted-foreground",children:[s?"Pas encore de compte ?":"Dj un compte ?"," ",K.jsx(Hu,{variant:"link",className:"p-0 h-auto text-primary",onClick:()=>{r(!s),o(""),c("")},children:s?"S'inscrire":"Se connecter"})]})})]})]})})}function Vh(){return K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{children:[K.jsx("h1",{className:"text-3xl font-bold",children:"Administration"}),K.jsx("p",{className:"text-muted-foreground",children:"Panneau d'administration pour la gestion du systme GesFlex Pro"})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Ls,{className:"w-5 h-5 text-success"}),"Statut du Systme"]}),K.jsx(qh,{children:"Vue d'ensemble de l'tat du systme"})]}),K.jsx(Fh,{children:K.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[K.jsxs("div",{className:"text-center",children:[K.jsx("div",{className:"text-2xl font-bold text-success",children:"7"}),K.jsx("div",{className:"text-sm text-muted-foreground",children:"Modules Actifs"})]}),K.jsxs("div",{className:"text-center",children:[K.jsx("div",{className:"text-2xl font-bold text-primary",children:"100%"}),K.jsx("div",{className:"text-sm text-muted-foreground",children:"Disponibilit"})]}),K.jsxs("div",{className:"text-center",children:[K.jsx("div",{className:"text-2xl font-bold text-warning",children:"0"}),K.jsx("div",{className:"text-sm text-muted-foreground",children:"Alertes"})]}),K.jsxs("div",{className:"text-center",children:[K.jsx("div",{className:"text-2xl font-bold text-accent",children:"OK"}),K.jsx("div",{className:"text-sm text-muted-foreground",children:"Statut"})]})]})})]}),K.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsx(Ih,{children:K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:K.jsx(Rr,{className:"w-5 h-5 text-primary"})}),K.jsxs("div",{children:[K.jsx(Lh,{className:"text-lg",children:"Gestion des Utilisateurs"}),K.jsx(qh,{children:"Grer les comptes et permissions"})]})]})})}),K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsx(Ih,{children:K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:K.jsx(Sr,{className:"w-5 h-5 text-primary"})}),K.jsxs("div",{children:[K.jsx(Lh,{className:"text-lg",children:"Gestion des Magasins"}),K.jsx(qh,{children:"Configurer les points de vente"})]})]})})}),K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsx(Ih,{children:K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:K.jsx(As,{className:"w-5 h-5 text-primary"})}),K.jsxs("div",{children:[K.jsx(Lh,{className:"text-lg",children:"Rapports & Analytics"}),K.jsx(qh,{children:"Analyser les performances"})]})]})})}),K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsx(Ih,{children:K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:K.jsx(wr,{className:"w-5 h-5 text-primary"})}),K.jsxs("div",{children:[K.jsx(Lh,{className:"text-lg",children:"Configuration"}),K.jsx(qh,{children:"Paramtres systme"})]})]})})})]})]})}function Bh(){const[e,t]=Ke.useState({dailySales:{amount:0,count:0,percentageChange:0},totalSales:{amount:0,count:0,productsSold:0},totalProducts:{count:0,lowStockCount:0},lowStockProducts:{count:0,items:[]},recentSales:[],loading:!0,error:null}),{userProfile:s}=Uu();Ke.useEffect(()=>{s&&r()},[s]);const r=async()=>{var e,r;try{if(t(e=>({...e,loading:!0,error:null})),!(null==s?void 0:s.id))return void t(e=>({...e,loading:!1}));const{data:d,error:u}=await Fu.from("user_stores").select("store_id").eq("user_id",s.id);if(u)throw new Error(`Erreur lors de la rcupration des magasins: ${u.message}`);const h=(null==d?void 0:d.map(e=>e.store_id))||[],[m,p,f,x,g,v]=await Promise.all([a(s.id),n(s.id),i(s.id,h),o(h),l(h),c(s.id)]),y=m.data||[],j=p.data||[],b=f.data||[],w=y.reduce((e,t)=>e+(t.total_amount||0),0),N=y.length,_=j.reduce((e,t)=>e+(t.total_amount||0),0),k=_>0?(w-_)/_*100:0,S=b.reduce((e,t)=>{var s;return e+((null==(s=t.sale_items)?void 0:s.reduce((e,t)=>e+(t.quantity||0),0))||0)},0),C=b.reduce((e,t)=>e+(t.total_amount||0),0),T=b.length;t({dailySales:{amount:w,count:N,percentageChange:k},totalSales:{amount:C,count:T,productsSold:S},totalProducts:{count:x.data||0,lowStockCount:(null==(e=g.data)?void 0:e.length)||0},lowStockProducts:{count:(null==(r=g.data)?void 0:r.length)||0,items:g.data||[]},recentSales:v.data||[],loading:!1,error:null})}catch(d){t(e=>({...e,loading:!1,error:d instanceof Error?d.message:"Erreur inconnue"}))}},a=async e=>{const t=new Date;t.setHours(0,0,0,0);const s=new Date(t);return s.setDate(s.getDate()+1),await Fu.from("sales").select("total_amount, created_at").eq("sold_by",e).gte("created_at",t.toISOString()).lt("created_at",s.toISOString())},n=async e=>{const t=new Date;t.setHours(0,0,0,0);const s=new Date(t);return s.setDate(s.getDate()-1),await Fu.from("sales").select("total_amount").eq("sold_by",e).gte("created_at",s.toISOString()).lt("created_at",t.toISOString())},i=async(e,t)=>{const s=new Date,r=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s);a.setDate(a.getDate()+1);let n=Fu.from("sales").select("\n        total_amount,\n        sale_items (quantity)\n      ").eq("sold_by",e).gte("created_at",r.toISOString()).lt("created_at",a.toISOString());return t.length>0&&(n=n.in("store_id",t)),await n},o=async e=>{if(0===e.length)return{data:0};const{data:t,error:s}=await Fu.from("product_stores").select("product_id").in("store_id",e);if(s)throw s;return{data:[...new Set((null==t?void 0:t.map(e=>e.product_id))||[])].length}},l=async e=>{if(0===e.length)return{data:[]};const{data:t,error:s}=await Fu.from("product_stores").select("\n        id,\n        current_stock,\n        min_stock,\n        products (id, name, sku, alert_stock),\n        stores (name)\n      ").in("store_id",e);if(s)throw s;return{data:(null==t?void 0:t.filter(e=>{const t=Array.isArray(e.products)?e.products[0]:e.products,s=(null==t?void 0:t.alert_stock)||e.min_stock||10;return e.current_stock<=s}).map(e=>{const t=Array.isArray(e.products)?e.products[0]:e.products,s=Array.isArray(e.stores)?e.stores[0]:e.stores;return{id:e.id,name:(null==t?void 0:t.name)||"Produit inconnu",sku:(null==t?void 0:t.sku)||"SKU inconnu",current_stock:e.current_stock,alert_stock:(null==t?void 0:t.alert_stock)||e.min_stock||10,store_name:(null==s?void 0:s.name)||"Magasin inconnu"}}))||[]}},c=async e=>await Fu.from("sales").select("\n        id,\n        sale_code,\n        total_amount,\n        customer_name,\n        created_at,\n        stores (name)\n      ").eq("sold_by",e).order("created_at",{ascending:!1}).limit(5);return e}function Hh(){const[e,t]=Ke.useState({code:"XOF",symbol:"CFA",position:"after",decimal_places:0,thousands_separator:" ",decimal_separator:","}),[s,r]=Ke.useState(!0),a=async()=>{try{r(!0);const{data:e,error:s}=await Fu.from("system_settings").select("setting_key, setting_value, setting_type").in("setting_key",["currency.default","currency.symbol","currency.position","currency.decimal_places","currency.thousands_separator","currency.decimal_separator"]);if(s)t({code:"XOF",symbol:"CFA",position:"after",decimal_places:0,thousands_separator:" ",decimal_separator:","});else if(e&&e.length>0){const s={code:"XOF",symbol:"CFA",position:"after",decimal_places:0,thousands_separator:" ",decimal_separator:","};e.forEach(e=>{let t=e.setting_value;if("number"===e.setting_type)t=parseInt(t)||0;else if("boolean"===e.setting_type)t="true"===t||!0===t;else if("json"===e.setting_type)try{t=JSON.parse(t)}catch{t=e.setting_value}switch(e.setting_key){case"currency.default":t&&(s.code=String(t));break;case"currency.symbol":t&&(s.symbol=String(t));break;case"currency.position":!t||"before"!==t&&"after"!==t||(s.position=t);break;case"currency.decimal_places":null!=t&&(s.decimal_places=parseInt(String(t))||0);break;case"currency.thousands_separator":t&&(s.thousands_separator=String(t));break;case"currency.decimal_separator":t&&(s.decimal_separator=String(t))}}),t(s)}else t({code:"XOF",symbol:"CFA",position:"after",decimal_places:0,thousands_separator:" ",decimal_separator:","})}catch(e){t({code:"XOF",symbol:"CFA",position:"after",decimal_places:0,thousands_separator:" ",decimal_separator:","})}finally{r(!1)}};return Ke.useEffect(()=>{a()},[]),{currency:e,loading:s,formatAmount:t=>{if(null==t)return"0";const s=t.toFixed(e.decimal_places).replace(".",e.decimal_separator).replace(/\B(?=(\d{3})+(?!\d))/g,e.thousands_separator);return"before"===e.position?`${e.symbol} ${s}`:`${s} ${e.symbol}`},formatPercentage:e=>`${e>=0?"+":""}${e.toFixed(1)}%`,refreshCurrency:a}}function Yh({title:e,value:t,description:s,trend:r,icon:a,variant:n="default",loading:i=!1}){const o=()=>"default"===n?"text-foreground":"text-white";return K.jsxs(Rh,{className:`${(()=>{switch(n){case"success":return"bg-gradient-success text-white border-0";case"warning":return"bg-gradient-to-br from-orange-500 to-orange-600 text-white border-0";case"info":return"bg-gradient-primary text-white border-0";default:return"bg-gradient-card border shadow-card hover:shadow-elevated transition-all duration-200"}})()} transform hover:scale-[1.02] transition-all duration-200`,children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:`text-sm font-medium ${o()}`,children:e}),K.jsx(a,{className:"h-5 w-5 "+("default"===n?"text-muted-foreground":"text-white/80")})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:`text-2xl font-bold ${o()}`,children:i?K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-24 rounded"}):t}),s&&K.jsx("div",{className:"text-xs "+("default"===n?"text-muted-foreground":"text-white/80"),children:i?K.jsx("div",{className:"animate-pulse bg-gray-300 h-3 w-16 rounded"}):s}),r&&K.jsxs("div",{className:"flex items-center mt-1",children:[K.jsx(Er,{className:"h-3 w-3 mr-1 "+("default"===n?"text-green-600":"text-white/80")}),K.jsx("span",{className:"text-xs "+("default"===n?"text-green-600":"text-white/80"),children:i?K.jsx("div",{className:"animate-pulse bg-gray-300 h-3 w-12 rounded"}):r})]})]})]})}function Gh(){const{dailySales:e,totalSales:t,totalProducts:s,lowStockProducts:r,loading:a,error:n}=Bh(),{formatAmount:i,formatPercentage:o}=Hh(),{userProfile:l}=Uu(),c=(null==l?void 0:l.role)&&["Admin","SuperAdmin"].includes(l.role);if(n)return K.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[Array.from({length:4}).map((e,t)=>K.jsxs(Rh,{className:"bg-gradient-card border shadow-card",children:[K.jsx(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:K.jsx(Lh,{className:"text-sm font-medium text-foreground",children:"Chargement..."})}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-foreground",children:K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-24 rounded"})}),K.jsx("div",{className:"text-xs text-muted-foreground",children:K.jsx("div",{className:"animate-pulse bg-gray-300 h-3 w-16 rounded mt-2"})})]})]},t)),K.jsx("div",{className:"col-span-full text-center py-4",children:K.jsxs("p",{className:"text-destructive text-sm",children:["Erreur de chargement des statistiques: ",n]})})]});const d=[{title:"Ventes du jour",value:e.count.toString(),description:`${i(e.amount)} de chiffre d'affaires`,icon:Ks,variant:"info",trend:o(e.percentageChange),loading:a},{title:"Produits vendus",value:t.productsSold.toString(),description:c?`${i(t.amount)} de chiffre d'affaires total`:"Quantit de produits vendus ce mois",icon:Er,variant:"success",loading:a},{title:"Total produits",value:s.count.toString(),description:"Produits en stock",icon:dr,variant:"default",loading:a},{title:"Stock faible",value:r.count.toString(),description:"Produits ncessitant un rapprovisionnement",icon:Ts,variant:"warning",loading:a}];return K.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:d.map((e,t)=>K.jsx(Yh,{...e},t))})}Wh.displayName="AlertDescription";const Kh=_s("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",warning:"border-transparent bg-warning text-warning-foreground hover:bg-warning/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Jh({className:e,variant:t,...s}){return K.jsx("div",{className:Aa(Kh({variant:t}),e),...s})}function Qh(e){return(Qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xh(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Zh(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function em(e){Zh(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===Qh(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):new Date(NaN)}var tm={};function sm(){return tm}function rm(e){if(Zh(1,arguments),!function(e){return Zh(1,arguments),e instanceof Date||"object"===Qh(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!=typeof e)return!1;var t=em(e);return!isNaN(Number(t))}function am(e,t){return Zh(2,arguments),function(e,t){Zh(2,arguments);var s=em(e).getTime(),r=Xh(t);return new Date(s+r)}(e,-Xh(t))}function nm(e){Zh(1,arguments);var t=em(e),s=t.getUTCDay(),r=(s<1?7:0)+s-1;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function im(e){Zh(1,arguments);var t=em(e),s=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(s+1,0,4),r.setUTCHours(0,0,0,0);var a=nm(r),n=new Date(0);n.setUTCFullYear(s,0,4),n.setUTCHours(0,0,0,0);var i=nm(n);return t.getTime()>=a.getTime()?s+1:t.getTime()>=i.getTime()?s:s-1}function om(e){Zh(1,arguments);var t=em(e),s=nm(t).getTime()-function(e){Zh(1,arguments);var t=im(e),s=new Date(0);return s.setUTCFullYear(t,0,4),s.setUTCHours(0,0,0,0),nm(s)}(t).getTime();return Math.round(s/6048e5)+1}function lm(e,t){var s,r,a,n,i,o,l,c;Zh(1,arguments);var d=sm(),u=Xh(null!==(s=null!==(r=null!==(a=null!==(n=null==t?void 0:t.weekStartsOn)&&void 0!==n?n:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==a?a:d.weekStartsOn)&&void 0!==r?r:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==s?s:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=em(e),m=h.getUTCDay(),p=(m<u?7:0)+m-u;return h.setUTCDate(h.getUTCDate()-p),h.setUTCHours(0,0,0,0),h}function cm(e,t){var s,r,a,n,i,o,l,c;Zh(1,arguments);var d=em(e),u=d.getUTCFullYear(),h=sm(),m=Xh(null!==(s=null!==(r=null!==(a=null!==(n=null==t?void 0:t.firstWeekContainsDate)&&void 0!==n?n:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==a?a:h.firstWeekContainsDate)&&void 0!==r?r:null===(l=h.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==s?s:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(u+1,0,m),p.setUTCHours(0,0,0,0);var f=lm(p,t),x=new Date(0);x.setUTCFullYear(u,0,m),x.setUTCHours(0,0,0,0);var g=lm(x,t);return d.getTime()>=f.getTime()?u+1:d.getTime()>=g.getTime()?u:u-1}function dm(e,t){Zh(1,arguments);var s=em(e),r=lm(s,t).getTime()-function(e,t){var s,r,a,n,i,o,l,c;Zh(1,arguments);var d=sm(),u=Xh(null!==(s=null!==(r=null!==(a=null!==(n=null==t?void 0:t.firstWeekContainsDate)&&void 0!==n?n:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==a?a:d.firstWeekContainsDate)&&void 0!==r?r:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==s?s:1),h=cm(e,t),m=new Date(0);return m.setUTCFullYear(h,0,u),m.setUTCHours(0,0,0,0),lm(m,t)}(s,t).getTime();return Math.round(r/6048e5)+1}function um(e,t){for(var s=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return s+r}var hm=function(e,t){var s=e.getUTCFullYear(),r=s>0?s:1-s;return um("yy"===t?r%100:r,t.length)},mm=function(e,t){var s=e.getUTCMonth();return"M"===t?String(s+1):um(s+1,2)},pm=function(e,t){return um(e.getUTCDate(),t.length)},fm=function(e,t){return um(e.getUTCHours()%12||12,t.length)},xm=function(e,t){return um(e.getUTCHours(),t.length)},gm=function(e,t){return um(e.getUTCMinutes(),t.length)},vm=function(e,t){return um(e.getUTCSeconds(),t.length)},ym=function(e,t){var s=t.length,r=e.getUTCMilliseconds();return um(Math.floor(r*Math.pow(10,s-3)),t.length)},jm="midnight",bm="noon",wm="morning",Nm="afternoon",_m="evening",km="night",Sm={G:function(e,t,s){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return s.era(r,{width:"abbreviated"});case"GGGGG":return s.era(r,{width:"narrow"});default:return s.era(r,{width:"wide"})}},y:function(e,t,s){if("yo"===t){var r=e.getUTCFullYear(),a=r>0?r:1-r;return s.ordinalNumber(a,{unit:"year"})}return hm(e,t)},Y:function(e,t,s,r){var a=cm(e,r),n=a>0?a:1-a;return"YY"===t?um(n%100,2):"Yo"===t?s.ordinalNumber(n,{unit:"year"}):um(n,t.length)},R:function(e,t){return um(im(e),t.length)},u:function(e,t){return um(e.getUTCFullYear(),t.length)},Q:function(e,t,s){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return um(r,2);case"Qo":return s.ordinalNumber(r,{unit:"quarter"});case"QQQ":return s.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(r,{width:"narrow",context:"formatting"});default:return s.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,s){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return um(r,2);case"qo":return s.ordinalNumber(r,{unit:"quarter"});case"qqq":return s.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(r,{width:"narrow",context:"standalone"});default:return s.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,s){var r=e.getUTCMonth();switch(t){case"M":case"MM":return mm(e,t);case"Mo":return s.ordinalNumber(r+1,{unit:"month"});case"MMM":return s.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(r,{width:"narrow",context:"formatting"});default:return s.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,s){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return um(r+1,2);case"Lo":return s.ordinalNumber(r+1,{unit:"month"});case"LLL":return s.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(r,{width:"narrow",context:"standalone"});default:return s.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,s,r){var a=dm(e,r);return"wo"===t?s.ordinalNumber(a,{unit:"week"}):um(a,t.length)},I:function(e,t,s){var r=om(e);return"Io"===t?s.ordinalNumber(r,{unit:"week"}):um(r,t.length)},d:function(e,t,s){return"do"===t?s.ordinalNumber(e.getUTCDate(),{unit:"date"}):pm(e,t)},D:function(e,t,s){var r=function(e){Zh(1,arguments);var t=em(e),s=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=s-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?s.ordinalNumber(r,{unit:"dayOfYear"}):um(r,t.length)},E:function(e,t,s){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return s.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(r,{width:"short",context:"formatting"});default:return s.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,s,r){var a=e.getUTCDay(),n=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(n);case"ee":return um(n,2);case"eo":return s.ordinalNumber(n,{unit:"day"});case"eee":return s.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(a,{width:"short",context:"formatting"});default:return s.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,s,r){var a=e.getUTCDay(),n=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(n);case"cc":return um(n,t.length);case"co":return s.ordinalNumber(n,{unit:"day"});case"ccc":return s.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(a,{width:"narrow",context:"standalone"});case"cccccc":return s.day(a,{width:"short",context:"standalone"});default:return s.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,s){var r=e.getUTCDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return um(a,t.length);case"io":return s.ordinalNumber(a,{unit:"day"});case"iii":return s.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(r,{width:"short",context:"formatting"});default:return s.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,s){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(r,{width:"narrow",context:"formatting"});default:return s.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,s){var r,a=e.getUTCHours();switch(r=12===a?bm:0===a?jm:a/12>=1?"pm":"am",t){case"b":case"bb":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(r,{width:"narrow",context:"formatting"});default:return s.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,s){var r,a=e.getUTCHours();switch(r=a>=17?_m:a>=12?Nm:a>=4?wm:km,t){case"B":case"BB":case"BBB":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(r,{width:"narrow",context:"formatting"});default:return s.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,s){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),s.ordinalNumber(r,{unit:"hour"})}return fm(e,t)},H:function(e,t,s){return"Ho"===t?s.ordinalNumber(e.getUTCHours(),{unit:"hour"}):xm(e,t)},K:function(e,t,s){var r=e.getUTCHours()%12;return"Ko"===t?s.ordinalNumber(r,{unit:"hour"}):um(r,t.length)},k:function(e,t,s){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?s.ordinalNumber(r,{unit:"hour"}):um(r,t.length)},m:function(e,t,s){return"mo"===t?s.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):gm(e,t)},s:function(e,t,s){return"so"===t?s.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):vm(e,t)},S:function(e,t){return ym(e,t)},X:function(e,t,s,r){var a=(r._originalDate||e).getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return Tm(a);case"XXXX":case"XX":return Em(a);default:return Em(a,":")}},x:function(e,t,s,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return Tm(a);case"xxxx":case"xx":return Em(a);default:return Em(a,":")}},O:function(e,t,s,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Cm(a,":");default:return"GMT"+Em(a,":")}},z:function(e,t,s,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Cm(a,":");default:return"GMT"+Em(a,":")}},t:function(e,t,s,r){var a=r._originalDate||e;return um(Math.floor(a.getTime()/1e3),t.length)},T:function(e,t,s,r){return um((r._originalDate||e).getTime(),t.length)}};function Cm(e,t){var s=e>0?"-":"+",r=Math.abs(e),a=Math.floor(r/60),n=r%60;if(0===n)return s+String(a);var i=t;return s+String(a)+i+um(n,2)}function Tm(e,t){return e%60==0?(e>0?"-":"+")+um(Math.abs(e)/60,2):Em(e,t)}function Em(e,t){var s=t||"",r=e>0?"-":"+",a=Math.abs(e);return r+um(Math.floor(a/60),2)+s+um(a%60,2)}var Mm=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Pm=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Am={p:Pm,P:function(e,t){var s,r=e.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return Mm(e,t);switch(a){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",Mm(a,t)).replace("{{time}}",Pm(n,t))}},Dm=["D","DD"],Om=["YY","YYYY"];function Rm(e,t,s){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Im={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Lm(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.width?String(t.width):e.defaultWidth;return e.formats[s]||e.formats[e.defaultWidth]}}var qm={date:Lm({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Lm({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Lm({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Fm={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function zm(e){return function(t,s){var r;if("formatting"===(null!=s&&s.context?String(s.context):"standalone")&&e.formattingValues){var a=e.defaultFormattingWidth||e.defaultWidth,n=null!=s&&s.width?String(s.width):a;r=e.formattingValues[n]||e.formattingValues[a]}else{var i=e.defaultWidth,o=null!=s&&s.width?String(s.width):e.defaultWidth;r=e.values[o]||e.values[i]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function $m(e){return function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],n=t.match(a);if(!n)return null;var i,o=n[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?function(e,t){for(var s=0;s<e.length;s++)if(t(e[s]))return s;return}(l,function(e){return e.test(o)}):function(e,t){for(var s in e)if(e.hasOwnProperty(s)&&t(e[s]))return s;return}(l,function(e){return e.test(o)});return i=e.valueCallback?e.valueCallback(c):c,{value:i=s.valueCallback?s.valueCallback(i):i,rest:t.slice(o.length)}}}function Wm(e){return function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var a=r[0],n=t.match(e.parsePattern);if(!n)return null;var i=e.valueCallback?e.valueCallback(n[0]):n[0];return{value:i=s.valueCallback?s.valueCallback(i):i,rest:t.slice(a.length)}}}var Um={code:"en-US",formatDistance:function(e,t,s){var r,a=Im[e];return r="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),null!=s&&s.addSuffix?s.comparison&&s.comparison>0?"in "+r:r+" ago":r},formatLong:qm,formatRelative:function(e,t,s,r){return Fm[e]},localize:{ordinalNumber:function(e,t){var s=Number(e),r=s%100;if(r>20||r<10)switch(r%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},era:zm({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:zm({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:zm({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:zm({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:zm({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:Wm({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:$m({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:$m({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:$m({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:$m({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:$m({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},Vm=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Bm=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Hm=/^'([^]*?)'?$/,Ym=/''/g,Gm=/[a-zA-Z]/;function Km(e,t,s){var r,a,n,i,o,l,c,d,u,h,m,p,f,x,g,v,y,j;Zh(2,arguments);var b=String(t),w=sm(),N=null!==(r=null!==(a=null==s?void 0:s.locale)&&void 0!==a?a:w.locale)&&void 0!==r?r:Um,_=Xh(null!==(n=null!==(i=null!==(o=null!==(l=null==s?void 0:s.firstWeekContainsDate)&&void 0!==l?l:null==s||null===(c=s.locale)||void 0===c||null===(d=c.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==o?o:w.firstWeekContainsDate)&&void 0!==i?i:null===(u=w.locale)||void 0===u||null===(h=u.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==n?n:1);if(!(_>=1&&_<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=Xh(null!==(m=null!==(p=null!==(f=null!==(x=null==s?void 0:s.weekStartsOn)&&void 0!==x?x:null==s||null===(g=s.locale)||void 0===g||null===(v=g.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==f?f:w.weekStartsOn)&&void 0!==p?p:null===(y=w.locale)||void 0===y||null===(j=y.options)||void 0===j?void 0:j.weekStartsOn)&&void 0!==m?m:0);if(!(k>=0&&k<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!N.localize)throw new RangeError("locale must contain localize property");if(!N.formatLong)throw new RangeError("locale must contain formatLong property");var S=em(e);if(!rm(S))throw new RangeError("Invalid time value");var C=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}(S),T=am(S,C),E={firstWeekContainsDate:_,weekStartsOn:k,locale:N,_originalDate:S};return b.match(Bm).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,Am[t])(e,N.formatLong):e}).join("").match(Vm).map(function(r){if("''"===r)return"'";var a=r[0];if("'"===a)return function(e){var t=e.match(Hm);if(!t)return e;return t[1].replace(Ym,"'")}(r);var n,i=Sm[a];if(i)return null!=s&&s.useAdditionalWeekYearTokens||(n=r,-1===Om.indexOf(n))||Rm(r,t,String(e)),null!=s&&s.useAdditionalDayOfYearTokens||!function(e){return-1!==Dm.indexOf(e)}(r)||Rm(r,t,String(e)),i(T,r,N.localize,E);if(a.match(Gm))throw new RangeError("Format string contains an unescaped latin alphabet character `"+a+"`");return r}).join("")}var Jm={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},Qm={date:Lm({formats:{full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},defaultWidth:"full"}),time:Lm({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:Lm({formats:{full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Xm={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},Zm={ordinalNumber:function(e,t){var s=Number(e),r=null==t?void 0:t.unit;if(0===s)return"0";return s+(1===s?r&&["year","week","hour","minute","second"].includes(r)?"re":"er":"me")},era:zm({values:{narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},defaultWidth:"wide"}),quarter:zm({values:{narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:zm({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},defaultWidth:"wide"}),day:zm({values:{narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},defaultWidth:"wide"}),dayPeriod:zm({values:{narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},defaultWidth:"wide"})},ep={code:"fr",formatDistance:function(e,t,s){var r,a=Jm[e];return r="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",String(t)),null!=s&&s.addSuffix?s.comparison&&s.comparison>0?"dans "+r:"il y a "+r:r},formatLong:Qm,formatRelative:function(e,t,s,r){return Xm[e]},localize:Zm,match:{ordinalNumber:Wm({matchPattern:/^(\d+)(ime|re|me|er|e)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e)}}),era:$m({matchPatterns:{narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^av/i,/^ap/i]},defaultParseWidth:"any"}),quarter:$m({matchPatterns:{narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:$m({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:$m({matchPatterns:{narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:$m({matchPatterns:{narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:4}};function tp(){const{userProfile:e}=Uu(),{recentSales:t,lowStockProducts:s,loading:r,error:a}=Bh(),{formatAmount:n}=Hh(),i=jo(),o=()=>{(null==e?void 0:e.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(e.role)&&i("/sales")};return a?K.jsxs("div",{className:"space-y-6",children:[K.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:["Bonjour ",(null==e?void 0:e.first_name)||"Utilisateur"," ! ",""]}),K.jsx("p",{className:"text-muted-foreground",children:"Aperu de votre activit aujourd'hui"})]})}),K.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Erreur de chargement"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:"Impossible de charger les donnes du tableau de bord"}),K.jsxs(Hu,{variant:"outline",onClick:()=>window.location.reload(),className:"gap-2",children:[K.jsx(vr,{className:"w-4 h-4"}),"Ressayer"]})]})]}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:["Bonjour ",(null==e?void 0:e.first_name)||"Utilisateur"," ! ",""]}),K.jsx("p",{className:"text-muted-foreground",children:"Aperu de votre activit aujourd'hui"})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[(null==e?void 0:e.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(e.role)&&K.jsxs(Hu,{variant:"success",size:"touch",className:"gap-2",onClick:()=>{(null==e?void 0:e.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(e.role)&&i("/sales")},children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouvelle vente"]}),(null==e?void 0:e.role)&&["Admin","SuperAdmin","Manager"].includes(e.role)&&K.jsxs(Hu,{variant:"default",size:"touch",className:"gap-2",onClick:()=>{(null==e?void 0:e.role)&&["Admin","SuperAdmin","Manager"].includes(e.role)&&i("/products")},children:[K.jsx(dr,{className:"w-4 h-4"}),"Ajouter produit"]}),(null==e?void 0:e.role)&&["Admin","SuperAdmin","Manager"].includes(e.role)&&K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",onClick:()=>{(null==e?void 0:e.role)&&["Admin","SuperAdmin","Manager"].includes(e.role)&&i("/inventory")},children:[K.jsx(Er,{className:"w-4 h-4"}),"Inventaire"]})]})]}),K.jsx(Gh,{}),r?K.jsxs("div",{className:"space-y-6",children:[K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsxs(Ih,{className:"text-center",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-16 w-16 rounded-full mx-auto mb-4"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-6 w-48 rounded mx-auto mb-2"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-64 rounded mx-auto"})]})}),K.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:Array.from({length:2}).map((e,t)=>K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-6 w-32 rounded mb-2"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-48 rounded"})]}),K.jsx(Fh,{children:K.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((e,t)=>K.jsx("div",{className:"animate-pulse bg-gray-300 h-16 w-full rounded"},t))})})]},t))})]}):K.jsxs(K.Fragment,{children:[K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsxs(Ih,{className:"text-center",children:[K.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 "+(0===s.count?"bg-success/10":"bg-warning/10"),children:0===s.count?K.jsx(Ls,{className:"w-8 h-8 text-success"}):K.jsx(Ts,{className:"w-8 h-8 text-warning"})}),K.jsx(Lh,{className:"text-xl",children:0===s.count?"Stock optimal":"Attention au stock"}),K.jsx(qh,{children:0===s.count?"Stock suffisant pour tous les produits":`${s.count} produit${s.count>1?"s":""} en alerte`})]})}),K.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(_r,{className:"w-5 h-5 text-primary"}),"Ventes rcentes"]}),K.jsx(qh,{children:"Dernires transactions effectues"})]}),K.jsx(Fh,{children:0===t.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[K.jsx(_r,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground",children:"Aucune vente rcente"}),(null==e?void 0:e.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(e.role)&&K.jsx(Hu,{variant:"outline",className:"mt-4",onClick:o,children:"Voir toutes les ventes"})]}):K.jsxs("div",{className:"space-y-4",children:[K.jsx("div",{className:"space-y-3",children:t.slice(0,3).map(e=>K.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[K.jsxs("div",{className:"flex-1",children:[K.jsx("div",{className:"font-medium text-sm",children:e.customer_name||"Client anonyme"}),K.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.sale_code,"  ",Km(new Date(e.created_at),"dd/MM/yyyy HH:mm",{locale:ep})]})]}),K.jsxs("div",{className:"text-right",children:[K.jsx("div",{className:"font-semibold text-sm",children:n(e.total_amount)}),K.jsx("div",{className:"text-xs text-muted-foreground",children:e.store_name})]})]},e.id))}),(null==e?void 0:e.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(e.role)&&K.jsx(Hu,{variant:"outline",className:"w-full",onClick:o,children:"Voir toutes les ventes"})]})})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Ts,{className:"w-5 h-5 text-warning"}),"Alertes de stock"]}),K.jsx(qh,{children:"Produits ncessitant un rapprovisionnement"})]}),K.jsx(Fh,{children:0===s.count?K.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[K.jsx(Ls,{className:"w-16 h-16 text-success/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground",children:"Tous les produits ont un stock suffisant"})]}):K.jsx("div",{className:"space-y-4",children:K.jsx("div",{className:"space-y-3",children:s.items.slice(0,3).map(e=>K.jsxs("div",{className:"flex items-center justify-between p-3 bg-warning/10 rounded-lg border border-warning/20",children:[K.jsxs("div",{className:"flex-1",children:[K.jsx("div",{className:"font-medium text-sm",children:e.name}),K.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.sku,"  ",e.store_name]})]}),K.jsx("div",{className:"text-right",children:K.jsxs(Jh,{variant:"destructive",className:"text-xs",children:[e.current_stock," / ",e.alert_stock]})})]},e.id))})})})]})]})]})]})}const sp=Ke.forwardRef(({className:e,...t},s)=>K.jsx("div",{className:"relative w-full overflow-auto",children:K.jsx("table",{ref:s,className:Aa("w-full caption-bottom text-sm",e),...t})}));sp.displayName="Table";const rp=Ke.forwardRef(({className:e,...t},s)=>K.jsx("thead",{ref:s,className:Aa("[&_tr]:border-b",e),...t}));rp.displayName="TableHeader";const ap=Ke.forwardRef(({className:e,...t},s)=>K.jsx("tbody",{ref:s,className:Aa("[&_tr:last-child]:border-0",e),...t}));ap.displayName="TableBody";Ke.forwardRef(({className:e,...t},s)=>K.jsx("tfoot",{ref:s,className:Aa("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";const np=Ke.forwardRef(({className:e,...t},s)=>K.jsx("tr",{ref:s,className:Aa("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));np.displayName="TableRow";const ip=Ke.forwardRef(({className:e,...t},s)=>K.jsx("th",{ref:s,className:Aa("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));ip.displayName="TableHead";const op=Ke.forwardRef(({className:e,...t},s)=>K.jsx("td",{ref:s,className:Aa("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));op.displayName="TableCell";Ke.forwardRef(({className:e,...t},s)=>K.jsx("caption",{ref:s,className:Aa("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption";const lp=_e,cp=Le,dp=ye,up=Ke.forwardRef(({className:e,...t},s)=>K.jsx(ve,{ref:s,className:Aa("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));up.displayName=ve.displayName;const hp=Ke.forwardRef(({className:e,children:t,...s},r)=>K.jsxs(dp,{children:[K.jsx(up,{}),K.jsxs(je,{ref:r,className:Aa("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[t,K.jsxs(be,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[K.jsx(qr,{className:"h-4 w-4"}),K.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));hp.displayName=je.displayName;const mp=({className:e,...t})=>K.jsx("div",{className:Aa("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});mp.displayName="DialogHeader";const pp=({className:e,...t})=>K.jsx("div",{className:Aa("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});pp.displayName="DialogFooter";const fp=Ke.forwardRef(({className:e,...t},s)=>K.jsx(we,{ref:s,className:Aa("text-lg font-semibold leading-none tracking-tight",e),...t}));fp.displayName=we.displayName;const xp=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Ne,{ref:s,className:Aa("text-sm text-muted-foreground",e),...t}));xp.displayName=Ne.displayName;const gp=Ke.forwardRef(({className:e,...t},s)=>K.jsx("textarea",{className:Aa("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));function vp(e,[t,s]){return Math.min(s,Math.max(t,e))}function yp(e){const t=Ke.useRef({value:e,previous:e});return Ke.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}gp.displayName="Textarea";var jp=[" ","Enter","ArrowUp","ArrowDown"],bp=[" ","Enter"],wp="Select",[Np,_p,kp]=X(wp),[Sp,Cp]=Q(wp,[kp,ce]),Tp=ce(),[Ep,Mp]=Sp(wp),[Pp,Ap]=Sp(wp),Dp=e=>{const{__scopeSelect:t,children:s,open:r,defaultOpen:a,onOpenChange:n,value:i,defaultValue:o,onValueChange:l,dir:c,name:d,autoComplete:u,disabled:h,required:m,form:p}=e,f=Tp(t),[x,g]=Ke.useState(null),[v,y]=Ke.useState(null),[j,b]=Ke.useState(!1),w=Ue(c),[N,_]=te({prop:r,defaultProp:a??!1,onChange:n,caller:wp}),[k,S]=te({prop:i,defaultProp:o,onChange:l,caller:wp}),C=Ke.useRef(null),T=!x||(p||!!x.closest("form")),[E,M]=Ke.useState(new Set),P=Array.from(E).map(e=>e.props.value).join(";");return K.jsx(pe,{...f,children:K.jsxs(Ep,{required:m,scope:t,trigger:x,onTriggerChange:g,valueNode:v,onValueNodeChange:y,valueNodeHasChildren:j,onValueNodeHasChildrenChange:b,contentId:me(),value:k,onValueChange:S,open:N,onOpenChange:_,dir:w,triggerPointerDownPosRef:C,disabled:h,children:[K.jsx(Np.Provider,{scope:t,children:K.jsx(Pp,{scope:e.__scopeSelect,onNativeOptionAdd:Ke.useCallback(e=>{M(t=>new Set(t).add(e))},[]),onNativeOptionRemove:Ke.useCallback(e=>{M(t=>{const s=new Set(t);return s.delete(e),s})},[]),children:s})}),T?K.jsxs(jf,{"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:u,value:k,onChange:e=>S(e.target.value),disabled:h,form:p,children:[void 0===k?K.jsx("option",{value:""}):null,Array.from(E)]},P):null]})})};Dp.displayName=wp;var Op="SelectTrigger",Rp=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,disabled:r=!1,...a}=e,n=Tp(s),i=Mp(Op,s),o=i.disabled||r,l=Z(t,i.onTriggerChange),c=_p(s),d=Ke.useRef("touch"),[u,h,m]=wf(e=>{const t=c().filter(e=>!e.disabled),s=t.find(e=>e.value===i.value),r=Nf(t,e,s);void 0!==r&&i.onValueChange(r.value)}),p=e=>{o||(i.onOpenChange(!0),m()),e&&(i.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return K.jsx(fe,{asChild:!0,...n,children:K.jsx(J.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":bf(i.value)?"":void 0,...a,ref:l,onClick:re(a.onClick,e=>{e.currentTarget.focus(),"mouse"!==d.current&&p(e)}),onPointerDown:re(a.onPointerDown,e=>{d.current=e.pointerType;const t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(p(e),e.preventDefault())}),onKeyDown:re(a.onKeyDown,e=>{const t=""!==u.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||h(e.key),t&&" "===e.key||jp.includes(e.key)&&(p(),e.preventDefault())})})})});Rp.displayName=Op;var Ip="SelectValue",Lp=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,className:r,style:a,children:n,placeholder:i="",...o}=e,l=Mp(Ip,s),{onValueNodeHasChildrenChange:c}=l,d=void 0!==n,u=Z(t,l.onValueNodeChange);return oe(()=>{c(d)},[c,d]),K.jsx(J.span,{...o,ref:u,style:{pointerEvents:"none"},children:bf(l.value)?K.jsx(K.Fragment,{children:i}):n})});Lp.displayName=Ip;var qp=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,children:r,...a}=e;return K.jsx(J.span,{"aria-hidden":!0,...a,ref:t,children:r||""})});qp.displayName="SelectIcon";var Fp=e=>K.jsx(ie,{asChild:!0,...e});Fp.displayName="SelectPortal";var zp="SelectContent",$p=Ke.forwardRef((e,t)=>{const s=Mp(zp,e.__scopeSelect),[r,a]=Ke.useState();if(oe(()=>{a(new DocumentFragment)},[]),!s.open){const t=r;return t?Ge.createPortal(K.jsx(Up,{scope:e.__scopeSelect,children:K.jsx(Np.Slot,{scope:e.__scopeSelect,children:K.jsx("div",{children:e.children})})}),t):null}return K.jsx(Hp,{...e,ref:t})});$p.displayName=zp;var Wp=10,[Up,Vp]=Sp(zp),Bp=$e("SelectContent.RemoveScroll"),Hp=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:n,onPointerDownOutside:i,side:o,sideOffset:l,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:h,collisionPadding:m,sticky:p,hideWhenDetached:f,avoidCollisions:x,...g}=e,v=Mp(zp,s),[y,j]=Ke.useState(null),[b,w]=Ke.useState(null),N=Z(t,e=>j(e)),[_,k]=Ke.useState(null),[S,C]=Ke.useState(null),T=_p(s),[E,M]=Ke.useState(!1),P=Ke.useRef(!1);Ke.useEffect(()=>{if(y)return qe(y)},[y]),Fe();const A=Ke.useCallback(e=>{const[t,...s]=T().map(e=>e.ref.current),[r]=s.slice(-1),a=document.activeElement;for(const n of e){if(n===a)return;if(null==n||n.scrollIntoView({block:"nearest"}),n===t&&b&&(b.scrollTop=0),n===r&&b&&(b.scrollTop=b.scrollHeight),null==n||n.focus(),document.activeElement!==a)return}},[T,b]),D=Ke.useCallback(()=>A([_,y]),[A,_,y]);Ke.useEffect(()=>{E&&D()},[E,D]);const{onOpenChange:O,triggerPointerDownPosRef:R}=v;Ke.useEffect(()=>{if(y){let e={x:0,y:0};const t=t=>{var s,r;e={x:Math.abs(Math.round(t.pageX)-((null==(s=R.current)?void 0:s.x)??0)),y:Math.abs(Math.round(t.pageY)-((null==(r=R.current)?void 0:r.y)??0))}},s=s=>{e.x<=10&&e.y<=10?s.preventDefault():y.contains(s.target)||O(!1),document.removeEventListener("pointermove",t),R.current=null};return null!==R.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",s,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",s,{capture:!0})}}},[y,O,R]),Ke.useEffect(()=>{const e=()=>O(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[O]);const[I,L]=wf(e=>{const t=T().filter(e=>!e.disabled),s=t.find(e=>e.ref.current===document.activeElement),r=Nf(t,e,s);r&&setTimeout(()=>r.ref.current.focus())}),q=Ke.useCallback((e,t,s)=>{const r=!P.current&&!s;(void 0!==v.value&&v.value===t||r)&&(k(e),r&&(P.current=!0))},[v.value]),F=Ke.useCallback(()=>null==y?void 0:y.focus(),[y]),z=Ke.useCallback((e,t,s)=>{const r=!P.current&&!s;(void 0!==v.value&&v.value===t||r)&&C(e)},[v.value]),$="popper"===r?Gp:Yp,W=$===Gp?{side:o,sideOffset:l,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:h,collisionPadding:m,sticky:p,hideWhenDetached:f,avoidCollisions:x}:{};return K.jsx(Up,{scope:s,content:y,viewport:b,onViewportChange:w,itemRefCallback:q,selectedItem:_,onItemLeave:F,itemTextRefCallback:z,focusSelectedItem:D,selectedItemText:S,position:r,isPositioned:E,searchRef:I,children:K.jsx(ze,{as:Bp,allowPinchZoom:!0,children:K.jsx(We,{asChild:!0,trapped:v.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:re(a,e=>{var t;null==(t=v.trigger)||t.focus({preventScroll:!0}),e.preventDefault()}),children:K.jsx(de,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:K.jsx($,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:e=>e.preventDefault(),...g,...W,onPlaced:()=>M(!0),ref:N,style:{display:"flex",flexDirection:"column",outline:"none",...g.style},onKeyDown:re(g.onKeyDown,e=>{const t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||L(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=T().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){const s=e.target,r=t.indexOf(s);t=t.slice(r+1)}setTimeout(()=>A(t)),e.preventDefault()}})})})})})})});Hp.displayName="SelectContentImpl";var Yp=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,onPlaced:r,...a}=e,n=Mp(zp,s),i=Vp(zp,s),[o,l]=Ke.useState(null),[c,d]=Ke.useState(null),u=Z(t,e=>d(e)),h=_p(s),m=Ke.useRef(!1),p=Ke.useRef(!0),{viewport:f,selectedItem:x,selectedItemText:g,focusSelectedItem:v}=i,y=Ke.useCallback(()=>{if(n.trigger&&n.valueNode&&o&&c&&f&&x&&g){const e=n.trigger.getBoundingClientRect(),t=c.getBoundingClientRect(),s=n.valueNode.getBoundingClientRect(),a=g.getBoundingClientRect();if("rtl"!==n.dir){const r=a.left-t.left,n=s.left-r,i=e.left-n,l=e.width+i,c=Math.max(l,t.width),d=window.innerWidth-Wp,u=vp(n,[Wp,Math.max(Wp,d-c)]);o.style.minWidth=l+"px",o.style.left=u+"px"}else{const r=t.right-a.right,n=window.innerWidth-s.right-r,i=window.innerWidth-e.right-n,l=e.width+i,c=Math.max(l,t.width),d=window.innerWidth-Wp,u=vp(n,[Wp,Math.max(Wp,d-c)]);o.style.minWidth=l+"px",o.style.right=u+"px"}const i=h(),l=window.innerHeight-2*Wp,d=f.scrollHeight,u=window.getComputedStyle(c),p=parseInt(u.borderTopWidth,10),v=parseInt(u.paddingTop,10),y=parseInt(u.borderBottomWidth,10),j=p+v+d+parseInt(u.paddingBottom,10)+y,b=Math.min(5*x.offsetHeight,j),w=window.getComputedStyle(f),N=parseInt(w.paddingTop,10),_=parseInt(w.paddingBottom,10),k=e.top+e.height/2-Wp,S=l-k,C=x.offsetHeight/2,T=p+v+(x.offsetTop+C),E=j-T;if(T<=k){const e=i.length>0&&x===i[i.length-1].ref.current;o.style.bottom="0px";const t=c.clientHeight-f.offsetTop-f.offsetHeight,s=T+Math.max(S,C+(e?_:0)+t+y);o.style.height=s+"px"}else{const e=i.length>0&&x===i[0].ref.current;o.style.top="0px";const t=Math.max(k,p+f.offsetTop+(e?N:0)+C)+E;o.style.height=t+"px",f.scrollTop=T-k+f.offsetTop}o.style.margin=`${Wp}px 0`,o.style.minHeight=b+"px",o.style.maxHeight=l+"px",null==r||r(),requestAnimationFrame(()=>m.current=!0)}},[h,n.trigger,n.valueNode,o,c,f,x,g,n.dir,r]);oe(()=>y(),[y]);const[j,b]=Ke.useState();oe(()=>{c&&b(window.getComputedStyle(c).zIndex)},[c]);const w=Ke.useCallback(e=>{e&&!0===p.current&&(y(),null==v||v(),p.current=!1)},[y,v]);return K.jsx(Kp,{scope:s,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:w,children:K.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:K.jsx(J.div,{...a,ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Yp.displayName="SelectItemAlignedPosition";var Gp=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,align:r="start",collisionPadding:a=Wp,...n}=e,i=Tp(s);return K.jsx(ue,{...i,...n,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Gp.displayName="SelectPopperPosition";var[Kp,Jp]=Sp(zp,{}),Qp="SelectViewport",Xp=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,nonce:r,...a}=e,n=Vp(Qp,s),i=Jp(Qp,s),o=Z(t,n.onViewportChange),l=Ke.useRef(0);return K.jsxs(K.Fragment,{children:[K.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),K.jsx(Np.Slot,{scope:s,children:K.jsx(J.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:re(a.onScroll,e=>{const t=e.currentTarget,{contentWrapper:s,shouldExpandOnScrollRef:r}=i;if((null==r?void 0:r.current)&&s){const e=Math.abs(l.current-t.scrollTop);if(e>0){const r=window.innerHeight-2*Wp,a=parseFloat(s.style.minHeight),n=parseFloat(s.style.height),i=Math.max(a,n);if(i<r){const a=i+e,n=Math.min(r,a),o=a-n;s.style.height=n+"px","0px"===s.style.bottom&&(t.scrollTop=o>0?o:0,s.style.justifyContent="flex-end")}}}l.current=t.scrollTop})})})]})});Xp.displayName=Qp;var Zp="SelectGroup",[ef,tf]=Sp(Zp);Ke.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e,a=me();return K.jsx(ef,{scope:s,id:a,children:K.jsx(J.div,{role:"group","aria-labelledby":a,...r,ref:t})})}).displayName=Zp;var sf="SelectLabel",rf=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e,a=tf(sf,s);return K.jsx(J.div,{id:a.id,...r,ref:t})});rf.displayName=sf;var af="SelectItem",[nf,of]=Sp(af),lf=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,value:r,disabled:a=!1,textValue:n,...i}=e,o=Mp(af,s),l=Vp(af,s),c=o.value===r,[d,u]=Ke.useState(n??""),[h,m]=Ke.useState(!1),p=Z(t,e=>{var t;return null==(t=l.itemRefCallback)?void 0:t.call(l,e,r,a)}),f=me(),x=Ke.useRef("touch"),g=()=>{a||(o.onValueChange(r),o.onOpenChange(!1))};if(""===r)throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return K.jsx(nf,{scope:s,value:r,disabled:a,textId:f,isSelected:c,onItemTextChange:Ke.useCallback(e=>{u(t=>t||((null==e?void 0:e.textContent)??"").trim())},[]),children:K.jsx(Np.ItemSlot,{scope:s,value:r,disabled:a,textValue:d,children:K.jsx(J.div,{role:"option","aria-labelledby":f,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:p,onFocus:re(i.onFocus,()=>m(!0)),onBlur:re(i.onBlur,()=>m(!1)),onClick:re(i.onClick,()=>{"mouse"!==x.current&&g()}),onPointerUp:re(i.onPointerUp,()=>{"mouse"===x.current&&g()}),onPointerDown:re(i.onPointerDown,e=>{x.current=e.pointerType}),onPointerMove:re(i.onPointerMove,e=>{var t;x.current=e.pointerType,a?null==(t=l.onItemLeave)||t.call(l):"mouse"===x.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:re(i.onPointerLeave,e=>{var t;e.currentTarget===document.activeElement&&(null==(t=l.onItemLeave)||t.call(l))}),onKeyDown:re(i.onKeyDown,e=>{var t;""!==(null==(t=l.searchRef)?void 0:t.current)&&" "===e.key||(bp.includes(e.key)&&g()," "===e.key&&e.preventDefault())})})})})});lf.displayName=af;var cf="SelectItemText",df=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,className:r,style:a,...n}=e,i=Mp(cf,s),o=Vp(cf,s),l=of(cf,s),c=Ap(cf,s),[d,u]=Ke.useState(null),h=Z(t,e=>u(e),l.onItemTextChange,e=>{var t;return null==(t=o.itemTextRefCallback)?void 0:t.call(o,e,l.value,l.disabled)}),m=null==d?void 0:d.textContent,p=Ke.useMemo(()=>K.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:f,onNativeOptionRemove:x}=c;return oe(()=>(f(p),()=>x(p)),[f,x,p]),K.jsxs(K.Fragment,{children:[K.jsx(J.span,{id:l.textId,...n,ref:h}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Ge.createPortal(n.children,i.valueNode):null]})});df.displayName=cf;var uf="SelectItemIndicator",hf=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e;return of(uf,s).isSelected?K.jsx(J.span,{"aria-hidden":!0,...r,ref:t}):null});hf.displayName=uf;var mf="SelectScrollUpButton",pf=Ke.forwardRef((e,t)=>{const s=Vp(mf,e.__scopeSelect),r=Jp(mf,e.__scopeSelect),[a,n]=Ke.useState(!1),i=Z(t,r.onScrollButtonChange);return oe(()=>{if(s.viewport&&s.isPositioned){let e=function(){const e=t.scrollTop>0;n(e)};const t=s.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[s.viewport,s.isPositioned]),a?K.jsx(gf,{...e,ref:i,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=s;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});pf.displayName=mf;var ff="SelectScrollDownButton",xf=Ke.forwardRef((e,t)=>{const s=Vp(ff,e.__scopeSelect),r=Jp(ff,e.__scopeSelect),[a,n]=Ke.useState(!1),i=Z(t,r.onScrollButtonChange);return oe(()=>{if(s.viewport&&s.isPositioned){let e=function(){const e=t.scrollHeight-t.clientHeight,s=Math.ceil(t.scrollTop)<e;n(s)};const t=s.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[s.viewport,s.isPositioned]),a?K.jsx(gf,{...e,ref:i,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=s;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});xf.displayName=ff;var gf=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,onAutoScroll:r,...a}=e,n=Vp("SelectScrollButton",s),i=Ke.useRef(null),o=_p(s),l=Ke.useCallback(()=>{null!==i.current&&(window.clearInterval(i.current),i.current=null)},[]);return Ke.useEffect(()=>()=>l(),[l]),oe(()=>{var e;const t=o().find(e=>e.ref.current===document.activeElement);null==(e=null==t?void 0:t.ref.current)||e.scrollIntoView({block:"nearest"})},[o]),K.jsx(J.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:re(a.onPointerDown,()=>{null===i.current&&(i.current=window.setInterval(r,50))}),onPointerMove:re(a.onPointerMove,()=>{var e;null==(e=n.onItemLeave)||e.call(n),null===i.current&&(i.current=window.setInterval(r,50))}),onPointerLeave:re(a.onPointerLeave,()=>{l()})})}),vf=Ke.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e;return K.jsx(J.div,{"aria-hidden":!0,...r,ref:t})});vf.displayName="SelectSeparator";var yf="SelectArrow";Ke.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e,a=Tp(s),n=Mp(yf,s),i=Vp(yf,s);return n.open&&"popper"===i.position?K.jsx(xe,{...a,...r,ref:t}):null}).displayName=yf;var jf=Ke.forwardRef(({__scopeSelect:e,value:t,...s},r)=>{const a=Ke.useRef(null),n=Z(r,a),i=yp(t);return Ke.useEffect(()=>{const e=a.current;if(!e)return;const s=window.HTMLSelectElement.prototype,r=Object.getOwnPropertyDescriptor(s,"value").set;if(i!==t&&r){const s=new Event("change",{bubbles:!0});r.call(e,t),e.dispatchEvent(s)}},[i,t]),K.jsx(J.select,{...s,style:{...Dt,...s.style},ref:n,defaultValue:t})});function bf(e){return""===e||void 0===e}function wf(e){const t=ae(e),s=Ke.useRef(""),r=Ke.useRef(0),a=Ke.useCallback(e=>{const a=s.current+e;t(a),function e(t){s.current=t,window.clearTimeout(r.current),""!==t&&(r.current=window.setTimeout(()=>e(""),1e3))}(a)},[t]),n=Ke.useCallback(()=>{s.current="",window.clearTimeout(r.current)},[]);return Ke.useEffect(()=>()=>window.clearTimeout(r.current),[]),[s,a,n]}function Nf(e,t,s){const r=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,a=s?e.indexOf(s):-1;let n=(i=e,o=Math.max(a,0),i.map((e,t)=>i[(o+t)%i.length]));var i,o;1===r.length&&(n=n.filter(e=>e!==s));const l=n.find(e=>e.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==s?l:void 0}jf.displayName="SelectBubbleInput";var _f=Rp,kf=qp,Sf=Fp,Cf=$p,Tf=Xp,Ef=rf,Mf=lf,Pf=df,Af=hf,Df=pf,Of=xf,Rf=vf;const If=Dp,Lf=Lp,qf=Ke.forwardRef(({className:e,children:t,...s},r)=>K.jsxs(_f,{ref:r,className:Aa("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,K.jsx(kf,{asChild:!0,children:K.jsx(Fs,{className:"h-4 w-4 opacity-50"})})]}));qf.displayName=_f.displayName;const Ff=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Df,{ref:s,className:Aa("flex cursor-default items-center justify-center py-1",e),...t,children:K.jsx(Ws,{className:"h-4 w-4"})}));Ff.displayName=Df.displayName;const zf=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Of,{ref:s,className:Aa("flex cursor-default items-center justify-center py-1",e),...t,children:K.jsx(Fs,{className:"h-4 w-4"})}));zf.displayName=Of.displayName;const $f=Ke.forwardRef(({className:e,children:t,position:s="popper",...r},a)=>K.jsx(Sf,{children:K.jsxs(Cf,{ref:a,className:Aa("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...r,children:[K.jsx(Ff,{}),K.jsx(Tf,{className:Aa("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),K.jsx(zf,{})]})}));$f.displayName=Cf.displayName;Ke.forwardRef(({className:e,...t},s)=>K.jsx(Ef,{ref:s,className:Aa("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=Ef.displayName;const Wf=Ke.forwardRef(({className:e,children:t,...s},r)=>K.jsxs(Mf,{ref:r,className:Aa("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[K.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:K.jsx(Af,{children:K.jsx(qs,{className:"h-4 w-4"})})}),K.jsx(Pf,{children:t})]}));Wf.displayName=Mf.displayName;Ke.forwardRef(({className:e,...t},s)=>K.jsx(Rf,{ref:s,className:Aa("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=Rf.displayName;const Uf=(e,t)=>{let s="Une erreur inattendue s'est produite";return(null==e?void 0:e.message)?s=e.message:(null==e?void 0:e.details)?s=e.details:"string"==typeof e&&(s=e),{success:!1,error:s,originalError:e}},Vf=(e,t,s=100)=>{if(e<=0||t<=0)return 0;return((e,t)=>e<=0||t>=e?0:Math.round((e-t)/e*100))(e,t*s)},Bf=(e,t)=>t<=0?0:Math.round(e/t),Hf=e=>!isNaN(e)&&e>=0&&isFinite(e);const Yf={},Gf={};function Kf(e,t){try{const s=(Yf[e]||(Yf[e]=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format))(t).split("GMT")[1];return s in Gf?Gf[s]:Qf(s,s.split(":"))}catch{if(e in Gf)return Gf[e];const t=null==e?void 0:e.match(Jf);return t?Qf(e,t.slice(1)):NaN}}const Jf=/([+-]\d\d):?(\d\d)?/;function Qf(e,t){const s=+(t[0]||0),r=+(t[1]||0),a=+(t[2]||0)/60;return Gf[e]=60*s+r>0?60*s+r+a:60*s-r-a}class Xf extends Date{constructor(...e){super(),e.length>1&&"string"==typeof e[e.length-1]&&(this.timeZone=e.pop()),this.internal=new Date,isNaN(Kf(this.timeZone,this))?this.setTime(NaN):e.length?"number"==typeof e[0]&&(1===e.length||2===e.length&&"number"!=typeof e[1])?this.setTime(e[0]):"string"==typeof e[0]?this.setTime(+new Date(e[0])):e[0]instanceof Date?this.setTime(+e[0]):(this.setTime(+new Date(...e)),tx(this),ex(this)):this.setTime(Date.now())}static tz(e,...t){return t.length?new Xf(...t,e):new Xf(Date.now(),e)}withTimeZone(e){return new Xf(+this,e)}getTimezoneOffset(){const e=-Kf(this.timeZone,this);return e>0?Math.floor(e):Math.ceil(e)}setTime(e){return Date.prototype.setTime.apply(this,arguments),ex(this),+this}[Symbol.for("constructDateFrom")](e){return new Xf(+new Date(e),this.timeZone)}}const Zf=/^(get|set)(?!UTC)/;function ex(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(60*-Kf(e.timeZone,e)))}function tx(e){const t=Kf(e.timeZone,e),s=t>0?Math.floor(t):Math.ceil(t),r=new Date(+e);r.setUTCHours(r.getUTCHours()-1);const a=-new Date(+e).getTimezoneOffset(),n=a- -new Date(+r).getTimezoneOffset(),i=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();n&&i&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+n);const o=a-s;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=new Date(+e);l.setUTCSeconds(0);const c=a>0?l.getSeconds():(l.getSeconds()-60)%60,d=Math.round(-60*Kf(e.timeZone,e))%60;(d||c)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+d),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+d+c));const u=Kf(e.timeZone,e),h=u>0?Math.floor(u):Math.ceil(u),m=-new Date(+e).getTimezoneOffset()-h-o;if(h!==s&&m){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+m);const t=Kf(e.timeZone,e),s=h-(t>0?Math.floor(t):Math.ceil(t));s&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+s),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+s))}}Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!Zf.test(e))return;const t=e.replace(Zf,"$1UTC");Xf.prototype[t]&&(e.startsWith("get")?Xf.prototype[e]=function(){return this.internal[t]()}:(Xf.prototype[e]=function(){var e;return Date.prototype[t].apply(this.internal,arguments),e=this,Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),tx(e),+this},Xf.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),ex(this),+this}))});class sx extends Xf{static tz(e,...t){return t.length?new sx(...t,e):new sx(Date.now(),e)}toISOString(){const[e,t,s]=this.tzComponents(),r=`${e}${t}:${s}`;return this.internal.toISOString().slice(0,-1)+r}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[e,t,s,r]=this.internal.toUTCString().split(" ");return`${null==e?void 0:e.slice(0,-1)} ${s} ${t} ${r}`}toTimeString(){const e=this.internal.toUTCString().split(" ")[4],[t,s,r]=this.tzComponents();return`${e} GMT${t}${s}${r} (${function(e,t,s="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:s}).format(t).split(/\s/g).slice(2).join(" ")}(this.timeZone,this)})`}toLocaleString(e,t){return Date.prototype.toLocaleString.call(this,e,{...t,timeZone:(null==t?void 0:t.timeZone)||this.timeZone})}toLocaleDateString(e,t){return Date.prototype.toLocaleDateString.call(this,e,{...t,timeZone:(null==t?void 0:t.timeZone)||this.timeZone})}toLocaleTimeString(e,t){return Date.prototype.toLocaleTimeString.call(this,e,{...t,timeZone:(null==t?void 0:t.timeZone)||this.timeZone})}tzComponents(){const e=this.getTimezoneOffset();return[e>0?"-":"+",String(Math.floor(Math.abs(e)/60)).padStart(2,"0"),String(Math.abs(e)%60).padStart(2,"0")]}withTimeZone(e){return new sx(+this,e)}[Symbol.for("constructDateFrom")](e){return new sx(+new Date(e),this.timeZone)}}var rx,ax,nx,ix,ox,lx,cx,dx;(ax=rx||(rx={})).Root="root",ax.Chevron="chevron",ax.Day="day",ax.DayButton="day_button",ax.CaptionLabel="caption_label",ax.Dropdowns="dropdowns",ax.Dropdown="dropdown",ax.DropdownRoot="dropdown_root",ax.Footer="footer",ax.MonthGrid="month_grid",ax.MonthCaption="month_caption",ax.MonthsDropdown="months_dropdown",ax.Month="month",ax.Months="months",ax.Nav="nav",ax.NextMonthButton="button_next",ax.PreviousMonthButton="button_previous",ax.Week="week",ax.Weeks="weeks",ax.Weekday="weekday",ax.Weekdays="weekdays",ax.WeekNumber="week_number",ax.WeekNumberHeader="week_number_header",ax.YearsDropdown="years_dropdown",(ix=nx||(nx={})).disabled="disabled",ix.hidden="hidden",ix.outside="outside",ix.focused="focused",ix.today="today",(lx=ox||(ox={})).range_end="range_end",lx.range_middle="range_middle",lx.range_start="range_start",lx.selected="selected",(dx=cx||(cx={})).weeks_before_enter="weeks_before_enter",dx.weeks_before_exit="weeks_before_exit",dx.weeks_after_enter="weeks_after_enter",dx.weeks_after_exit="weeks_after_exit",dx.caption_after_enter="caption_after_enter",dx.caption_after_exit="caption_after_exit",dx.caption_before_enter="caption_before_enter",dx.caption_before_exit="caption_before_exit";const ux=6048e5,hx=Symbol.for("constructDateFrom");function mx(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&hx in e?e[hx](t):e instanceof Date?new e.constructor(t):new Date(t)}function px(e,t){return mx(t||e,e)}function fx(e,t,s){const r=px(e,null==s?void 0:s.in);return isNaN(t)?mx(e,NaN):t?(r.setDate(r.getDate()+t),r):r}function xx(e,t,s){const r=px(e,null==s?void 0:s.in);if(isNaN(t))return mx(e,NaN);if(!t)return r;const a=r.getDate(),n=mx(e,r.getTime());n.setMonth(r.getMonth()+t+1,0);return a>=n.getDate()?n:(r.setFullYear(n.getFullYear(),n.getMonth(),a),r)}let gx={};function vx(){return gx}function yx(e,t){var s,r,a,n;const i=vx(),o=(null==t?void 0:t.weekStartsOn)??(null==(r=null==(s=null==t?void 0:t.locale)?void 0:s.options)?void 0:r.weekStartsOn)??i.weekStartsOn??(null==(n=null==(a=i.locale)?void 0:a.options)?void 0:n.weekStartsOn)??0,l=px(e,null==t?void 0:t.in),c=l.getDay(),d=(c<o?7:0)+c-o;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}function jx(e,t){return yx(e,{...t,weekStartsOn:1})}function bx(e,t){const s=px(e,null==t?void 0:t.in),r=s.getFullYear(),a=mx(s,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const n=jx(a),i=mx(s,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=jx(i);return s.getTime()>=n.getTime()?r+1:s.getTime()>=o.getTime()?r:r-1}function wx(e){const t=px(e),s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return s.setUTCFullYear(t.getFullYear()),+e-+s}function Nx(e,...t){const s=mx.bind(null,t.find(e=>"object"==typeof e));return t.map(s)}function _x(e,t){const s=px(e,null==t?void 0:t.in);return s.setHours(0,0,0,0),s}function kx(e,t,s){const[r,a]=Nx(null==s||s.in,e,t),n=_x(r),i=_x(a),o=+n-wx(n),l=+i-wx(i);return Math.round((o-l)/864e5)}function Sx(e){return e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function Cx(e,t){const{start:s,end:r}=function(e,t){const[s,r]=Nx(0,t.start,t.end);return{start:s,end:r}}(null==t||t.in,e);let a=+s>+r;const n=a?+s:+r,i=a?r:s;i.setHours(0,0,0,0),i.setDate(1);const o=[];for(;+i<=n;)o.push(mx(s,i)),i.setMonth(i.getMonth()+1);return a?o.reverse():o}function Tx(e,t){const s=px(e,null==t?void 0:t.in);return s.setFullYear(s.getFullYear(),0,1),s.setHours(0,0,0,0),s}function Ex(e,t){var s,r,a,n;const i=vx(),o=(null==t?void 0:t.weekStartsOn)??(null==(r=null==(s=null==t?void 0:t.locale)?void 0:s.options)?void 0:r.weekStartsOn)??i.weekStartsOn??(null==(n=null==(a=i.locale)?void 0:a.options)?void 0:n.weekStartsOn)??0,l=px(e,null==t?void 0:t.in),c=l.getDay(),d=6+(c<o?-7:0)-(c-o);return l.setDate(l.getDate()+d),l.setHours(23,59,59,999),l}const Mx={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Px(e){return(t={})=>{const s=t.width?String(t.width):e.defaultWidth;return e.formats[s]||e.formats[e.defaultWidth]}}const Ax={date:Px({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Px({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Px({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Dx={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Ox(e){return(t,s)=>{let r;if("formatting"===((null==s?void 0:s.context)?String(s.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,a=(null==s?void 0:s.width)?String(s.width):t;r=e.formattingValues[a]||e.formattingValues[t]}else{const t=e.defaultWidth,a=(null==s?void 0:s.width)?String(s.width):e.defaultWidth;r=e.values[a]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}const Rx={ordinalNumber:(e,t)=>{const s=Number(e),r=s%100;if(r>20||r<10)switch(r%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},era:Ox({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Ox({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ox({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Ox({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Ox({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function Ix(e){return(t,s={})=>{const r=s.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],n=t.match(a);if(!n)return null;const i=n[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let s=0;s<e.length;s++)if(t(e[s]))return s;return}(o,e=>e.test(i)):function(e,t){for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t(e[s]))return s;return}(o,e=>e.test(i));let c;c=e.valueCallback?e.valueCallback(l):l,c=s.valueCallback?s.valueCallback(c):c;return{value:c,rest:t.slice(i.length)}}}const Lx={ordinalNumber:(qx={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const s=e.match(qx.matchPattern);if(!s)return null;const r=s[0],a=e.match(qx.parsePattern);if(!a)return null;let n=qx.valueCallback?qx.valueCallback(a[0]):a[0];return n=t.valueCallback?t.valueCallback(n):n,{value:n,rest:e.slice(r.length)}}),era:Ix({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Ix({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ix({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Ix({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Ix({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var qx;const Fx={code:"en-US",formatDistance:(e,t,s)=>{let r;const a=Mx[e];return r="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),(null==s?void 0:s.addSuffix)?s.comparison&&s.comparison>0?"in "+r:r+" ago":r},formatLong:Ax,formatRelative:(e,t,s,r)=>Dx[e],localize:Rx,match:Lx,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zx(e,t){const s=px(e,null==t?void 0:t.in),r=+jx(s)-+function(e,t){const s=bx(e,t),r=mx(e,0);return r.setFullYear(s,0,4),r.setHours(0,0,0,0),jx(r)}(s);return Math.round(r/ux)+1}function $x(e,t){var s,r,a,n;const i=px(e,null==t?void 0:t.in),o=i.getFullYear(),l=vx(),c=(null==t?void 0:t.firstWeekContainsDate)??(null==(r=null==(s=null==t?void 0:t.locale)?void 0:s.options)?void 0:r.firstWeekContainsDate)??l.firstWeekContainsDate??(null==(n=null==(a=l.locale)?void 0:a.options)?void 0:n.firstWeekContainsDate)??1,d=mx((null==t?void 0:t.in)||e,0);d.setFullYear(o+1,0,c),d.setHours(0,0,0,0);const u=yx(d,t),h=mx((null==t?void 0:t.in)||e,0);h.setFullYear(o,0,c),h.setHours(0,0,0,0);const m=yx(h,t);return+i>=+u?o+1:+i>=+m?o:o-1}function Wx(e,t){const s=px(e,null==t?void 0:t.in),r=+yx(s,t)-+function(e,t){var s,r,a,n;const i=vx(),o=(null==t?void 0:t.firstWeekContainsDate)??(null==(r=null==(s=null==t?void 0:t.locale)?void 0:s.options)?void 0:r.firstWeekContainsDate)??i.firstWeekContainsDate??(null==(n=null==(a=i.locale)?void 0:a.options)?void 0:n.firstWeekContainsDate)??1,l=$x(e,t),c=mx((null==t?void 0:t.in)||e,0);return c.setFullYear(l,0,o),c.setHours(0,0,0,0),yx(c,t)}(s,t);return Math.round(r/ux)+1}function Ux(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Vx={y(e,t){const s=e.getFullYear(),r=s>0?s:1-s;return Ux("yy"===t?r%100:r,t.length)},M(e,t){const s=e.getMonth();return"M"===t?String(s+1):Ux(s+1,2)},d:(e,t)=>Ux(e.getDate(),t.length),a(e,t){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];default:return"am"===s?"a.m.":"p.m."}},h:(e,t)=>Ux(e.getHours()%12||12,t.length),H:(e,t)=>Ux(e.getHours(),t.length),m:(e,t)=>Ux(e.getMinutes(),t.length),s:(e,t)=>Ux(e.getSeconds(),t.length),S(e,t){const s=t.length,r=e.getMilliseconds();return Ux(Math.trunc(r*Math.pow(10,s-3)),t.length)}},Bx="midnight",Hx="noon",Yx="morning",Gx="afternoon",Kx="evening",Jx="night",Qx={G:function(e,t,s){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return s.era(r,{width:"abbreviated"});case"GGGGG":return s.era(r,{width:"narrow"});default:return s.era(r,{width:"wide"})}},y:function(e,t,s){if("yo"===t){const t=e.getFullYear(),r=t>0?t:1-t;return s.ordinalNumber(r,{unit:"year"})}return Vx.y(e,t)},Y:function(e,t,s,r){const a=$x(e,r),n=a>0?a:1-a;if("YY"===t){return Ux(n%100,2)}return"Yo"===t?s.ordinalNumber(n,{unit:"year"}):Ux(n,t.length)},R:function(e,t){return Ux(bx(e),t.length)},u:function(e,t){return Ux(e.getFullYear(),t.length)},Q:function(e,t,s){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Ux(r,2);case"Qo":return s.ordinalNumber(r,{unit:"quarter"});case"QQQ":return s.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(r,{width:"narrow",context:"formatting"});default:return s.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,s){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Ux(r,2);case"qo":return s.ordinalNumber(r,{unit:"quarter"});case"qqq":return s.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(r,{width:"narrow",context:"standalone"});default:return s.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,s){const r=e.getMonth();switch(t){case"M":case"MM":return Vx.M(e,t);case"Mo":return s.ordinalNumber(r+1,{unit:"month"});case"MMM":return s.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(r,{width:"narrow",context:"formatting"});default:return s.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,s){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Ux(r+1,2);case"Lo":return s.ordinalNumber(r+1,{unit:"month"});case"LLL":return s.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(r,{width:"narrow",context:"standalone"});default:return s.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,s,r){const a=Wx(e,r);return"wo"===t?s.ordinalNumber(a,{unit:"week"}):Ux(a,t.length)},I:function(e,t,s){const r=zx(e);return"Io"===t?s.ordinalNumber(r,{unit:"week"}):Ux(r,t.length)},d:function(e,t,s){return"do"===t?s.ordinalNumber(e.getDate(),{unit:"date"}):Vx.d(e,t)},D:function(e,t,s){const r=function(e,t){const s=px(e,null==t?void 0:t.in);return kx(s,Tx(s))+1}(e);return"Do"===t?s.ordinalNumber(r,{unit:"dayOfYear"}):Ux(r,t.length)},E:function(e,t,s){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return s.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(r,{width:"short",context:"formatting"});default:return s.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,s,r){const a=e.getDay(),n=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(n);case"ee":return Ux(n,2);case"eo":return s.ordinalNumber(n,{unit:"day"});case"eee":return s.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(a,{width:"short",context:"formatting"});default:return s.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,s,r){const a=e.getDay(),n=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(n);case"cc":return Ux(n,t.length);case"co":return s.ordinalNumber(n,{unit:"day"});case"ccc":return s.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(a,{width:"narrow",context:"standalone"});case"cccccc":return s.day(a,{width:"short",context:"standalone"});default:return s.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,s){const r=e.getDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return Ux(a,t.length);case"io":return s.ordinalNumber(a,{unit:"day"});case"iii":return s.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(r,{width:"short",context:"formatting"});default:return s.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,s){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(r,{width:"narrow",context:"formatting"});default:return s.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,s){const r=e.getHours();let a;switch(a=12===r?Hx:0===r?Bx:r/12>=1?"pm":"am",t){case"b":case"bb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(a,{width:"narrow",context:"formatting"});default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,s){const r=e.getHours();let a;switch(a=r>=17?Kx:r>=12?Gx:r>=4?Yx:Jx,t){case"B":case"BB":case"BBB":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(a,{width:"narrow",context:"formatting"});default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,s){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),s.ordinalNumber(t,{unit:"hour"})}return Vx.h(e,t)},H:function(e,t,s){return"Ho"===t?s.ordinalNumber(e.getHours(),{unit:"hour"}):Vx.H(e,t)},K:function(e,t,s){const r=e.getHours()%12;return"Ko"===t?s.ordinalNumber(r,{unit:"hour"}):Ux(r,t.length)},k:function(e,t,s){let r=e.getHours();return 0===r&&(r=24),"ko"===t?s.ordinalNumber(r,{unit:"hour"}):Ux(r,t.length)},m:function(e,t,s){return"mo"===t?s.ordinalNumber(e.getMinutes(),{unit:"minute"}):Vx.m(e,t)},s:function(e,t,s){return"so"===t?s.ordinalNumber(e.getSeconds(),{unit:"second"}):Vx.s(e,t)},S:function(e,t){return Vx.S(e,t)},X:function(e,t,s){const r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return Zx(r);case"XXXX":case"XX":return eg(r);default:return eg(r,":")}},x:function(e,t,s){const r=e.getTimezoneOffset();switch(t){case"x":return Zx(r);case"xxxx":case"xx":return eg(r);default:return eg(r,":")}},O:function(e,t,s){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Xx(r,":");default:return"GMT"+eg(r,":")}},z:function(e,t,s){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Xx(r,":");default:return"GMT"+eg(r,":")}},t:function(e,t,s){return Ux(Math.trunc(+e/1e3),t.length)},T:function(e,t,s){return Ux(+e,t.length)}};function Xx(e,t=""){const s=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),n=r%60;return 0===n?s+String(a):s+String(a)+t+Ux(n,2)}function Zx(e,t){if(e%60==0){return(e>0?"-":"+")+Ux(Math.abs(e)/60,2)}return eg(e,t)}function eg(e,t=""){const s=e>0?"-":"+",r=Math.abs(e);return s+Ux(Math.trunc(r/60),2)+t+Ux(r%60,2)}const tg=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},sg=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},rg={p:sg,P:(e,t)=>{const s=e.match(/(P+)(p+)?/)||[],r=s[1],a=s[2];if(!a)return tg(e,t);let n;switch(r){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",tg(r,t)).replace("{{time}}",sg(a,t))}},ag=/^D+$/,ng=/^Y+$/,ig=["D","DD","YY","YYYY"];const og=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lg=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cg=/^'([^]*?)'?$/,dg=/''/g,ug=/[a-zA-Z]/;function hg(e,t,s){var r,a,n,i,o,l,c,d;const u=vx(),h=(null==s?void 0:s.locale)??u.locale??Fx,m=(null==s?void 0:s.firstWeekContainsDate)??(null==(a=null==(r=null==s?void 0:s.locale)?void 0:r.options)?void 0:a.firstWeekContainsDate)??u.firstWeekContainsDate??(null==(i=null==(n=u.locale)?void 0:n.options)?void 0:i.firstWeekContainsDate)??1,p=(null==s?void 0:s.weekStartsOn)??(null==(l=null==(o=null==s?void 0:s.locale)?void 0:o.options)?void 0:l.weekStartsOn)??u.weekStartsOn??(null==(d=null==(c=u.locale)?void 0:c.options)?void 0:d.weekStartsOn)??0,f=px(e,null==s?void 0:s.in);if(!function(e){return!(!Sx(e)&&"number"!=typeof e||isNaN(+px(e)))}(f))throw new RangeError("Invalid time value");let x=t.match(lg).map(e=>{const t=e[0];if("p"===t||"P"===t){return(0,rg[t])(e,h.formatLong)}return e}).join("").match(og).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:mg(e)};if(Qx[t])return{isToken:!0,value:e};if(t.match(ug))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});h.localize.preprocessor&&(x=h.localize.preprocessor(f,x));const g={firstWeekContainsDate:m,weekStartsOn:p,locale:h};return x.map(r=>{if(!r.isToken)return r.value;const a=r.value;(!(null==s?void 0:s.useAdditionalWeekYearTokens)&&function(e){return ng.test(e)}(a)||!(null==s?void 0:s.useAdditionalDayOfYearTokens)&&function(e){return ag.test(e)}(a))&&function(e,t,s){const r=function(e,t,s){const r="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,s);if(ig.includes(e))throw new RangeError(r)}(a,t,String(e));return(0,Qx[a[0]])(f,a,h.localize,g)}).join("")}function mg(e){const t=e.match(cg);return t?t[1].replace(dg,"'"):e}function pg(e,t,s){const r=px(e,null==s?void 0:s.in),a=r.getFullYear(),n=r.getDate(),i=mx(e,0);i.setFullYear(a,t,15),i.setHours(0,0,0,0);const o=function(e,t){const s=px(e,null==t?void 0:t.in),r=s.getFullYear(),a=s.getMonth(),n=mx(s,0);return n.setFullYear(r,a+1,0),n.setHours(0,0,0,0),n.getDate()}(i);return r.setMonth(t,Math.min(n,o)),r}function fg(e,t){const s=t.startOfMonth(e),r=s.getDay();return 1===r?s:0===r?t.addDays(s,-6):t.addDays(s,-1*(r-1))}class xg{constructor(e,t){this.Date=Date,this.today=()=>{var e;return(null==(e=this.overrides)?void 0:e.today)?this.overrides.today():this.options.timeZone?sx.tz(this.options.timeZone):new this.Date},this.newDate=(e,t,s)=>{var r;return(null==(r=this.overrides)?void 0:r.newDate)?this.overrides.newDate(e,t,s):this.options.timeZone?new sx(e,t,s,this.options.timeZone):new Date(e,t,s)},this.addDays=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.addDays)?this.overrides.addDays(e,t):fx(e,t)},this.addMonths=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.addMonths)?this.overrides.addMonths(e,t):xx(e,t)},this.addWeeks=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.addWeeks)?this.overrides.addWeeks(e,t):function(e,t,s){return fx(e,7*t,s)}(e,t)},this.addYears=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.addYears)?this.overrides.addYears(e,t):function(e,t,s){return xx(e,12*t,s)}(e,t)},this.differenceInCalendarDays=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.differenceInCalendarDays)?this.overrides.differenceInCalendarDays(e,t):kx(e,t)},this.differenceInCalendarMonths=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.differenceInCalendarMonths)?this.overrides.differenceInCalendarMonths(e,t):function(e,t,s){const[r,a]=Nx(null==s||s.in,e,t);return 12*(r.getFullYear()-a.getFullYear())+(r.getMonth()-a.getMonth())}(e,t)},this.eachMonthOfInterval=e=>{var t;return(null==(t=this.overrides)?void 0:t.eachMonthOfInterval)?this.overrides.eachMonthOfInterval(e):Cx(e)},this.endOfBroadcastWeek=e=>{var t;return(null==(t=this.overrides)?void 0:t.endOfBroadcastWeek)?this.overrides.endOfBroadcastWeek(e):function(e,t){const s=fg(e,t),r=function(e,t){const s=t.startOfMonth(e),r=s.getDay()>0?s.getDay():7,a=t.addDays(e,1-r),n=t.addDays(a,34);return t.getMonth(e)===t.getMonth(n)?5:4}(e,t);return t.addDays(s,7*r-1)}(e,this)},this.endOfISOWeek=e=>{var t;return(null==(t=this.overrides)?void 0:t.endOfISOWeek)?this.overrides.endOfISOWeek(e):function(e,t){return Ex(e,{...t,weekStartsOn:1})}(e)},this.endOfMonth=e=>{var t;return(null==(t=this.overrides)?void 0:t.endOfMonth)?this.overrides.endOfMonth(e):function(e,t){const s=px(e,null==t?void 0:t.in),r=s.getMonth();return s.setFullYear(s.getFullYear(),r+1,0),s.setHours(23,59,59,999),s}(e)},this.endOfWeek=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.endOfWeek)?this.overrides.endOfWeek(e,t):Ex(e,this.options)},this.endOfYear=e=>{var t;return(null==(t=this.overrides)?void 0:t.endOfYear)?this.overrides.endOfYear(e):function(e,t){const s=px(e,null==t?void 0:t.in),r=s.getFullYear();return s.setFullYear(r+1,0,0),s.setHours(23,59,59,999),s}(e)},this.format=(e,t,s)=>{var r;const a=(null==(r=this.overrides)?void 0:r.format)?this.overrides.format(e,t,this.options):hg(e,t,this.options);return this.options.numerals&&"latn"!==this.options.numerals?this.replaceDigits(a):a},this.getISOWeek=e=>{var t;return(null==(t=this.overrides)?void 0:t.getISOWeek)?this.overrides.getISOWeek(e):zx(e)},this.getMonth=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.getMonth)?this.overrides.getMonth(e,this.options):function(e,t){return px(e,null==t?void 0:t.in).getMonth()}(e,this.options)},this.getYear=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.getYear)?this.overrides.getYear(e,this.options):function(e,t){return px(e,null==t?void 0:t.in).getFullYear()}(e,this.options)},this.getWeek=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.getWeek)?this.overrides.getWeek(e,this.options):Wx(e,this.options)},this.isAfter=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.isAfter)?this.overrides.isAfter(e,t):function(e,t){return+px(e)>+px(t)}(e,t)},this.isBefore=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.isBefore)?this.overrides.isBefore(e,t):function(e,t){return+px(e)<+px(t)}(e,t)},this.isDate=e=>{var t;return(null==(t=this.overrides)?void 0:t.isDate)?this.overrides.isDate(e):Sx(e)},this.isSameDay=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.isSameDay)?this.overrides.isSameDay(e,t):function(e,t,s){const[r,a]=Nx(null==s||s.in,e,t);return+_x(r)===+_x(a)}(e,t)},this.isSameMonth=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.isSameMonth)?this.overrides.isSameMonth(e,t):function(e,t,s){const[r,a]=Nx(null==s||s.in,e,t);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}(e,t)},this.isSameYear=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.isSameYear)?this.overrides.isSameYear(e,t):function(e,t,s){const[r,a]=Nx(null==s||s.in,e,t);return r.getFullYear()===a.getFullYear()}(e,t)},this.max=e=>{var t;return(null==(t=this.overrides)?void 0:t.max)?this.overrides.max(e):function(e,t){let s,r=null==t?void 0:t.in;return e.forEach(e=>{r||"object"!=typeof e||(r=mx.bind(null,e));const t=px(e,r);(!s||s<t||isNaN(+t))&&(s=t)}),mx(r,s||NaN)}(e)},this.min=e=>{var t;return(null==(t=this.overrides)?void 0:t.min)?this.overrides.min(e):function(e,t){let s,r=null==t?void 0:t.in;return e.forEach(e=>{r||"object"!=typeof e||(r=mx.bind(null,e));const t=px(e,r);(!s||s>t||isNaN(+t))&&(s=t)}),mx(r,s||NaN)}(e)},this.setMonth=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.setMonth)?this.overrides.setMonth(e,t):pg(e,t)},this.setYear=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.setYear)?this.overrides.setYear(e,t):function(e,t,s){const r=px(e,null==s?void 0:s.in);return isNaN(+r)?mx(e,NaN):(r.setFullYear(t),r)}(e,t)},this.startOfBroadcastWeek=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.startOfBroadcastWeek)?this.overrides.startOfBroadcastWeek(e,this):fg(e,this)},this.startOfDay=e=>{var t;return(null==(t=this.overrides)?void 0:t.startOfDay)?this.overrides.startOfDay(e):_x(e)},this.startOfISOWeek=e=>{var t;return(null==(t=this.overrides)?void 0:t.startOfISOWeek)?this.overrides.startOfISOWeek(e):jx(e)},this.startOfMonth=e=>{var t;return(null==(t=this.overrides)?void 0:t.startOfMonth)?this.overrides.startOfMonth(e):function(e,t){const s=px(e,null==t?void 0:t.in);return s.setDate(1),s.setHours(0,0,0,0),s}(e)},this.startOfWeek=(e,t)=>{var s;return(null==(s=this.overrides)?void 0:s.startOfWeek)?this.overrides.startOfWeek(e,this.options):yx(e,this.options)},this.startOfYear=e=>{var t;return(null==(t=this.overrides)?void 0:t.startOfYear)?this.overrides.startOfYear(e):Tx(e)},this.options={locale:Fx,...e},this.overrides=t}getDigitMap(){const{numerals:e="latn"}=this.options,t=new Intl.NumberFormat("en-US",{numberingSystem:e}),s={};for(let r=0;r<10;r++)s[r.toString()]=t.format(r);return s}replaceDigits(e){const t=this.getDigitMap();return e.replace(/\d/g,e=>t[e]||e)}formatNumber(e){return this.replaceDigits(e.toString())}}const gg=new xg;class vg{constructor(e,t,s=gg){this.date=e,this.displayMonth=t,this.outside=Boolean(t&&!s.isSameMonth(e,t)),this.dateLib=s}isEqualTo(e){return this.dateLib.isSameDay(e.date,this.date)&&this.dateLib.isSameMonth(e.displayMonth,this.displayMonth)}}class yg{constructor(e,t){this.date=e,this.weeks=t}}class jg{constructor(e,t){this.days=t,this.weekNumber=e}}function bg(e,t,s=!1,r=gg){let{from:a,to:n}=e;const{differenceInCalendarDays:i,isSameDay:o}=r;if(a&&n){i(n,a)<0&&([a,n]=[n,a]);return i(t,a)>=(s?1:0)&&i(n,t)>=(s?1:0)}return!s&&n?o(n,t):!(s||!a)&&o(a,t)}function wg(e){return Boolean(e&&"object"==typeof e&&"before"in e&&"after"in e)}function Ng(e){return Boolean(e&&"object"==typeof e&&"from"in e)}function _g(e){return Boolean(e&&"object"==typeof e&&"after"in e)}function kg(e){return Boolean(e&&"object"==typeof e&&"before"in e)}function Sg(e){return Boolean(e&&"object"==typeof e&&"dayOfWeek"in e)}function Cg(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Tg(e,t,s=gg){const r=Array.isArray(t)?t:[t],{isSameDay:a,differenceInCalendarDays:n,isAfter:i}=s;return r.some(t=>{if("boolean"==typeof t)return t;if(s.isDate(t))return a(e,t);if(Cg(t,s))return t.includes(e);if(Ng(t))return bg(t,e,!1,s);if(Sg(t))return Array.isArray(t.dayOfWeek)?t.dayOfWeek.includes(e.getDay()):t.dayOfWeek===e.getDay();if(wg(t)){const s=n(t.before,e)>0,r=n(t.after,e)<0;return i(t.before,t.after)?r&&s:s||r}return _g(t)?n(e,t.after)>0:kg(t)?n(t.before,e)>0:"function"==typeof t&&t(e)})}const Eg=Ke.createContext(void 0);function Mg(){const e=Ke.useContext(Eg);if(void 0===e)throw new Error("useDayPicker() must be used within a custom component.");return e}const Pg=Object.freeze(Object.defineProperty({__proto__:null,Button:function(e){return Je.createElement("button",{...e})},CaptionLabel:function(e){return Je.createElement("span",{...e})},Chevron:function(e){const{size:t=24,orientation:s="left",className:r}=e;return Je.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},"up"===s&&Je.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),"down"===s&&Je.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),"left"===s&&Je.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),"right"===s&&Je.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))},Day:function(e){const{day:t,modifiers:s,...r}=e;return Je.createElement("td",{...r})},DayButton:function(e){const{day:t,modifiers:s,...r}=e,a=Je.useRef(null);return Je.useEffect(()=>{var e;s.focused&&(null==(e=a.current)||e.focus())},[s.focused]),Je.createElement("button",{ref:a,...r})},Dropdown:function(e){const{options:t,className:s,components:r,classNames:a,...n}=e,i=[a[rx.Dropdown],s].join(" "),o=null==t?void 0:t.find(({value:e})=>e===n.value);return Je.createElement("span",{"data-disabled":n.disabled,className:a[rx.DropdownRoot]},Je.createElement(r.Select,{className:i,...n},null==t?void 0:t.map(({value:e,label:t,disabled:s})=>Je.createElement(r.Option,{key:e,value:e,disabled:s},t))),Je.createElement("span",{className:a[rx.CaptionLabel],"aria-hidden":!0},null==o?void 0:o.label,Je.createElement(r.Chevron,{orientation:"down",size:18,className:a[rx.Chevron]})))},DropdownNav:function(e){return Je.createElement("div",{...e})},Footer:function(e){return Je.createElement("div",{...e})},Month:function(e){const{calendarMonth:t,displayIndex:s,...r}=e;return Je.createElement("div",{...r},e.children)},MonthCaption:function(e){const{calendarMonth:t,displayIndex:s,...r}=e;return Je.createElement("div",{...r})},MonthGrid:function(e){return Je.createElement("table",{...e})},Months:function(e){return Je.createElement("div",{...e})},MonthsDropdown:function(e){const{components:t}=Mg();return Je.createElement(t.Dropdown,{...e})},Nav:function(e){const{onPreviousClick:t,onNextClick:s,previousMonth:r,nextMonth:a,...n}=e,{components:i,classNames:o,labels:{labelPrevious:l,labelNext:c}}=Mg(),d=Ke.useCallback(e=>{a&&(null==s||s(e))},[a,s]),u=Ke.useCallback(e=>{r&&(null==t||t(e))},[r,t]);return Je.createElement("nav",{...n},Je.createElement(i.PreviousMonthButton,{type:"button",className:o[rx.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":!r||void 0,"aria-label":l(r),onClick:u},Je.createElement(i.Chevron,{disabled:!r||void 0,className:o[rx.Chevron],orientation:"left"})),Je.createElement(i.NextMonthButton,{type:"button",className:o[rx.NextMonthButton],tabIndex:a?void 0:-1,"aria-disabled":!a||void 0,"aria-label":c(a),onClick:d},Je.createElement(i.Chevron,{disabled:!a||void 0,orientation:"right",className:o[rx.Chevron]})))},NextMonthButton:function(e){const{components:t}=Mg();return Je.createElement(t.Button,{...e})},Option:function(e){return Je.createElement("option",{...e})},PreviousMonthButton:function(e){const{components:t}=Mg();return Je.createElement(t.Button,{...e})},Root:function(e){const{rootRef:t,...s}=e;return Je.createElement("div",{...s,ref:t})},Select:function(e){return Je.createElement("select",{...e})},Week:function(e){const{week:t,...s}=e;return Je.createElement("tr",{...s})},WeekNumber:function(e){const{week:t,...s}=e;return Je.createElement("th",{...s})},WeekNumberHeader:function(e){return Je.createElement("th",{...e})},Weekday:function(e){return Je.createElement("th",{...e})},Weekdays:function(e){return Je.createElement("thead",{"aria-hidden":!0},Je.createElement("tr",{...e}))},Weeks:function(e){return Je.createElement("tbody",{...e})},YearsDropdown:function(e){const{components:t}=Mg();return Je.createElement(t.Dropdown,{...e})}},Symbol.toStringTag,{value:"Module"}));function Ag(){const e={};for(const t in rx)e[rx[t]]=`rdp-${rx[t]}`;for(const t in nx)e[nx[t]]=`rdp-${nx[t]}`;for(const t in ox)e[ox[t]]=`rdp-${ox[t]}`;for(const t in cx)e[cx[t]]=`rdp-${cx[t]}`;return e}function Dg(e,t,s){return(s??new xg(t)).format(e,"LLLL y")}const Og=Dg;function Rg(e,t=gg){return t.format(e,"yyyy")}const Ig=Rg,Lg=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Dg,formatDay:function(e,t,s){return(s??new xg(t)).format(e,"d")},formatMonthCaption:Og,formatMonthDropdown:function(e,t=gg){return t.format(e,"LLLL")},formatWeekNumber:function(e,t=gg){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)},formatWeekNumberHeader:function(){return""},formatWeekdayName:function(e,t,s){return(s??new xg(t)).format(e,"cccccc")},formatYearCaption:Ig,formatYearDropdown:Rg},Symbol.toStringTag,{value:"Module"}));function qg(e,t,s){return(s??new xg(t)).format(e,"LLLL y")}const Fg=qg;function zg(e,t,s,r){let a=(r??new xg(s)).format(e,"PPPP");return t.today&&(a=`Today, ${a}`),t.selected&&(a=`${a}, selected`),a}const $g=zg;const Wg=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:Fg,labelDay:$g,labelDayButton:zg,labelGrid:qg,labelGridcell:function(e,t,s,r){let a=(r??new xg(s)).format(e,"PPPP");return(null==t?void 0:t.today)&&(a=`Today, ${a}`),a},labelMonthDropdown:function(e){return"Choose the Month"},labelNav:function(){return""},labelNext:function(e){return"Go to the Next Month"},labelPrevious:function(e){return"Go to the Previous Month"},labelWeekNumber:function(e,t){return`Week ${e}`},labelWeekNumberHeader:function(e){return"Week Number"},labelWeekday:function(e,t,s){return(s??new xg(t)).format(e,"cccc")},labelYearDropdown:function(e){return"Choose the Year"}},Symbol.toStringTag,{value:"Module"})),Ug=e=>e instanceof HTMLElement?e:null,Vg=e=>[...e.querySelectorAll("[data-animated-month]")??[]],Bg=e=>Ug(e.querySelector("[data-animated-caption]")),Hg=e=>Ug(e.querySelector("[data-animated-weeks]"));function Yg(e,t,{classNames:s,months:r,focused:a,dateLib:n}){const i=Ke.useRef(null),o=Ke.useRef(r),l=Ke.useRef(!1);Ke.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!(t&&e.current&&e.current instanceof HTMLElement&&0!==r.length&&0!==c.length&&r.length===c.length))return;const d=n.isSameMonth(r[0].date,c[0].date),u=n.isAfter(r[0].date,c[0].date),h=u?s[cx.caption_after_enter]:s[cx.caption_before_enter],m=u?s[cx.weeks_after_enter]:s[cx.weeks_before_enter],p=i.current,f=e.current.cloneNode(!0);if(f instanceof HTMLElement){Vg(f).forEach(e=>{if(!(e instanceof HTMLElement))return;const t=Ug(e.querySelector("[data-animated-month]"));t&&e.contains(t)&&e.removeChild(t);const s=Bg(e);s&&s.classList.remove(h);const r=Hg(e);r&&r.classList.remove(m)}),i.current=f}else i.current=null;if(l.current||d||a)return;const x=p instanceof HTMLElement?Vg(p):[],g=Vg(e.current);if(g&&g.every(e=>e instanceof HTMLElement)&&x&&x.every(e=>e instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const t=(v=e.current,Ug(v.querySelector("[data-animated-nav]")));t&&(t.style.zIndex="1"),g.forEach((r,a)=>{const n=x[a];if(!n)return;r.style.position="relative",r.style.overflow="hidden";const i=Bg(r);i&&i.classList.add(h);const o=Hg(r);o&&o.classList.add(m);const c=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),t&&(t.style.zIndex=""),i&&i.classList.remove(h),o&&o.classList.remove(m),r.style.position="",r.style.overflow="",r.contains(n)&&r.removeChild(n)};n.style.pointerEvents="none",n.style.position="absolute",n.style.overflow="hidden",n.setAttribute("aria-hidden","true");const d=(e=>Ug(e.querySelector("[data-animated-weekdays]")))(n);d&&(d.style.opacity="0");const p=Bg(n);p&&(p.classList.add(u?s[cx.caption_before_exit]:s[cx.caption_after_exit]),p.addEventListener("animationend",c));const f=Hg(n);f&&f.classList.add(u?s[cx.weeks_before_exit]:s[cx.weeks_after_exit]),r.insertBefore(n,r.firstChild)})}var v})}function Gg(e,t,s,r){const{month:a,defaultMonth:n,today:i=r.today(),numberOfMonths:o=1}=e;let l=a||n||i;const{differenceInCalendarMonths:c,addMonths:d,startOfMonth:u}=r;if(s&&c(s,l)<o-1){l=d(s,-1*(o-1))}return t&&c(l,t)<0&&(l=t),u(l)}function Kg(e,t){const[s,r]=Ke.useState(e);return[void 0===t?s:t,r]}function Jg(e,t){const[s,r]=function(e,t){let{startMonth:s,endMonth:r}=e;const{startOfYear:a,startOfDay:n,startOfMonth:i,endOfMonth:o,addYears:l,endOfYear:c,newDate:d,today:u}=t,{fromYear:h,toYear:m,fromMonth:p,toMonth:f}=e;!s&&p&&(s=p),!s&&h&&(s=t.newDate(h,0,1)),!r&&f&&(r=f),!r&&m&&(r=d(m,11,31));const x="dropdown"===e.captionLayout||"dropdown-years"===e.captionLayout;return s?s=i(s):h?s=d(h,0,1):!s&&x&&(s=a(l(e.today??u(),-100))),r?r=o(r):m?r=d(m,11,31):!r&&x&&(r=c(e.today??u())),[s?n(s):s,r?n(r):r]}(e,t),{startOfMonth:a,endOfMonth:n}=t,i=Gg(e,s,r,t),[o,l]=Kg(i,e.month?i:void 0);Ke.useEffect(()=>{const a=Gg(e,s,r,t);l(a)},[e.timeZone]);const c=function(e,t,s,r){const{numberOfMonths:a=1}=s,n=[];for(let i=0;i<a;i++){const s=r.addMonths(e,i);if(t&&s>t)break;n.push(s)}return n}(o,r,e,t),d=function(e,t,s,r){const a=e[0],n=e[e.length-1],{ISOWeek:i,fixedWeeks:o,broadcastCalendar:l}=s??{},{addDays:c,differenceInCalendarDays:d,differenceInCalendarMonths:u,endOfBroadcastWeek:h,endOfISOWeek:m,endOfMonth:p,endOfWeek:f,isAfter:x,startOfBroadcastWeek:g,startOfISOWeek:v,startOfWeek:y}=r,j=l?g(a,r):i?v(a):y(a),b=d(l?h(n):i?m(p(n)):f(p(n)),j),w=u(n,a)+1,N=[];for(let k=0;k<=b;k++){const e=c(j,k);if(t&&x(e,t))break;N.push(e)}const _=(l?35:42)*w;if(o&&N.length<_){const e=_-N.length;for(let t=0;t<e;t++){const e=c(N[N.length-1],1);N.push(e)}}return N}(c,e.endMonth?n(e.endMonth):void 0,e,t),u=function(e,t,s,r){const{addDays:a,endOfBroadcastWeek:n,endOfISOWeek:i,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:d,startOfBroadcastWeek:u,startOfISOWeek:h,startOfWeek:m}=r,p=e.reduce((e,p)=>{const f=s.broadcastCalendar?u(p,r):s.ISOWeek?h(p):m(p),x=s.broadcastCalendar?n(p):s.ISOWeek?i(o(p)):l(o(p)),g=t.filter(e=>e>=f&&e<=x),v=s.broadcastCalendar?35:42;if(s.fixedWeeks&&g.length<v){const e=t.filter(e=>{const t=v-g.length;return e>x&&e<=a(x,t)});g.push(...e)}const y=g.reduce((e,t)=>{const a=s.ISOWeek?c(t):d(t),n=e.find(e=>e.weekNumber===a),i=new vg(t,p,r);return n?n.days.push(i):e.push(new jg(a,[i])),e},[]),j=new yg(p,y);return e.push(j),e},[]);return s.reverseMonths?p.reverse():p}(c,d,e,t),h=function(e){return e.reduce((e,t)=>[...e,...t.weeks],[])}(u),m=function(e){const t=[];return e.reduce((e,s)=>[...e,...s.weeks.reduce((e,t)=>[...e,...t.days],t)],t)}(u),p=function(e,t,s,r){if(s.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:n}=s,{startOfMonth:i,addMonths:o,differenceInCalendarMonths:l}=r,c=a?n??1:1,d=i(e);return t&&l(d,t)<=0?void 0:o(d,-c)}(o,s,e,t),f=function(e,t,s,r){if(s.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:n=1}=s,{startOfMonth:i,addMonths:o,differenceInCalendarMonths:l}=r,c=a?n:1,d=i(e);return t&&l(t,e)<n?void 0:o(d,c)}(o,r,e,t),{disableNavigation:x,onMonthChange:g}=e,v=e=>{if(x)return;let t=a(e);s&&t<a(s)&&(t=a(s)),r&&t>a(r)&&(t=a(r)),l(t),null==g||g(t)};return{months:u,weeks:h,days:m,navStart:s,navEnd:r,previousMonth:p,nextMonth:f,goToMonth:v,goToDay:e=>{(e=>h.some(t=>t.days.some(t=>t.isEqualTo(e))))(e)||v(e.date)}}}var Qg,Xg;function Zg(e){return!e[nx.disabled]&&!e[nx.hidden]&&!e[nx.outside]}function ev(e,t,s,r,a,n,i,o=0){if(o>365)return;const l=function(e,t,s,r,a,n,i){const{ISOWeek:o,broadcastCalendar:l}=n,{addDays:c,addMonths:d,addWeeks:u,addYears:h,endOfBroadcastWeek:m,endOfISOWeek:p,endOfWeek:f,max:x,min:g,startOfBroadcastWeek:v,startOfISOWeek:y,startOfWeek:j}=i;let b={day:c,week:u,month:d,year:h,startOfWeek:e=>l?v(e,i):o?y(e):j(e),endOfWeek:e=>l?m(e):o?p(e):f(e)}[e](s,"after"===t?1:-1);return"before"===t&&r?b=x([r,b]):"after"===t&&a&&(b=g([a,b])),b}(e,t,s.date,r,a,n,i),c=Boolean(n.disabled&&Tg(l,n.disabled,i)),d=Boolean(n.hidden&&Tg(l,n.hidden,i)),u=new vg(l,l,i);return c||d?ev(e,t,u,r,a,n,i,o+1):u}function tv(e,t,s,r,a){const{autoFocus:n}=e,[i,o]=Ke.useState(),l=function(e,t,s,r){let a,n=-1;for(const i of e){const e=t(i);Zg(e)&&(e[nx.focused]&&n<Qg.FocusedModifier?(a=i,n=Qg.FocusedModifier):(null==r?void 0:r.isEqualTo(i))&&n<Qg.LastFocused?(a=i,n=Qg.LastFocused):s(i.date)&&n<Qg.Selected?(a=i,n=Qg.Selected):e[nx.today]&&n<Qg.Today&&(a=i,n=Qg.Today))}return a||(a=e.find(e=>Zg(t(e)))),a}(t.days,s,r||(()=>!1),i),[c,d]=Ke.useState(n?l:void 0);return{isFocusTarget:e=>Boolean(null==l?void 0:l.isEqualTo(e)),setFocused:d,focused:c,blur:()=>{o(c),d(void 0)},moveFocus:(s,r)=>{if(!c)return;const n=ev(s,r,c,t.navStart,t.navEnd,e,a);n&&(t.goToDay(n),d(n))}}}function sv(e,t,s=gg){return bg(e,t.from,!1,s)||bg(e,t.to,!1,s)||bg(t,e.from,!1,s)||bg(t,e.to,!1,s)}function rv(e,t,s=gg){const r=Array.isArray(t)?t:[t];if(r.filter(e=>"function"!=typeof e).some(t=>{if("boolean"==typeof t)return t;if(s.isDate(t))return bg(e,t,!1,s);if(Cg(t,s))return t.some(t=>bg(e,t,!1,s));if(Ng(t))return!(!t.from||!t.to)&&sv(e,{from:t.from,to:t.to},s);if(Sg(t))return function(e,t,s=gg){const r=Array.isArray(t)?t:[t];let a=e.from;const n=s.differenceInCalendarDays(e.to,e.from),i=Math.min(n,6);for(let o=0;o<=i;o++){if(r.includes(a.getDay()))return!0;a=s.addDays(a,1)}return!1}(e,t.dayOfWeek,s);if(wg(t)){return s.isAfter(t.before,t.after)?sv(e,{from:s.addDays(t.after,1),to:s.addDays(t.before,-1)},s):Tg(e.from,t,s)||Tg(e.to,t,s)}return!(!_g(t)&&!kg(t))&&(Tg(e.from,t,s)||Tg(e.to,t,s))}))return!0;const a=r.filter(e=>"function"==typeof e);if(a.length){let t=e.from;const r=s.differenceInCalendarDays(e.to,e.from);for(let e=0;e<=r;e++){if(a.some(e=>e(t)))return!0;t=s.addDays(t,1)}}return!1}function av(e,t){const{disabled:s,excludeDisabled:r,selected:a,required:n,onSelect:i}=e,[o,l]=Kg(a,i?a:void 0),c=i?a:o;return{selected:c,select:(a,o,d)=>{const{min:u,max:h}=e,m=a?function(e,t,s=0,r=0,a=!1,n=gg){const{from:i,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:d}=n;let u;if(i||o){if(i&&!o)u=l(i,e)?a?{from:i,to:void 0}:void 0:d(e,i)?{from:e,to:i}:{from:i,to:e};else if(i&&o)if(l(i,e)&&l(o,e))u=a?{from:i,to:o}:void 0;else if(l(i,e))u={from:i,to:s>0?void 0:e};else if(l(o,e))u={from:e,to:s>0?void 0:e};else if(d(e,i))u={from:e,to:o};else if(c(e,i))u={from:i,to:e};else{if(!c(e,o))throw new Error("Invalid range");u={from:i,to:e}}}else u={from:e,to:s>0?void 0:e};if((null==u?void 0:u.from)&&(null==u?void 0:u.to)){const t=n.differenceInCalendarDays(u.to,u.from);(r>0&&t>r||s>1&&t<s)&&(u={from:e,to:void 0})}return u}(a,c,u,h,n,t):void 0;return r&&s&&(null==m?void 0:m.from)&&m.to&&rv({from:m.from,to:m.to},s,t)&&(m.from=a,m.to=void 0),i||l(m),null==i||i(m,a,o,d),m},isSelected:e=>c&&bg(c,e,!1,t)}}function nv(e,t){const s=function(e,t){const{selected:s,required:r,onSelect:a}=e,[n,i]=Kg(s,a?s:void 0),o=a?s:n,{isSameDay:l}=t;return{selected:o,select:(e,t,s)=>{let n=e;return!r&&o&&o&&l(e,o)&&(n=void 0),a||i(n),null==a||a(n,e,t,s),n},isSelected:e=>!!o&&l(o,e)}}(e,t),r=function(e,t){const{selected:s,required:r,onSelect:a}=e,[n,i]=Kg(s,a?s:void 0),o=a?s:n,{isSameDay:l}=t,c=e=>(null==o?void 0:o.some(t=>l(t,e)))??!1,{min:d,max:u}=e;return{selected:o,select:(e,t,s)=>{let n=[...o??[]];if(c(e)){if((null==o?void 0:o.length)===d)return;if(r&&1===(null==o?void 0:o.length))return;n=null==o?void 0:o.filter(t=>!l(t,e))}else n=(null==o?void 0:o.length)===u?[e]:[...n,e];return a||i(n),null==a||a(n,e,t,s),n},isSelected:c}}(e,t),a=av(e,t);switch(e.mode){case"single":return s;case"multiple":return r;case"range":return a;default:return}}function iv(e){var t;let s=e;s.timeZone&&(s={...e},s.today&&(s.today=new sx(s.today,s.timeZone)),s.month&&(s.month=new sx(s.month,s.timeZone)),s.defaultMonth&&(s.defaultMonth=new sx(s.defaultMonth,s.timeZone)),s.startMonth&&(s.startMonth=new sx(s.startMonth,s.timeZone)),s.endMonth&&(s.endMonth=new sx(s.endMonth,s.timeZone)),"single"===s.mode&&s.selected?s.selected=new sx(s.selected,s.timeZone):"multiple"===s.mode&&s.selected?s.selected=null==(t=s.selected)?void 0:t.map(e=>new sx(e,s.timeZone)):"range"===s.mode&&s.selected&&(s.selected={from:s.selected.from?new sx(s.selected.from,s.timeZone):void 0,to:s.selected.to?new sx(s.selected.to,s.timeZone):void 0}));const{components:r,formatters:a,labels:n,dateLib:i,locale:o,classNames:l}=Ke.useMemo(()=>{const e={...Fx,...s.locale};return{dateLib:new xg({locale:e,weekStartsOn:s.broadcastCalendar?1:s.weekStartsOn,firstWeekContainsDate:s.firstWeekContainsDate,useAdditionalWeekYearTokens:s.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:s.useAdditionalDayOfYearTokens,timeZone:s.timeZone,numerals:s.numerals},s.dateLib),components:(r=s.components,{...Pg,...r}),formatters:(t=s.formatters,(null==t?void 0:t.formatMonthCaption)&&!t.formatCaption&&(t.formatCaption=t.formatMonthCaption),(null==t?void 0:t.formatYearCaption)&&!t.formatYearDropdown&&(t.formatYearDropdown=t.formatYearCaption),{...Lg,...t}),labels:{...Wg,...s.labels},locale:e,classNames:{...Ag(),...s.classNames}};var t,r},[s.locale,s.broadcastCalendar,s.weekStartsOn,s.firstWeekContainsDate,s.useAdditionalWeekYearTokens,s.useAdditionalDayOfYearTokens,s.timeZone,s.numerals,s.dateLib,s.components,s.formatters,s.labels,s.classNames]),{captionLayout:c,mode:d,navLayout:u,numberOfMonths:h=1,onDayBlur:m,onDayClick:p,onDayFocus:f,onDayKeyDown:x,onDayMouseEnter:g,onDayMouseLeave:v,onNextClick:y,onPrevClick:j,showWeekNumber:b,styles:w}=s,{formatCaption:N,formatDay:_,formatMonthDropdown:k,formatWeekNumber:S,formatWeekNumberHeader:C,formatWeekdayName:T,formatYearDropdown:E}=a,M=Jg(s,i),{days:P,months:A,navStart:D,navEnd:O,previousMonth:R,nextMonth:I,goToMonth:L}=M,q=function(e,t,s,r,a){const{disabled:n,hidden:i,modifiers:o,showOutsideDays:l,broadcastCalendar:c,today:d}=t,{isSameDay:u,isSameMonth:h,startOfMonth:m,isBefore:p,endOfMonth:f,isAfter:x}=a,g=s&&m(s),v=r&&f(r),y={[nx.focused]:[],[nx.outside]:[],[nx.disabled]:[],[nx.hidden]:[],[nx.today]:[]},j={};for(const b of e){const{date:e,displayMonth:t}=b,s=Boolean(t&&!h(e,t)),r=Boolean(g&&p(e,g)),m=Boolean(v&&x(e,v)),f=Boolean(n&&Tg(e,n,a)),w=Boolean(i&&Tg(e,i,a))||r||m||!c&&!l&&s||c&&!1===l&&s,N=u(e,d??a.today());s&&y.outside.push(b),f&&y.disabled.push(b),w&&y.hidden.push(b),N&&y.today.push(b),o&&Object.keys(o).forEach(t=>{const s=null==o?void 0:o[t];s&&Tg(e,s,a)&&(j[t]?j[t].push(b):j[t]=[b])})}return e=>{const t={[nx.focused]:!1,[nx.disabled]:!1,[nx.hidden]:!1,[nx.outside]:!1,[nx.today]:!1},s={};for(const r in y){const s=y[r];t[r]=s.some(t=>t===e)}for(const r in j)s[r]=j[r].some(t=>t===e);return{...t,...s}}}(P,s,D,O,i),{isSelected:F,select:z,selected:$}=nv(s,i)??{},{blur:W,focused:U,isFocusTarget:V,moveFocus:B,setFocused:H}=tv(s,M,q,F??(()=>!1),i),{labelDayButton:Y,labelGridcell:G,labelGrid:K,labelMonthDropdown:J,labelNav:Q,labelPrevious:X,labelNext:Z,labelWeekday:ee,labelWeekNumber:te,labelWeekNumberHeader:se,labelYearDropdown:re}=n,ae=Ke.useMemo(()=>function(e,t){const s=e.today(),r=t?e.startOfISOWeek(s):e.startOfWeek(s),a=[];for(let n=0;n<7;n++){const t=e.addDays(r,n);a.push(t)}return a}(i,s.ISOWeek),[i,s.ISOWeek]),ne=void 0!==d||void 0!==p,ie=Ke.useCallback(()=>{R&&(L(R),null==j||j(R))},[R,L,j]),oe=Ke.useCallback(()=>{I&&(L(I),null==y||y(I))},[L,I,y]),le=Ke.useCallback((e,t)=>s=>{s.preventDefault(),s.stopPropagation(),H(e),null==z||z(e.date,t,s),null==p||p(e.date,t,s)},[z,p,H]),ce=Ke.useCallback((e,t)=>s=>{H(e),null==f||f(e.date,t,s)},[f,H]),de=Ke.useCallback((e,t)=>s=>{W(),null==m||m(e.date,t,s)},[W,m]),ue=Ke.useCallback((e,t)=>r=>{const a={ArrowLeft:[r.shiftKey?"month":"day","rtl"===s.dir?"after":"before"],ArrowRight:[r.shiftKey?"month":"day","rtl"===s.dir?"before":"after"],ArrowDown:[r.shiftKey?"year":"week","after"],ArrowUp:[r.shiftKey?"year":"week","before"],PageUp:[r.shiftKey?"year":"month","before"],PageDown:[r.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(a[r.key]){r.preventDefault(),r.stopPropagation();const[e,t]=a[r.key];B(e,t)}null==x||x(e.date,t,r)},[B,x,s.dir]),he=Ke.useCallback((e,t)=>s=>{null==g||g(e.date,t,s)},[g]),me=Ke.useCallback((e,t)=>s=>{null==v||v(e.date,t,s)},[v]),pe=Ke.useCallback(e=>t=>{const s=Number(t.target.value),r=i.setMonth(i.startOfMonth(e),s);L(r)},[i,L]),fe=Ke.useCallback(e=>t=>{const s=Number(t.target.value),r=i.setYear(i.startOfMonth(e),s);L(r)},[i,L]),{className:xe,style:ge}=Ke.useMemo(()=>({className:[l[rx.Root],s.className].filter(Boolean).join(" "),style:{...null==w?void 0:w[rx.Root],...s.style}}),[l,s.className,s.style,w]),ve=function(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([e,s])=>{e.startsWith("data-")&&(t[e]=s)}),t}(s),ye=Ke.useRef(null);Yg(ye,Boolean(s.animate),{classNames:l,months:A,focused:U,dateLib:i});const je={dayPickerProps:s,selected:$,select:z,isSelected:F,months:A,nextMonth:I,previousMonth:R,goToMonth:L,getModifiers:q,components:r,classNames:l,styles:w,labels:n,formatters:a};return Je.createElement(Eg.Provider,{value:je},Je.createElement(r.Root,{rootRef:s.animate?ye:void 0,className:xe,style:ge,dir:s.dir,id:s.id,lang:s.lang,nonce:s.nonce,title:s.title,role:s.role,"aria-label":s["aria-label"],...ve},Je.createElement(r.Months,{className:l[rx.Months],style:null==w?void 0:w[rx.Months]},!s.hideNavigation&&!u&&Je.createElement(r.Nav,{"data-animated-nav":s.animate?"true":void 0,className:l[rx.Nav],style:null==w?void 0:w[rx.Nav],"aria-label":Q(),onPreviousClick:ie,onNextClick:oe,previousMonth:R,nextMonth:I}),A.map((e,t)=>{const n=function(e,t,s,r,a){const{startOfMonth:n,startOfYear:i,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=a;return l({start:i(e),end:o(e)}).map(e=>{const i=r.formatMonthDropdown(e,a);return{value:c(e),label:i,disabled:t&&e<n(t)||s&&e>n(s)||!1}})}(e.date,D,O,a,i),m=function(e,t,s,r){if(!e)return;if(!t)return;const{startOfYear:a,endOfYear:n,addYears:i,getYear:o,isBefore:l,isSameYear:c}=r,d=a(e),u=n(t),h=[];let m=d;for(;l(m,u)||c(m,u);)h.push(m),m=i(m,1);return h.map(e=>{const t=s.formatYearDropdown(e,r);return{value:o(e),label:t,disabled:!1}})}(D,O,a,i);return Je.createElement(r.Month,{"data-animated-month":s.animate?"true":void 0,className:l[rx.Month],style:null==w?void 0:w[rx.Month],key:t,displayIndex:t,calendarMonth:e},"around"===u&&!s.hideNavigation&&0===t&&Je.createElement(r.PreviousMonthButton,{type:"button",className:l[rx.PreviousMonthButton],tabIndex:R?void 0:-1,"aria-disabled":!R||void 0,"aria-label":X(R),onClick:ie,"data-animated-button":s.animate?"true":void 0},Je.createElement(r.Chevron,{disabled:!R||void 0,className:l[rx.Chevron],orientation:"rtl"===s.dir?"right":"left"})),Je.createElement(r.MonthCaption,{"data-animated-caption":s.animate?"true":void 0,className:l[rx.MonthCaption],style:null==w?void 0:w[rx.MonthCaption],calendarMonth:e,displayIndex:t},(null==c?void 0:c.startsWith("dropdown"))?Je.createElement(r.DropdownNav,{className:l[rx.Dropdowns],style:null==w?void 0:w[rx.Dropdowns]},"dropdown"===c||"dropdown-months"===c?Je.createElement(r.MonthsDropdown,{className:l[rx.MonthsDropdown],"aria-label":J(),classNames:l,components:r,disabled:Boolean(s.disableNavigation),onChange:pe(e.date),options:n,style:null==w?void 0:w[rx.Dropdown],value:i.getMonth(e.date)}):Je.createElement("span",null,k(e.date,i)),"dropdown"===c||"dropdown-years"===c?Je.createElement(r.YearsDropdown,{className:l[rx.YearsDropdown],"aria-label":re(i.options),classNames:l,components:r,disabled:Boolean(s.disableNavigation),onChange:fe(e.date),options:m,style:null==w?void 0:w[rx.Dropdown],value:i.getYear(e.date)}):Je.createElement("span",null,E(e.date,i)),Je.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},N(e.date,i.options,i))):Je.createElement(r.CaptionLabel,{className:l[rx.CaptionLabel],role:"status","aria-live":"polite"},N(e.date,i.options,i))),"around"===u&&!s.hideNavigation&&t===h-1&&Je.createElement(r.NextMonthButton,{type:"button",className:l[rx.NextMonthButton],tabIndex:I?void 0:-1,"aria-disabled":!I||void 0,"aria-label":Z(I),onClick:oe,"data-animated-button":s.animate?"true":void 0},Je.createElement(r.Chevron,{disabled:!I||void 0,className:l[rx.Chevron],orientation:"rtl"===s.dir?"left":"right"})),t===h-1&&"after"===u&&!s.hideNavigation&&Je.createElement(r.Nav,{"data-animated-nav":s.animate?"true":void 0,className:l[rx.Nav],style:null==w?void 0:w[rx.Nav],"aria-label":Q(),onPreviousClick:ie,onNextClick:oe,previousMonth:R,nextMonth:I}),Je.createElement(r.MonthGrid,{role:"grid","aria-multiselectable":"multiple"===d||"range"===d,"aria-label":K(e.date,i.options,i)||void 0,className:l[rx.MonthGrid],style:null==w?void 0:w[rx.MonthGrid]},!s.hideWeekdays&&Je.createElement(r.Weekdays,{"data-animated-weekdays":s.animate?"true":void 0,className:l[rx.Weekdays],style:null==w?void 0:w[rx.Weekdays]},b&&Je.createElement(r.WeekNumberHeader,{"aria-label":se(i.options),className:l[rx.WeekNumberHeader],style:null==w?void 0:w[rx.WeekNumberHeader],scope:"col"},C()),ae.map((e,t)=>Je.createElement(r.Weekday,{"aria-label":ee(e,i.options,i),className:l[rx.Weekday],key:t,style:null==w?void 0:w[rx.Weekday],scope:"col"},T(e,i.options,i)))),Je.createElement(r.Weeks,{"data-animated-weeks":s.animate?"true":void 0,className:l[rx.Weeks],style:null==w?void 0:w[rx.Weeks]},e.weeks.map((e,t)=>Je.createElement(r.Week,{className:l[rx.Week],key:e.weekNumber,style:null==w?void 0:w[rx.Week],week:e},b&&Je.createElement(r.WeekNumber,{week:e,style:null==w?void 0:w[rx.WeekNumber],"aria-label":te(e.weekNumber,{locale:o}),className:l[rx.WeekNumber],scope:"row",role:"rowheader"},S(e.weekNumber,i)),e.days.map(e=>{const{date:t}=e,a=q(e);if(a[nx.focused]=!a.hidden&&Boolean(null==U?void 0:U.isEqualTo(e)),a[ox.selected]=(null==F?void 0:F(t))||a.selected,Ng($)){const{from:e,to:s}=$;a[ox.range_start]=Boolean(e&&s&&i.isSameDay(t,e)),a[ox.range_end]=Boolean(e&&s&&i.isSameDay(t,s)),a[ox.range_middle]=bg($,t,!0,i)}const n=function(e,t={},s={}){let r={...null==t?void 0:t[rx.Day]};return Object.entries(e).filter(([,e])=>!0===e).forEach(([e])=>{r={...r,...null==s?void 0:s[e]}}),r}(a,w,s.modifiersStyles),o=function(e,t,s={}){return Object.entries(e).filter(([,e])=>!0===e).reduce((e,[r])=>(s[r]?e.push(s[r]):t[nx[r]]?e.push(t[nx[r]]):t[ox[r]]&&e.push(t[ox[r]]),e),[t[rx.Day]])}(a,l,s.modifiersClassNames),c=ne||a.hidden?void 0:G(t,a,i.options,i);return Je.createElement(r.Day,{key:`${i.format(t,"yyyy-MM-dd")}_${i.format(e.displayMonth,"yyyy-MM")}`,day:e,modifiers:a,className:o.join(" "),style:n,role:"gridcell","aria-selected":a.selected||void 0,"aria-label":c,"data-day":i.format(t,"yyyy-MM-dd"),"data-month":e.outside?i.format(t,"yyyy-MM"):void 0,"data-selected":a.selected||void 0,"data-disabled":a.disabled||void 0,"data-hidden":a.hidden||void 0,"data-outside":e.outside||void 0,"data-focused":a.focused||void 0,"data-today":a.today||void 0},!a.hidden&&ne?Je.createElement(r.DayButton,{className:l[rx.DayButton],style:null==w?void 0:w[rx.DayButton],type:"button",day:e,modifiers:a,disabled:a.disabled||void 0,tabIndex:V(e)?0:-1,"aria-label":Y(t,a,i.options,i),onClick:le(e,a),onBlur:de(e,a),onFocus:ce(e,a),onKeyDown:ue(e,a),onMouseEnter:he(e,a),onMouseLeave:me(e,a)},_(t,i.options,i)):!a.hidden&&_(e.date,i.options,i))}))))))})),s.footer&&Je.createElement(r.Footer,{className:l[rx.Footer],style:null==w?void 0:w[rx.Footer],role:"status","aria-live":"polite"},s.footer)))}function ov({className:e,classNames:t,showOutsideDays:s=!0,...r}){return K.jsx(iv,{showOutsideDays:s,className:Aa("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Aa(Bu({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Aa(Bu({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...e})=>K.jsx(zs,{className:"h-4 w-4"}),IconRight:({...e})=>K.jsx($s,{className:"h-4 w-4"})},...r})}(Xg=Qg||(Qg={}))[Xg.Today=0]="Today",Xg[Xg.Selected=1]="Selected",Xg[Xg.LastFocused=2]="LastFocused",Xg[Xg.FocusedModifier=3]="FocusedModifier",ov.displayName="Calendar";var lv="Popover",[cv,dv]=Q(lv,[ce]),uv=ce(),[hv,mv]=cv(lv),pv=e=>{const{__scopePopover:t,children:s,open:r,defaultOpen:a,onOpenChange:n,modal:i=!1}=e,o=uv(t),l=Ke.useRef(null),[c,d]=Ke.useState(!1),[u,h]=te({prop:r,defaultProp:a??!1,onChange:n,caller:lv});return K.jsx(pe,{...o,children:K.jsx(hv,{scope:t,contentId:me(),triggerRef:l,open:u,onOpenChange:h,onOpenToggle:Ke.useCallback(()=>h(e=>!e),[h]),hasCustomAnchor:c,onCustomAnchorAdd:Ke.useCallback(()=>d(!0),[]),onCustomAnchorRemove:Ke.useCallback(()=>d(!1),[]),modal:i,children:s})})};pv.displayName=lv;var fv="PopoverAnchor";Ke.forwardRef((e,t)=>{const{__scopePopover:s,...r}=e,a=mv(fv,s),n=uv(s),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=a;return Ke.useEffect(()=>(i(),()=>o()),[i,o]),K.jsx(fe,{...n,...r,ref:t})}).displayName=fv;var xv="PopoverTrigger",gv=Ke.forwardRef((e,t)=>{const{__scopePopover:s,...r}=e,a=mv(xv,s),n=uv(s),i=Z(t,a.triggerRef),o=K.jsx(J.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Ev(a.open),...r,ref:i,onClick:re(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:K.jsx(fe,{asChild:!0,...n,children:o})});gv.displayName=xv;var vv="PopoverPortal",[yv,jv]=cv(vv,{forceMount:void 0}),bv=e=>{const{__scopePopover:t,forceMount:s,children:r,container:a}=e,n=mv(vv,t);return K.jsx(yv,{scope:t,forceMount:s,children:K.jsx(se,{present:s||n.open,children:K.jsx(ie,{asChild:!0,container:a,children:r})})})};bv.displayName=vv;var wv="PopoverContent",Nv=Ke.forwardRef((e,t)=>{const s=jv(wv,e.__scopePopover),{forceMount:r=s.forceMount,...a}=e,n=mv(wv,e.__scopePopover);return K.jsx(se,{present:r||n.open,children:n.modal?K.jsx(kv,{...a,ref:t}):K.jsx(Sv,{...a,ref:t})})});Nv.displayName=wv;var _v=$e("PopoverContent.RemoveScroll"),kv=Ke.forwardRef((e,t)=>{const s=mv(wv,e.__scopePopover),r=Ke.useRef(null),a=Z(t,r),n=Ke.useRef(!1);return Ke.useEffect(()=>{const e=r.current;if(e)return qe(e)},[]),K.jsx(ze,{as:_v,allowPinchZoom:!0,children:K.jsx(Cv,{...e,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:re(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),n.current||null==(t=s.triggerRef.current)||t.focus()}),onPointerDownOutside:re(e.onPointerDownOutside,e=>{const t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey,r=2===t.button||s;n.current=r},{checkForDefaultPrevented:!1}),onFocusOutside:re(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),Sv=Ke.forwardRef((e,t)=>{const s=mv(wv,e.__scopePopover),r=Ke.useRef(!1),a=Ke.useRef(!1);return K.jsx(Cv,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var n,i;null==(n=e.onCloseAutoFocus)||n.call(e,t),t.defaultPrevented||(r.current||null==(i=s.triggerRef.current)||i.focus(),t.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:t=>{var n,i;null==(n=e.onInteractOutside)||n.call(e,t),t.defaultPrevented||(r.current=!0,"pointerdown"===t.detail.originalEvent.type&&(a.current=!0));const o=t.target;(null==(i=s.triggerRef.current)?void 0:i.contains(o))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&a.current&&t.preventDefault()}})}),Cv=Ke.forwardRef((e,t)=>{const{__scopePopover:s,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:n,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:d,...u}=e,h=mv(wv,s),m=uv(s);return Fe(),K.jsx(We,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:n,children:K.jsx(de,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:d,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:K.jsx(ue,{"data-state":Ev(h.open),role:"dialog",id:h.contentId,...m,...u,ref:t,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Tv="PopoverClose";Ke.forwardRef((e,t)=>{const{__scopePopover:s,...r}=e,a=mv(Tv,s);return K.jsx(J.button,{type:"button",...r,ref:t,onClick:re(e.onClick,()=>a.onOpenChange(!1))})}).displayName=Tv;function Ev(e){return e?"open":"closed"}Ke.forwardRef((e,t)=>{const{__scopePopover:s,...r}=e,a=uv(s);return K.jsx(xe,{...a,...r,ref:t})}).displayName="PopoverArrow";var Mv=bv,Pv=Nv;const Av=pv,Dv=gv,Ov=Ke.forwardRef(({className:e,align:t="center",sideOffset:s=4,...r},a)=>K.jsx(Mv,{children:K.jsx(Pv,{ref:a,align:t,sideOffset:s,className:Aa("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));function Rv({isOpen:e,onClose:t,onSuccess:s,product:r}){const{toast:a}=At(),[n,i]=Ke.useState(!1),[o,l]=Ke.useState([]),[c,d]=Ke.useState([]),[u,h]=Ke.useState(),[m,p]=Ke.useState({}),[f,x]=Ke.useState({name:"",description:"",sku:"",category_id:"",unit_id:"",current_sale_price:"",min_sale_price:"",alert_stock:"10",tax_rate:"0",expiration_date:""});Ke.useEffect(()=>{var t,s,a,n;e&&(v(),y(),g(),r?(x({name:r.name||"",description:r.description||"",sku:r.sku||"",category_id:r.category_id||"",unit_id:r.unit_id||"",current_sale_price:(null==(t=r.current_sale_price)?void 0:t.toString())||"",min_sale_price:(null==(s=r.min_sale_price)?void 0:s.toString())||"",alert_stock:(null==(a=r.alert_stock)?void 0:a.toString())||"10",tax_rate:(null==(n=r.tax_rate)?void 0:n.toString())||"0",expiration_date:r.expiry_date||""}),r.expiry_date&&h(new Date(r.expiry_date))):j())},[e,r]);const g=()=>{x({name:"",description:"",sku:"",category_id:"",unit_id:"",current_sale_price:"",min_sale_price:"",alert_stock:"10",tax_rate:"0",expiration_date:""}),h(void 0),p({})},v=async()=>{try{const{data:e,error:t}=await Fu.from("categories").select("*").eq("is_active",!0).order("name");if(t)throw t;l(e||[])}catch(e){a({title:"Erreur",description:"Impossible de charger les catgories",variant:"destructive"})}},y=async()=>{try{const{data:e,error:t}=await Fu.from("units").select("*").eq("is_active",!0).order("name");if(t)throw t;d(e||[])}catch(e){a({title:"Erreur",description:"Impossible de charger les units",variant:"destructive"})}},j=()=>{const e=Date.now().toString().slice(-6),t=Math.floor(1e3*Math.random()).toString().padStart(3,"0");x(s=>({...s,sku:`PRD-${e}${t}`}))},b=()=>{g(),t()};return K.jsx(lp,{open:e,onOpenChange:b,children:K.jsxs(hp,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[K.jsxs(mp,{children:[K.jsx(fp,{children:r?"Modifier le produit":"Nouveau produit"}),K.jsx(xp,{children:r?"Modifiez les informations du produit":"Ajoutez un nouveau produit  votre catalogue"})]}),K.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};f.name.trim()?f.name.trim().length<2&&(e.name="Le nom doit contenir au moins 2 caractres"):e.name="Le nom du produit est obligatoire",f.sku.trim()?f.sku.trim().length<3&&(e.sku="Le SKU doit contenir au moins 3 caractres"):e.sku="Le SKU est obligatoire",f.category_id||(e.category_id="La catgorie est obligatoire"),f.unit_id||(e.unit_id="L'unit est obligatoire");const t=parseFloat(f.current_sale_price),s=parseFloat(f.min_sale_price);(!Hf(t)||t<=0)&&(e.current_sale_price="Le prix actuel doit tre suprieur  0"),(!Hf(s)||s<=0)&&(e.min_sale_price="Le prix minimum doit tre suprieur  0"),t<s&&(e.current_sale_price="Le prix actuel ne peut pas tre infrieur au prix minimum"),t>3*s&&(e.current_sale_price="Le prix actuel ne peut pas dpasser 3x le prix minimum"),parseInt(f.alert_stock)<0&&(e.alert_stock="Le stock d'alerte ne peut pas tre ngatif");const r=parseFloat(f.tax_rate);return(r<0||r>100)&&(e.tax_rate="Le taux de taxe doit tre entre 0 et 100"),u&&u<new Date&&(e.expiration_date="La date d'expiration ne peut pas tre dans le pass"),p(e),0===Object.keys(e).length})()){i(!0);try{if(!(await(async(e,t)=>{try{let s=Fu.from("products").select("id").eq("sku",e);t&&(s=s.neq("id",t));const{data:r,error:a}=await s;if(a)throw a;return 0===(r||[]).length}catch(s){return!1}})(f.sku,null==r?void 0:r.id)))return p(e=>({...e,sku:"Ce SKU existe dj"})),void a({title:"Erreur",description:"Ce SKU existe dj, veuillez en choisir un autre",variant:"destructive"});const e=parseFloat(f.current_sale_price),n=parseFloat(f.min_sale_price),i=parseInt(f.alert_stock),o=parseFloat(f.tax_rate),l=(e=>{const t={...e};return Object.keys(t).forEach(e=>{void 0!==t[e]&&null!==t[e]||delete t[e]}),t})({...f,current_sale_price:e,min_sale_price:n,alert_stock:i,tax_rate:o,expiration_date:u?Km(u,"yyyy-MM-dd"):null,category_id:f.category_id||null,unit_id:f.unit_id||null});if(r){const{error:e}=await Fu.from("products").update(l).eq("id",r.id);if(e){const t=Uf(e);throw new Error(t.error)}a({title:"Succs",description:"Produit modifi avec succs"})}else{const{error:e}=await Fu.from("products").insert([l]);if(e){const t=Uf(e);throw new Error(t.error)}a({title:"Succs",description:"Produit cr avec succs"})}s(),t(),g()}catch(n){a({title:"Erreur",description:n instanceof Error?n.message:"Une erreur est survenue lors de l'enregistrement",variant:"destructive"})}finally{i(!1)}}else a({title:"Erreur de validation",description:"Veuillez corriger les erreurs dans le formulaire",variant:"destructive"})},className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"name",children:"Nom du produit *"}),K.jsx(Yu,{id:"name",value:f.name,onChange:e=>x(t=>({...t,name:e.target.value})),className:m.name?"border-destructive":""}),m.name&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.name]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"category",children:"Catgorie *"}),K.jsxs(If,{value:f.category_id,onValueChange:e=>x(t=>({...t,category_id:e})),children:[K.jsx(qf,{className:m.category_id?"border-destructive":"",children:K.jsx(Lf,{placeholder:"Slectionner une catgorie"})}),K.jsx($f,{children:o.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]}),m.category_id&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.category_id]})]})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"sku",children:"SKU *"}),K.jsxs("div",{className:"flex gap-2",children:[K.jsx(Yu,{id:"sku",value:f.sku,onChange:e=>x(t=>({...t,sku:e.target.value})),className:m.sku?"border-destructive":""}),K.jsx(Hu,{type:"button",variant:"outline",size:"icon",onClick:j,children:K.jsx(Gs,{className:"w-4 h-4"})})]}),m.sku&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.sku]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"unit",children:"Unit *"}),K.jsxs(If,{value:f.unit_id,onValueChange:e=>x(t=>({...t,unit_id:e})),children:[K.jsx(qf,{className:m.unit_id?"border-destructive":"",children:K.jsx(Lf,{placeholder:"Slectionner une unit"})}),K.jsx($f,{children:c.map(e=>K.jsxs(Wf,{value:e.id,children:[e.name," (",e.symbol,")"]},e.id))})]}),m.unit_id&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.unit_id]})]})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"current_price",children:"Prix actuel (XOF) *"}),K.jsx(Yu,{id:"current_price",type:"number",step:"0.01",value:f.current_sale_price,onChange:e=>x(t=>({...t,current_sale_price:e.target.value})),className:m.current_sale_price?"border-destructive":""}),m.current_sale_price&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.current_sale_price]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"min_price",children:"Prix minimum (XOF) *"}),K.jsx(Yu,{id:"min_price",type:"number",step:"0.01",value:f.min_sale_price,onChange:e=>x(t=>({...t,min_sale_price:e.target.value})),className:m.min_sale_price?"border-destructive":""}),m.min_sale_price&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.min_sale_price]})]})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"alert_stock",children:"Stock d'alerte"}),K.jsx(Yu,{id:"alert_stock",type:"number",value:f.alert_stock,onChange:e=>x(t=>({...t,alert_stock:e.target.value})),className:m.alert_stock?"border-destructive":""}),m.alert_stock&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.alert_stock]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"tax_rate",children:"Taux de taxe (%)"}),K.jsx(Yu,{id:"tax_rate",type:"number",step:"0.01",value:f.tax_rate,onChange:e=>x(t=>({...t,tax_rate:e.target.value})),className:m.tax_rate?"border-destructive":""}),m.tax_rate&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.tax_rate]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Date d'expiration (optionnelle)"}),K.jsxs(Av,{children:[K.jsx(Dv,{asChild:!0,children:K.jsxs(Hu,{variant:"outline",className:"w-full justify-start text-left font-normal "+(m.expiration_date?"border-destructive":""),children:[K.jsx(Rs,{className:"mr-2 h-4 w-4"}),u?Km(u,"dd/MM/yyyy"):"Slectionner une date"]})}),K.jsx(Ov,{className:"w-auto p-0",children:K.jsx(ov,{mode:"single",selected:u,onSelect:h,initialFocus:!0})})]}),m.expiration_date&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),m.expiration_date]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"description",children:"Description"}),K.jsx(gp,{id:"description",value:f.description,onChange:e=>x(t=>({...t,description:e.target.value})),rows:3})]}),K.jsxs(pp,{children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:b,children:"Annuler"}),K.jsx(Hu,{type:"submit",disabled:n,children:n?"Enregistrement...":r?"Modifier":"Crer"})]})]})]})})}function Iv({isOpen:e,onClose:t,onSuccess:s,category:r}){const{toast:a}=At(),[n,i]=Ke.useState(!1),[o,l]=Ke.useState({}),[c,d]=Ke.useState({name:"",description:""});Ke.useEffect(()=>{e&&r?d({name:r.name||"",description:r.description||""}):e&&d({name:"",description:""}),l({})},[e,r]);const u=()=>{l({}),t()};return K.jsx(lp,{open:e,onOpenChange:u,children:K.jsxs(hp,{className:"max-w-md",children:[K.jsxs(mp,{children:[K.jsx(fp,{children:r?"Modifier la catgorie":"Nouvelle catgorie"}),K.jsx(xp,{children:r?"Modifiez les informations de la catgorie":"Ajoutez une nouvelle catgorie de produits"})]}),K.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return c.name.trim()?c.name.trim().length<2?e.name="Le nom doit contenir au moins 2 caractres":c.name.trim().length>50&&(e.name="Le nom ne peut pas dpasser 50 caractres"):e.name="Le nom de la catgorie est obligatoire",c.description&&c.description.length>200&&(e.description="La description ne peut pas dpasser 200 caractres"),l(e),0===Object.keys(e).length})()){i(!0);try{if(!(await(async(e,t)=>{try{let s=Fu.from("categories").select("id").eq("name",e.trim());t&&(s=s.neq("id",t));const{data:r,error:a}=await s;if(a)throw a;return 0===(r||[]).length}catch(s){return!1}})(c.name,null==r?void 0:r.id)))return l(e=>({...e,name:"Ce nom de catgorie existe dj"})),void a({title:"Erreur",description:"Ce nom de catgorie existe dj, veuillez en choisir un autre",variant:"destructive"});const e={name:c.name.trim(),description:c.description.trim()||null};if(r){const{error:t}=await Fu.from("categories").update(e).eq("id",r.id);if(t)throw t;a({title:"Succs",description:"Catgorie modifie avec succs"})}else{const{error:t}=await Fu.from("categories").insert([e]);if(t)throw t;a({title:"Succs",description:"Catgorie cre avec succs"})}s(),t()}catch(n){a({title:"Erreur",description:n instanceof Error?n.message:"Une erreur est survenue lors de l'enregistrement",variant:"destructive"})}finally{i(!1)}}else a({title:"Erreur de validation",description:"Veuillez corriger les erreurs dans le formulaire",variant:"destructive"})},className:"space-y-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"name",children:"Nom de la catgorie *"}),K.jsx(Yu,{id:"name",value:c.name,onChange:e=>d(t=>({...t,name:e.target.value})),className:o.name?"border-destructive":"",placeholder:"Ex: lectronique, Vtements..."}),o.name&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),o.name]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"description",children:"Description"}),K.jsx(gp,{id:"description",value:c.description,onChange:e=>d(t=>({...t,description:e.target.value})),rows:3,className:o.description?"border-destructive":"",placeholder:"Description optionnelle de la catgorie..."}),o.description&&K.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),o.description]}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[c.description.length,"/200 caractres"]})]}),K.jsxs(pp,{children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:u,children:"Annuler"}),K.jsx(Hu,{type:"submit",disabled:n,children:n?"Enregistrement...":r?"Modifier":"Crer"})]})]})]})})}Ov.displayName=Pv.displayName;var Lv="Tabs",[qv,Fv]=Q(Lv,[Ve]),zv=Ve(),[$v,Wv]=qv(Lv),Uv=Ke.forwardRef((e,t)=>{const{__scopeTabs:s,value:r,onValueChange:a,defaultValue:n,orientation:i="horizontal",dir:o,activationMode:l="automatic",...c}=e,d=Ue(o),[u,h]=te({prop:r,onChange:a,defaultProp:n??"",caller:Lv});return K.jsx($v,{scope:s,baseId:me(),value:u,onValueChange:h,orientation:i,dir:d,activationMode:l,children:K.jsx(J.div,{dir:d,"data-orientation":i,...c,ref:t})})});Uv.displayName=Lv;var Vv="TabsList",Bv=Ke.forwardRef((e,t)=>{const{__scopeTabs:s,loop:r=!0,...a}=e,n=Wv(Vv,s),i=zv(s);return K.jsx(Be,{asChild:!0,...i,orientation:n.orientation,dir:n.dir,loop:r,children:K.jsx(J.div,{role:"tablist","aria-orientation":n.orientation,...a,ref:t})})});Bv.displayName=Vv;var Hv="TabsTrigger",Yv=Ke.forwardRef((e,t)=>{const{__scopeTabs:s,value:r,disabled:a=!1,...n}=e,i=Wv(Hv,s),o=zv(s),l=Jv(i.baseId,r),c=Qv(i.baseId,r),d=r===i.value;return K.jsx(He,{asChild:!0,...o,focusable:!a,active:d,children:K.jsx(J.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":c,"data-state":d?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...n,ref:t,onMouseDown:re(e.onMouseDown,e=>{a||0!==e.button||!1!==e.ctrlKey?e.preventDefault():i.onValueChange(r)}),onKeyDown:re(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&i.onValueChange(r)}),onFocus:re(e.onFocus,()=>{const e="manual"!==i.activationMode;d||a||!e||i.onValueChange(r)})})})});Yv.displayName=Hv;var Gv="TabsContent",Kv=Ke.forwardRef((e,t)=>{const{__scopeTabs:s,value:r,forceMount:a,children:n,...i}=e,o=Wv(Gv,s),l=Jv(o.baseId,r),c=Qv(o.baseId,r),d=r===o.value,u=Ke.useRef(d);return Ke.useEffect(()=>{const e=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(e)},[]),K.jsx(se,{present:a||d,children:({present:s})=>K.jsx(J.div,{"data-state":d?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!s,id:c,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0},children:s&&n})})});function Jv(e,t){return`${e}-trigger-${t}`}function Qv(e,t){return`${e}-content-${t}`}Kv.displayName=Gv;var Xv=Bv,Zv=Yv,ey=Kv;const ty=Uv,sy=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Xv,{ref:s,className:Aa("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));sy.displayName=Xv.displayName;const ry=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Zv,{ref:s,className:Aa("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ry.displayName=Zv.displayName;const ay=Ke.forwardRef(({className:e,...t},s)=>K.jsx(ey,{ref:s,className:Aa("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));function ny(){const{formatAmount:e}=Hh(),{toast:t}=At(),{userProfile:s}=Uu(),[r,a]=Ke.useState(""),[n,i]=Ke.useState(""),[o,l]=Ke.useState([]),[c,d]=Ke.useState([]),[u,h]=Ke.useState(!0),[m,p]=Ke.useState(!0),[f,x]=Ke.useState(!1),[g,v]=Ke.useState(!1),[y,j]=Ke.useState(null),[b,w]=Ke.useState("products"),[N,_]=Ke.useState(null),k=(null==s?void 0:s.role)&&["Admin","SuperAdmin","Manager"].includes(s.role),S=(null==s?void 0:s.role)&&["Admin","SuperAdmin","Manager"].includes(s.role),C=(null==s?void 0:s.role)&&["Admin","SuperAdmin"].includes(s.role),T=(null==s?void 0:s.role)&&["Admin","SuperAdmin"].includes(s.role),E=(null==s?void 0:s.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(s.role);Ke.useEffect(()=>{E&&M(),P()},[E]);const M=async()=>{try{h(!0),_(null);const{data:e,error:s}=await Fu.from("products").select("\n          *,\n          categories(name),\n          units(name, symbol),\n          product_stores(\n            current_stock,\n            min_stock,\n            max_stock,\n            stores(name)\n          )\n        ").order("created_at",{ascending:!1});if(s){if("42501"!==s.code)throw s;return _("Vous n'avez pas les permissions pour voir les produits"),void t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour voir les produits",variant:"destructive"})}l(e||[])}catch(e){_("Impossible de charger les produits"),t({title:"Erreur",description:"Impossible de charger les produits",variant:"destructive"})}finally{h(!1)}},P=async()=>{try{p(!0);const{data:e,error:t}=await Fu.from("categories").select("id, name, description").order("name",{ascending:!0});if(t)throw t;d(e||[])}catch(e){t({title:"Erreur",description:"Impossible de charger les catgories",variant:"destructive"})}finally{p(!1)}},A=()=>{k?(j(null),x(!0)):t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour ajouter des produits",variant:"destructive"})},D=()=>{k?v(!0):t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour ajouter des catgories",variant:"destructive"})},O=o.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())||e.sku.toLowerCase().includes(r.toLowerCase())),R=o.reduce((e,t)=>(t.category_id&&(e[t.category_id]=(e[t.category_id]||0)+1),e),{}),I=c.filter(e=>e.name.toLowerCase().includes(n.toLowerCase()));return N&&!E?K.jsxs("div",{className:"space-y-6",children:[K.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:K.jsxs("div",{children:[K.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Produits"}),K.jsx("p",{className:"text-muted-foreground",children:"Grez vos produits et catgories"})]})}),K.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Accs refus"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:"Vous n'avez pas les permissions pour accder  cette page"})]})]}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Produits"}),K.jsx("p",{className:"text-muted-foreground",children:"Grez vos produits et catgories"})]}),K.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:k&&K.jsxs(K.Fragment,{children:[K.jsxs(Hu,{variant:"outline",size:"touch",onClick:D,className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouvelle catgorie"]}),K.jsxs(Hu,{variant:"default",size:"touch",onClick:A,className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouveau produit"]})]})})]}),K.jsxs(ty,{value:b,onValueChange:e=>w(e),className:"space-y-4",children:[K.jsxs(sy,{children:[K.jsx(ry,{value:"products",children:"Produits"}),K.jsx(ry,{value:"categories",children:"Catgories"})]}),K.jsx(ay,{value:"products",className:"space-y-4",children:N?K.jsx(Rh,{className:"bg-destructive/10 border border-destructive/20",children:K.jsxs(Fh,{className:"p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Erreur de chargement"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:N}),K.jsxs(Hu,{onClick:M,variant:"outline",className:"gap-2",children:[K.jsx(vr,{className:"w-4 h-4"}),"Ressayer"]})]})}):K.jsxs(K.Fragment,{children:[K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsx(Fh,{className:"p-4",children:K.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[K.jsxs("div",{className:"flex-1 relative",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un produit...",value:r,onChange:e=>a(e.target.value),className:"pl-10 h-12"})]}),K.jsxs(Hu,{variant:"outline",size:"default",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]})})}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(dr,{className:"w-5 h-5 text-primary"}),"Liste des produits"]}),K.jsx(qh,{children:u?"Chargement...":`${O.length} produit(s) trouv(s)`})]}),K.jsx(Fh,{children:u?K.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Array.from({length:8}).map((e,t)=>K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"pb-3",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-6 w-3/4 rounded mb-2"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-1/2 rounded"})]}),K.jsxs(Fh,{className:"space-y-3",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-1/3 rounded"}),K.jsxs("div",{className:"space-y-2",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-full rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-2/3 rounded"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-1/2 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-3/4 rounded"})]})]})]},t))}):0===O.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(dr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Aucun produit"}),K.jsx("p",{className:"text-muted-foreground mb-6",children:r?"Aucun produit ne correspond  votre recherche":"Commencez par ajouter votre premier produit"}),k&&K.jsxs(Hu,{onClick:A,className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Ajouter un produit"]})]}):K.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:O.map(s=>{var r,a,n,i;return K.jsxs(Rh,{className:"bg-gradient-card shadow-card hover:shadow-elevated transition-all duration-200 transform hover:scale-[1.02]",children:[K.jsx(Ih,{className:"pb-3",children:K.jsxs("div",{className:"flex items-start justify-between",children:[K.jsxs("div",{className:"flex-1",children:[K.jsx(Lh,{className:"text-lg font-semibold line-clamp-2",children:s.name}),K.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["SKU: ",s.sku]})]}),K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",size:"icon",className:"h-8 w-8",children:K.jsx(cr,{className:"w-4 h-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Ch,{children:"Actions"}),K.jsx(Th,{}),K.jsx(Sh,{children:"Voir dtails"}),S&&K.jsx(Sh,{onClick:()=>(e=>{S?(j(e),x(!0)):t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour modifier des produits",variant:"destructive"})})(s),children:"Modifier"}),C&&K.jsxs(K.Fragment,{children:[K.jsx(Th,{}),K.jsx(Sh,{className:"text-destructive",onClick:()=>(async e=>{if(C){if(confirm("tes-vous sr de vouloir supprimer ce produit ?"))try{const{error:s}=await Fu.from("products").delete().eq("id",e);if(s)throw s;t({title:"Succs",description:"Produit supprim avec succs"}),M()}catch(s){t({title:"Erreur",description:"Impossible de supprimer le produit",variant:"destructive"})}}else t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour supprimer des produits",variant:"destructive"})})(s.id),children:"Supprimer"})]})]})]})]})}),K.jsxs(Fh,{className:"space-y-3",children:[K.jsx("div",{className:"flex items-center gap-2",children:K.jsx(Jh,{variant:"outline",className:"text-xs",children:(null==(r=s.categories)?void 0:r.name)||"Non catgoris"})}),K.jsxs("div",{className:"space-y-1",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsx("span",{className:"text-sm text-muted-foreground",children:"Prix actuel"}),K.jsx("span",{className:"font-semibold text-lg",children:e(s.current_sale_price)})]}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsx("span",{className:"text-sm text-muted-foreground",children:"Prix minimum"}),K.jsx("span",{className:"text-sm",children:e(s.min_sale_price)})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsx("span",{className:"text-sm text-muted-foreground",children:"Stock"}),K.jsxs("span",{className:"text-sm font-medium",children:[null==(a=s.units)?void 0:a.name," (",null==(n=s.units)?void 0:n.symbol,")"]})]}),s.product_stores&&s.product_stores.length>0?K.jsx("div",{className:"space-y-1",children:s.product_stores.map((e,t)=>{var s;return K.jsxs("div",{className:"flex items-center justify-between text-xs",children:[K.jsxs("span",{className:"text-muted-foreground",children:[null==(s=e.stores)?void 0:s.name,":"]}),K.jsx("span",{className:"font-medium "+(e.current_stock<=e.min_stock?"text-red-500":"text-green-600"),children:e.current_stock})]},t)})}):K.jsx("div",{className:"text-center py-2",children:K.jsx("span",{className:"text-xs text-muted-foreground",children:"Aucun stock"})})]}),K.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[(null==(i=s.product_stores)?void 0:i.some(e=>e.current_stock<=e.min_stock))&&K.jsx(Jh,{variant:"destructive",className:"text-xs",children:"Stock faible"}),s.expiry_date&&new Date(s.expiry_date)<new Date&&K.jsx(Jh,{variant:"destructive",className:"text-xs",children:"Expir"}),s.expiry_date&&new Date(s.expiry_date)>new Date&&new Date(s.expiry_date)<new Date(Date.now()+2592e6)&&K.jsx(Jh,{variant:"secondary",className:"text-xs",children:"Expire bientt"})]})]})]},s.id)})})})]})]})}),K.jsxs(ay,{value:"categories",className:"space-y-4",children:[K.jsx(Rh,{className:"bg-gradient-card shadow-card",children:K.jsx(Fh,{className:"p-4",children:K.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[K.jsxs("div",{className:"flex-1 relative",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher une catgorie...",value:n,onChange:e=>i(e.target.value),className:"pl-10 h-12"})]}),k&&K.jsxs(Hu,{variant:"outline",size:"default",onClick:D,className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouvelle catgorie"]})]})})}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Liste des catgories"}),K.jsx(qh,{children:m?"Chargement...":`${I.length} catgorie(s)`})]}),K.jsx(Fh,{children:m?K.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((e,t)=>K.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-48 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-6 w-16 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-20 rounded"})]},t))}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Catgorie"}),K.jsx(ip,{children:"Description"}),K.jsx(ip,{className:"text-right",children:"Nombre de produits"}),K.jsx(ip,{className:"text-right",children:"Actions"})]})}),K.jsx(ap,{children:I.map(e=>K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.name}),K.jsx(op,{className:"text-muted-foreground",children:e.description||""}),K.jsx(op,{className:"text-right",children:K.jsx(Jh,{variant:"outline",children:R[e.id]||0})}),K.jsx(op,{className:"text-right",children:T?K.jsx(Hu,{variant:"outline",size:"sm",onClick:()=>(async e=>{if(!T)return;if((R[e]||0)>0)t({title:"Suppression impossible",description:"Cette catgorie contient encore des produits. Dplacez ou supprimez-les avant.",variant:"destructive"});else if(confirm("Supprimer cette catgorie ? Cette action est irrversible."))try{const{count:s,error:r}=await Fu.from("products").select("id",{count:"exact",head:!0}).eq("category_id",e);if(r)throw r;if((s||0)>0)return void t({title:"Suppression refuse",description:"Des produits sont encore rattachs  cette catgorie.",variant:"destructive"});const{error:a}=await Fu.from("categories").delete().eq("id",e);if(a)throw a;t({title:"Catgorie supprime"}),await P()}catch(s){t({title:"Erreur",description:"Impossible de supprimer la catgorie",variant:"destructive"})}})(e.id),disabled:(R[e.id]||0)>0,title:(R[e.id]||0)>0?"Supprimez/dplacez d'abord les produits":"",children:"Supprimer"}):K.jsx("span",{className:"text-muted-foreground text-sm",children:""})})]},e.id))})]})})]})]})]}),K.jsx(Rv,{isOpen:f,onClose:()=>x(!1),onSuccess:M,product:y}),K.jsx(Iv,{isOpen:g,onClose:()=>v(!1),onSuccess:()=>{P()}})]})}function iy({isOpen:e,onClose:t,onSuccess:s,purchase:r}){var a,n,i;const{user:o,userProfile:l}=Uu(),{toast:c}=At(),[d,u]=Ke.useState(!1),[h,m]=Ke.useState("");Ke.useEffect(()=>{e&&r&&m("")},[e,r]);return r?K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-md",children:[K.jsxs(mp,{children:[K.jsx(fp,{children:"Validation d'arrivage"}),K.jsx(xp,{children:"Vrifiez et validez les quantits reues pour cet achat"})]}),K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"bg-muted p-4 rounded-md space-y-2",children:[K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{className:"text-sm font-medium",children:"Produit:"}),K.jsx("span",{className:"text-sm",children:null==(a=r.products)?void 0:a.name})]}),K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{className:"text-sm font-medium",children:"SKU:"}),K.jsx("span",{className:"text-sm",children:null==(n=r.products)?void 0:n.sku})]}),K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{className:"text-sm font-medium",children:"Fournisseur:"}),K.jsx("span",{className:"text-sm",children:null==(i=r.suppliers)?void 0:i.name})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"received_quantity",children:"Quantit reue *"}),K.jsx(Yu,{id:"received_quantity",type:"number",value:h,onChange:e=>m(e.target.value),required:!0,min:"0"}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Le nombre command n'est pas affich pour viter d'influencer la saisie."})]})]}),K.jsxs(pp,{children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:t,children:"Annuler"}),K.jsx(Hu,{onClick:async()=>{if(o&&l)if(l.id&&""!==l.id){if(h&&!(parseInt(h)<=0)||(c({title:"Erreur",description:"La quantit reue doit tre suprieure  0",variant:"destructive"}),0)){u(!0);try{const e=parseInt(h),a=r.quantity,{error:n}=await Fu.from("arrivals").insert({purchase_id:r.id,received_quantity:e,validated_by:l.id,notes:null});if(n){const e="Quantit reue incorrecte. Veuillez vrifier le colis ou contacter l'expditeur.";return void c({title:"Validation impossible",description:!0?e:n.message||e,variant:"destructive"})}c({title:"Arrivage enregistr",description:e===a?"Quantit conforme. Stock mis  jour.":`Quantit reue (${e}) diffrente de la commande (${a}). Vrifiez et recommencez.`,variant:e===a?"default":"destructive"}),s(),t()}catch(e){c({title:"Erreur",description:(null==e?void 0:e.message)||"Une erreur est survenue lors de la validation",variant:"destructive"})}finally{u(!1)}}}else c({title:"Erreur",description:"Profil utilisateur invalide. Veuillez vous reconnecter.",variant:"destructive"});else c({title:"Erreur",description:"Vous devez tre connect pour valider un arrivage",variant:"destructive"})},disabled:d||!h,children:d?"Validation...":"Valider l'arrivage"})]})]})}):null}function oy({isOpen:e,onClose:t,onSuccess:s,transfer:r}){var a;const{userProfile:n}=Uu(),{toast:i}=At(),[o,l]=Ke.useState(!1),[c,d]=Ke.useState("");Ke.useEffect(()=>{e&&r&&d("")},[e,r]);return r?K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-md",children:[K.jsxs(mp,{children:[K.jsx(fp,{children:"Rception de transfert"}),K.jsx(xp,{children:"Renseignez la quantit reue pour ce transfert"})]}),K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"bg-muted p-4 rounded-md space-y-2",children:[K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{className:"text-sm font-medium",children:"Code:"}),K.jsx("span",{className:"text-sm",children:r.transfer_code})]}),K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{className:"text-sm font-medium",children:"Produit:"}),K.jsx("span",{className:"text-sm",children:(null==(a=r.products)?void 0:a.name)||r.product_name})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"received_qty",children:"Quantit reue *"}),K.jsx(Yu,{id:"received_qty",type:"number",value:c,onChange:e=>d(e.target.value),min:"0"})]})]}),K.jsxs(pp,{children:[K.jsx(Hu,{variant:"outline",onClick:t,children:"Annuler"}),K.jsx(Hu,{onClick:async()=>{if(!(null==n?void 0:n.id))return void i({title:"Erreur",description:"Profil invalide",variant:"destructive"});const e=parseInt(c);if(!e||e<=0)i({title:"Erreur",description:"Quantit invalide",variant:"destructive"});else{l(!0);try{const{error:a}=await Fu.from("transfer_receptions").insert({transfer_id:r.id,received_quantity:e,received_by:n.id,notes:null});if(a){return void i({title:"Validation impossible",description:"Quantit reue incorrecte. Veuillez vrifier le colis ou contacter l'expditeur.",variant:"destructive"})}i({title:"Transfert valid",description:"Stock mis  jour pour le magasin destination."}),s(),t()}catch(gb){i({title:"Erreur",description:(null==gb?void 0:gb.message)||"chec de la validation",variant:"destructive"})}finally{l(!1)}}},disabled:o||!c,children:o?"Validation...":"Valider"})]})]})}):null}function ly(){var e,t;const{toast:s}=At(),{userProfile:r}=Uu(),[a,n]=Ke.useState(""),[i,o]=Ke.useState([]),[l,c]=Ke.useState([]),[d,u]=Ke.useState(!0),[h,m]=Ke.useState(!0),[p,f]=Ke.useState(!1),[x,g]=Ke.useState(null),[v,y]=Ke.useState(!1),[j,b]=Ke.useState(null),[w,N]=Ke.useState(null),[_,k]=Ke.useState({supplier:"all",store:"all",dateRange:null,status:"all"}),[S,C]=Ke.useState(!1),T=(null==r?void 0:r.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(r.role),E=(null==r?void 0:r.role)&&["Manager","Admin","SuperAdmin"].includes(r.role);Ke.useEffect(()=>{T&&M()},[T]);const M=async()=>{try{N(null),u(!0),m(!0);const[{data:e,error:t},{data:s,error:r},{data:a,error:n},{data:i,error:l}]=await Promise.all([Fu.from("purchases").select("*, suppliers(name), products(name, sku), stores(name)").eq("status","pending").order("created_at",{ascending:!1}),Fu.from("store_transfers").select("*, product:products(name, sku)").eq("status","pending").order("created_at",{ascending:!1}),Fu.from("arrivals").select("purchase_id"),Fu.from("transfer_receptions").select("transfer_id")]);if(t)throw t;if(r)throw r;if(n)throw n;if(l)throw l;const d=new Set((a||[]).map(e=>e.purchase_id)),h=new Set((i||[]).map(e=>e.transfer_id)),p=(e||[]).filter(e=>!d.has(e.id)),f=(s||[]).filter(e=>!h.has(e.id)),x=[...p.map(e=>({type:"Achat",...e})),...f.map(e=>({type:"Transfert",...e}))];o(x),u(!1);const[{data:g,error:v},{data:y,error:j}]=await Promise.all([Fu.from("arrivals").select("*, purchases(*, suppliers(name), products(name, sku), stores(name))").order("created_at",{ascending:!1}).limit(100),Fu.from("transfer_receptions").select("*, store_transfers(*, product:products(name, sku))").order("received_at",{ascending:!1}).limit(100)]);if(v)throw v;if(j)throw j;const b=[...(g||[]).map(e=>({type:"Achat",...e})),...(y||[]).map(e=>({type:"Transfert",...e}))];c(b),m(!1)}catch(e){N("Impossible de charger les arrivages"),s({title:"Erreur",description:"Impossible de charger les arrivages",variant:"destructive"}),u(!1),m(!1)}},P=e=>{var t,s;let r=e.filter(e=>{var t,s,r,n,i,o,l,c,d,u,h,m,p,f,x,g,v,y,j,b,w,N,_,k,S;const C=a.toLowerCase();if("Achat"===e.type){const a=e;return(null==(n=null==(r=null==(s=null==(t=a.purchases)?void 0:t.suppliers)?void 0:s.name)?void 0:r.toLowerCase)?void 0:n.call(r).includes(C))||(null==(c=null==(l=null==(o=null==(i=a.purchases)?void 0:i.products)?void 0:o.name)?void 0:l.toLowerCase)?void 0:c.call(l).includes(C))||(null==(m=null==(h=null==(u=null==(d=a.purchases)?void 0:d.products)?void 0:u.sku)?void 0:h.toLowerCase)?void 0:m.call(h).includes(C))||(null==(x=null==(f=null==(p=a.suppliers)?void 0:p.name)?void 0:f.toLowerCase)?void 0:x.call(f).includes(C))||(null==(y=null==(v=null==(g=a.products)?void 0:g.name)?void 0:v.toLowerCase)?void 0:y.call(v).includes(C))||(null==(w=null==(b=null==(j=a.products)?void 0:j.sku)?void 0:b.toLowerCase)?void 0:w.call(b).includes(C))}{const t=e;return(null==(_=null==(N=t.transfer_code)?void 0:N.toLowerCase)?void 0:_.call(N).includes(C))||(null==(S=null==(k=t.product_name)?void 0:k.toLowerCase)?void 0:S.call(k).includes(C))}});return _.supplier&&"all"!==_.supplier&&(r=r.filter(e=>{var t,s,r;return"Achat"===e.type&&((null==(t=e.suppliers)?void 0:t.name)===_.supplier||(null==(r=null==(s=e.purchases)?void 0:s.suppliers)?void 0:r.name)===_.supplier)})),_.store&&"all"!==_.store&&(r=r.filter(e=>{var t,s,r;return"Achat"===e.type&&((null==(t=e.stores)?void 0:t.name)===_.store||(null==(r=null==(s=e.purchases)?void 0:s.stores)?void 0:r.name)===_.store)})),(null==(t=_.dateRange)?void 0:t.from)&&(r=r.filter(e=>new Date(e.created_at||e.received_at)>=_.dateRange.from)),(null==(s=_.dateRange)?void 0:s.to)&&(r=r.filter(e=>new Date(e.created_at||e.received_at)<=_.dateRange.to)),_.status&&"all"!==_.status&&(r=r.filter(e=>{var t,s;if("Achat"===e.type){const r=(e.received_quantity??(null==(t=e.purchases)?void 0:t.quantity)??e.quantity)!==((null==(s=e.purchases)?void 0:s.quantity)??e.quantity);return"discrepancy"===_.status?r:"perfect"!==_.status||!r}return!0})),r},A=P(i),D=P(l),O=[...new Set(i.filter(e=>"Achat"===e.type).map(e=>{var t,s,r;return(null==(t=e.suppliers)?void 0:t.name)||(null==(r=null==(s=e.purchases)?void 0:s.suppliers)?void 0:r.name)}).filter(Boolean))],R=[...new Set(i.filter(e=>"Achat"===e.type).map(e=>{var t,s,r;return(null==(t=e.stores)?void 0:t.name)||(null==(r=null==(s=e.purchases)?void 0:s.stores)?void 0:r.name)}).filter(Boolean))];return w&&!T?K.jsxs("div",{className:"space-y-6",children:[K.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(dr,{className:"w-7 h-7 text-primary"}),"Arrivages"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les arrivages de marchandises en magasin"})]})}),K.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Accs refus"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:"Vous n'avez pas les permissions pour accder  cette page"})]})]}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(dr,{className:"w-7 h-7 text-primary"}),"Arrivages"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les arrivages de marchandises en magasin"})]}),K.jsxs("div",{className:"flex gap-2",children:[K.jsxs(Jh,{variant:"outline",className:"gap-1",children:[K.jsx(Vs,{className:"w-3 h-3"}),i.length," en attente"]}),K.jsxs(Jh,{variant:"outline",className:"gap-1 bg-success/10 text-success",children:[K.jsx(Ls,{className:"w-3 h-3"}),l.length," valids"]})]})]}),w?K.jsx(Rh,{className:"bg-destructive/10 border border-destructive/20",children:K.jsxs(Fh,{className:"p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Erreur de chargement"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:w}),K.jsxs(Hu,{onClick:()=>{N(null),M()},variant:"outline",className:"gap-2",children:[K.jsx(vr,{className:"w-4 h-4"}),"Ressayer"]})]})}):K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un arrivage...",value:a,onChange:e=>n(e.target.value),className:"pl-10"})]}),K.jsxs(Av,{open:S,onOpenChange:C,children:[K.jsx(Dv,{asChild:!0,children:K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres",("all"!==_.supplier||"all"!==_.store||_.dateRange||"all"!==_.status)&&K.jsx(Jh,{variant:"secondary",className:"ml-1 h-5 w-5 p-0 text-xs",children:("all"!==_.supplier?1:0)+("all"!==_.store?1:0)+(_.dateRange?1:0)+("all"!==_.status?1:0)})]})}),K.jsx(Ov,{className:"w-80",align:"end",children:K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsx("h4",{className:"font-medium",children:"Filtres"}),K.jsxs(Hu,{variant:"ghost",size:"sm",onClick:()=>{k({supplier:"all",store:"all",dateRange:null,status:"all"})},className:"h-6 px-2 text-xs",children:[K.jsx(qr,{className:"w-3 h-3 mr-1"}),"Rinitialiser"]})]}),K.jsxs("div",{className:"space-y-3",children:[K.jsxs("div",{children:[K.jsx("label",{className:"text-sm font-medium",children:"Fournisseur"}),K.jsxs(If,{value:_.supplier,onValueChange:e=>k(t=>({...t,supplier:e})),children:[K.jsx(qf,{className:"mt-1",children:K.jsx(Lf,{placeholder:"Tous les fournisseurs"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les fournisseurs"}),O.map(e=>K.jsx(Wf,{value:e,children:e},e))]})]})]}),K.jsxs("div",{children:[K.jsx("label",{className:"text-sm font-medium",children:"Magasin"}),K.jsxs(If,{value:_.store,onValueChange:e=>k(t=>({...t,store:e})),children:[K.jsx(qf,{className:"mt-1",children:K.jsx(Lf,{placeholder:"Tous les magasins"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les magasins"}),R.map(e=>K.jsx(Wf,{value:e,children:e},e))]})]})]}),K.jsxs("div",{children:[K.jsx("label",{className:"text-sm font-medium",children:"Priode"}),K.jsxs(Av,{children:[K.jsx(Dv,{asChild:!0,children:K.jsxs(Hu,{variant:"outline",className:"mt-1 w-full justify-start text-left font-normal",children:[K.jsx(Rs,{className:"mr-2 h-4 w-4"}),(null==(e=_.dateRange)?void 0:e.from)?_.dateRange.to?K.jsxs(K.Fragment,{children:[Km(_.dateRange.from,"LLL dd, y",{locale:ep})," -"," ",Km(_.dateRange.to,"LLL dd, y",{locale:ep})]}):Km(_.dateRange.from,"LLL dd, y",{locale:ep}):K.jsx("span",{children:"Priode"})]})}),K.jsx(Ov,{className:"w-auto p-0",align:"start",children:K.jsx(ov,{initialFocus:!0,mode:"range",defaultMonth:null==(t=_.dateRange)?void 0:t.from,selected:_.dateRange,onSelect:e=>k(t=>({...t,dateRange:e})),numberOfMonths:2,locale:ep})})]})]}),K.jsxs("div",{children:[K.jsx("label",{className:"text-sm font-medium",children:"Statut (historique)"}),K.jsxs(If,{value:_.status,onValueChange:e=>k(t=>({...t,status:e})),children:[K.jsx(qf,{className:"mt-1",children:K.jsx(Lf,{placeholder:"Tous les statuts"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les statuts"}),K.jsx(Wf,{value:"perfect",children:"Sans cart"}),K.jsx(Wf,{value:"discrepancy",children:"Avec cart"})]})]})]})]})]})})]})]}),K.jsxs(ty,{defaultValue:"pending",className:"space-y-4",children:[K.jsxs(sy,{children:[K.jsxs(ry,{value:"pending",children:["En Attente (",A.length,")"]}),K.jsxs(ry,{value:"history",children:["Historique (",D.length,")"]})]}),K.jsx(ay,{value:"pending",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Arrivages  valider"}),K.jsx(qh,{children:"Achats et transferts en attente de validation"})]}),K.jsx(Fh,{children:d?K.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((e,t)=>K.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-16 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-48 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-24 rounded"})]},t))}):0===A.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(dr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:a?"Aucun arrivage ne correspond  votre recherche":"Aucun arrivage en attente"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Type"}),K.jsx(ip,{children:"Fournisseur"}),K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Date"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:A.map(e=>{var t,r,a,n,i,o,l,c,d,u,h,m,p;return K.jsxs(np,{children:[K.jsx(op,{children:e.type}),K.jsx(op,{children:"Achat"===e.type?(null==(t=e.suppliers)?void 0:t.name)||(null==(a=null==(r=e.purchases)?void 0:r.suppliers)?void 0:a.name):""}),K.jsx(op,{children:K.jsxs("div",{children:[K.jsx("p",{className:"font-medium",children:"Achat"===e.type?(null==(n=e.products)?void 0:n.name)||(null==(o=null==(i=e.purchases)?void 0:i.products)?void 0:o.name):e.product_name||(null==(l=e.products)?void 0:l.name)}),"Achat"===e.type&&K.jsxs("p",{className:"text-sm text-muted-foreground",children:["SKU: ",(null==(c=e.products)?void 0:c.sku)||(null==(u=null==(d=e.purchases)?void 0:d.products)?void 0:u.sku)]})]})}),K.jsx(op,{children:"Achat"===e.type?(null==(h=e.stores)?void 0:h.name)||(null==(p=null==(m=e.purchases)?void 0:m.stores)?void 0:p.name):""}),K.jsx(op,{children:new Date(e.created_at).toLocaleDateString()}),K.jsx(op,{children:"Achat"===e.type?K.jsxs(Hu,{size:"sm",onClick:()=>{return t=e,void(E?(g(t),f(!0)):s({title:"Permission refuse",description:"Vous n'avez pas les permissions pour valider les arrivages",variant:"destructive"}));var t},className:"gap-1",children:[K.jsx(Ls,{className:"w-3 h-3"})," Valider"]}):K.jsxs(Hu,{size:"sm",onClick:()=>{b(e),y(!0)},className:"gap-1",children:[K.jsx(Ls,{className:"w-3 h-3"})," Rceptionner"]})})]},`${e.type}-${e.id}`)})})]})})]})}),K.jsx(ay,{value:"history",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Historique des arrivages"}),K.jsx(qh,{children:"Achats valids et rceptions de transferts"})]}),K.jsx(Fh,{children:h?K.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((e,t)=>K.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-16 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-48 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"})]},t))}):0===D.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(dr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:a?"Aucun arrivage ne correspond  votre recherche":"Aucun arrivage valid"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Type"}),K.jsx(ip,{children:"Fournisseur"}),K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"Quantit"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Valid par"}),K.jsx(ip,{children:"Date validation"})]})}),K.jsx(ap,{children:D.map(e=>{var t,s,r,a,n,i,o;return K.jsxs(np,{children:[K.jsx(op,{children:e.type}),K.jsx(op,{children:"Achat"===e.type?null==(s=null==(t=e.purchases)?void 0:t.suppliers)?void 0:s.name:""}),K.jsx(op,{children:K.jsxs("div",{children:[K.jsx("p",{className:"font-medium",children:"Achat"===e.type?null==(a=null==(r=e.purchases)?void 0:r.products)?void 0:a.name:e.product_name||(null==(n=e.products)?void 0:n.name)}),"Achat"===e.type&&K.jsxs("p",{className:"text-sm text-muted-foreground",children:["SKU: ",null==(o=null==(i=e.purchases)?void 0:i.products)?void 0:o.sku]})]})}),K.jsx(op,{children:(e.type,K.jsx("div",{className:"flex items-center gap-2",children:K.jsxs("span",{children:["Reu: ",e.received_quantity]})}))}),K.jsx(op,{children:K.jsxs(Jh,{variant:"default",className:"gap-1 bg-success text-success-foreground",children:[K.jsx(Ls,{className:"w-3 h-3"}),"Valid"]})}),K.jsx(op,{children:"N/A"}),K.jsx(op,{children:new Date(e.received_at||e.created_at).toLocaleDateString()})]},`${e.type}-${e.id}`)})})]})})]})})]})]}),K.jsx(iy,{isOpen:p,onClose:()=>f(!1),onSuccess:M,purchase:x}),K.jsx(oy,{isOpen:v,onClose:()=>y(!1),onSuccess:M,transfer:j})]})}function cy({isOpen:e,onClose:t,onSuccess:s,purchase:r}){var a,n;const{user:i,userProfile:o}=Uu(),{toast:l}=At(),[c,d]=Ke.useState(!1),[u,h]=Ke.useState([]),[m,p]=Ke.useState([]),[f,x]=Ke.useState([]),[g,v]=Ke.useState(null),[y,j]=Ke.useState({store_id:"",supplier_id:"",product_id:"",quantity:"",unit_price:""});Ke.useEffect(()=>{var t,s;e&&(b(),w(),N(),j(r?{store_id:r.store_id||"",supplier_id:r.supplier_id||"",product_id:r.product_id||"",quantity:(null==(t=r.quantity)?void 0:t.toString())||"",unit_price:(null==(s=r.unit_price)?void 0:s.toString())||""}:{store_id:"",supplier_id:"",product_id:"",quantity:"",unit_price:""}))},[e,r]);const b=async()=>{try{const{data:e,error:t}=await Fu.from("stores").select("*").eq("is_active",!0).order("name");if(t)throw t;h(e||[])}catch(e){l({title:"Erreur",description:"Impossible de charger les magasins",variant:"destructive"})}},w=async()=>{try{const{data:e,error:t}=await Fu.from("suppliers").select("*").eq("is_active",!0).order("name");if(t)throw t;p(e||[])}catch(e){l({title:"Erreur",description:"Impossible de charger les fournisseurs",variant:"destructive"})}},N=async()=>{try{const{data:e,error:t}=await Fu.from("products").select("*, units(name, symbol)").eq("is_active",!0).order("name");if(t)throw t;x(e||[])}catch(e){l({title:"Erreur",description:"Impossible de charger les produits",variant:"destructive"})}},_=()=>(parseFloat(y.quantity)||0)*(parseFloat(y.unit_price)||0);return K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-2xl",children:[K.jsxs(mp,{children:[K.jsx(fp,{children:r?"Modifier l'achat":"Nouvel achat"}),K.jsx(xp,{children:r?"Modifiez les informations de l'achat":"Crez une nouvelle commande fournisseur"})]}),K.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i&&o){if(y.store_id?y.supplier_id?y.product_id?!y.quantity||parseInt(y.quantity)<=0?(l({title:"Erreur",description:"La quantit doit tre suprieure  0",variant:"destructive"}),0):y.unit_price&&Hf(parseFloat(y.unit_price))||(l({title:"Erreur",description:"Le prix unitaire doit tre valide",variant:"destructive"}),0):(l({title:"Erreur",description:"Veuillez slectionner un produit",variant:"destructive"}),0):(l({title:"Erreur",description:"Veuillez slectionner un fournisseur",variant:"destructive"}),0):(l({title:"Erreur",description:"Veuillez slectionner un magasin",variant:"destructive"}),0)){d(!0);try{const e=_(),a={store_id:y.store_id,supplier_id:y.supplier_id,product_id:y.product_id,quantity:parseInt(y.quantity),unit_price:parseFloat(y.unit_price),total_amount:e,created_by:o.id};if(r){const{error:e}=await Fu.from("purchases").update(a).eq("id",r.id);if(e)throw e;l({title:"Succs",description:"Achat modifi avec succs"})}else{const{error:e}=await Fu.from("purchases").insert([a]);if(e)throw e;l({title:"Succs",description:"Achat cr avec succs"})}s(),t()}catch(a){const e=Uf(a);l({title:"Erreur",description:e,variant:"destructive"})}finally{d(!1)}}}else l({title:"Erreur",description:"Vous devez tre connect pour crer un achat",variant:"destructive"})},className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"store",children:"Magasin *"}),K.jsxs(If,{value:y.store_id,onValueChange:e=>j(t=>({...t,store_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un magasin"})}),K.jsx($f,{children:u.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"supplier",children:"Fournisseur *"}),K.jsxs(If,{value:y.supplier_id,onValueChange:e=>j(t=>({...t,supplier_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un fournisseur"})}),K.jsx($f,{children:m.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"product",children:"Produit *"}),K.jsxs(If,{value:y.product_id,onValueChange:e=>{const t=f.find(t=>t.id===e);v(t||null),j(t=>({...t,product_id:e}))},children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un produit"})}),K.jsx($f,{children:f.map(e=>K.jsxs(Wf,{value:e.id,children:[e.name," - ",e.sku]},e.id))})]}),g&&K.jsxs("p",{className:"text-sm text-muted-foreground",children:["Unit: ",null==(a=g.units)?void 0:a.name," (",null==(n=g.units)?void 0:n.symbol,")"]})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"quantity",children:"Quantit *"}),K.jsx(Yu,{id:"quantity",type:"number",value:y.quantity,onChange:e=>j(t=>({...t,quantity:e.target.value})),required:!0,min:"1"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"unit_price",children:"Prix unitaire (XOF) *"}),K.jsx(Yu,{id:"unit_price",type:"number",step:"0.01",value:y.unit_price,onChange:e=>j(t=>({...t,unit_price:e.target.value})),required:!0,min:"0"})]})]}),y.quantity&&y.unit_price&&K.jsx("div",{className:"bg-muted p-4 rounded-md",children:K.jsxs("p",{className:"text-sm font-medium",children:["Montant total: ",_().toLocaleString()," XOF"]})}),K.jsxs(pp,{children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:t,children:"Annuler"}),K.jsx(Hu,{type:"submit",disabled:c,children:c?"Enregistrement...":r?"Modifier":"Crer"})]})]})]})})}function dy(){const{formatAmount:e}=Hh(),{toast:t}=At(),{userProfile:s}=Uu(),[r,a]=Ke.useState(""),[n,i]=Ke.useState([]),[o,l]=Ke.useState(!0),[c,d]=Ke.useState(null),[u,h]=Ke.useState(!1),[m,p]=Ke.useState(null),f=(null==s?void 0:s.role)&&["Admin","SuperAdmin","Manager"].includes(s.role),x=(null==s?void 0:s.role)&&["Admin","SuperAdmin","Manager"].includes(s.role),g=(null==s?void 0:s.role)&&["Admin","SuperAdmin"].includes(s.role);Ke.useEffect(()=>{f&&v()},[f]);const v=async()=>{try{l(!0),d(null);const{data:e,error:t}=await Fu.from("purchases").select("\n          *,\n          suppliers(name),\n          products(name, sku),\n          stores(name)\n        ").order("created_at",{ascending:!1});if(t)throw t;const s=[...new Set((e||[]).map(e=>e.created_by).filter(Boolean))];let r={};if(s.length>0){const{data:e,error:t}=await Fu.from("users").select("id, first_name, last_name").in("id",s);!t&&e&&(r=e.reduce((e,t)=>(e[t.id]=t,e),{}))}const a=(e||[]).map(e=>({...e,created_by_user:r[e.created_by]}));i(a)}catch(e){d("Impossible de charger les achats"),t({title:"Erreur",description:"Impossible de charger les achats",variant:"destructive"})}finally{l(!1)}},y=()=>{f?(p(null),h(!0)):t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour crer des achats",variant:"destructive"})},{totalAmount:j,filteredPurchases:b,pendingCount:w}=Ke.useMemo(()=>({totalAmount:n.reduce((e,t)=>e+(t.total_amount||0),0),filteredPurchases:n.filter(e=>{var t,s,a,n,i,o;return(null==(s=null==(t=e.suppliers)?void 0:t.name)?void 0:s.toLowerCase().includes(r.toLowerCase()))||(null==(n=null==(a=e.products)?void 0:a.name)?void 0:n.toLowerCase().includes(r.toLowerCase()))||(null==(o=null==(i=e.products)?void 0:i.sku)?void 0:o.toLowerCase().includes(r.toLowerCase()))}),pendingCount:n.filter(e=>"validated"!==e.status).length}),[n,r]);return c&&!f?K.jsxs("div",{className:"space-y-6",children:[K.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(_r,{className:"w-7 h-7 text-primary"}),"Achats"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez vos commandes et achats fournisseurs"})]})}),K.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Accs refus"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:"Vous n'avez pas les permissions pour accder  cette page"})]})]}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(_r,{className:"w-7 h-7 text-primary"}),"Achats"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez vos commandes et achats fournisseurs"})]}),f&&K.jsxs(Hu,{onClick:y,size:"touch",className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouvel achat"]})]}),c?K.jsx(Rh,{className:"bg-destructive/10 border border-destructive/20",children:K.jsxs(Fh,{className:"p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Erreur de chargement"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:c}),K.jsxs(Hu,{onClick:()=>{d(null),v()},variant:"outline",className:"gap-2",children:[K.jsx(vr,{className:"w-4 h-4"}),"Ressayer"]})]})}):K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total achats"}),K.jsx(Ks,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:e(j)}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Ce mois-ci"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Commandes"}),K.jsx(_r,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:n.length}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Total commandes"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"En attente"}),K.jsx(_r,{className:"h-4 w-4 text-warning"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:w}),K.jsx("p",{className:"text-xs text-muted-foreground",children:" traiter"})]})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un achat...",value:r,onChange:e=>a(e.target.value),className:"pl-10"})]}),K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Liste des achats"}),K.jsx(qh,{children:"Historique de vos commandes fournisseurs"})]}),K.jsx(Fh,{children:o?K.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((e,t)=>K.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-48 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-16 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-24 rounded"})]},t))}):0===b.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(_r,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:r?"Aucun achat ne correspond  votre recherche":"Aucun achat trouv"}),f&&K.jsx(Hu,{onClick:y,variant:"outline",children:"Crer un achat"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Fournisseur"}),K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Quantit"}),K.jsx(ip,{children:"Prix unitaire"}),K.jsx(ip,{children:"Total"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:b.map(s=>{var r,a,n,i,o;return K.jsxs(np,{children:[K.jsx(op,{children:null==(r=s.suppliers)?void 0:r.name}),K.jsx(op,{children:K.jsxs("div",{children:[K.jsx("p",{className:"font-medium",children:null==(a=s.products)?void 0:a.name}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:["SKU: ",null==(n=s.products)?void 0:n.sku]})]})}),K.jsx(op,{children:null==(i=s.stores)?void 0:i.name}),K.jsx(op,{children:s.quantity}),K.jsx(op,{children:e(s.unit_price)}),K.jsx(op,{className:"font-medium",children:e(s.total_amount)}),K.jsx(op,{children:(o=s.status,"validated"===o?K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:"Valid"}):K.jsx(Jh,{variant:"secondary",children:"En attente"}))}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Sh,{children:"Voir dtails"}),x&&K.jsx(Sh,{onClick:()=>(e=>{x?"validated"!==e.status?(p(e),h(!0)):t({title:"Modification impossible",description:"Impossible de modifier un achat valid",variant:"destructive"}):t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour modifier des achats",variant:"destructive"})})(s),disabled:"validated"===s.status,children:"Modifier"}),g&&K.jsx(Sh,{className:"text-destructive",onClick:()=>(async(e,s)=>{if(g){if(s)t({title:"Suppression impossible",description:"Impossible de supprimer un achat valid",variant:"destructive"});else if(confirm("tes-vous sr de vouloir supprimer cet achat ?"))try{const{error:s}=await Fu.from("purchases").delete().eq("id",e);if(s)throw s;t({title:"Succs",description:"Achat supprim avec succs"}),v()}catch(r){t({title:"Erreur",description:"Impossible de supprimer l'achat",variant:"destructive"})}}else t({title:"Permission refuse",description:"Vous n'avez pas les permissions pour supprimer des achats",variant:"destructive"})})(s.id,"validated"===s.status),children:"Supprimer"})]})]})})]},s.id)})})]})})]})]}),K.jsx(cy,{isOpen:u,onClose:()=>h(!1),onSuccess:v,purchase:m})]})}function uy(){return K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin","Manager"],children:K.jsx(dy,{})})}ay.displayName=ey.displayName;const hy=async(e,t,s)=>{try{const{data:r,error:a}=await Fu.from("product_stores").select("current_stock").eq("store_id",e).eq("product_id",t).maybeSingle();if(a)throw a;const n=(null==r?void 0:r.current_stock)||0;return{available:n>=s,current_stock:n}}catch(r){return{available:!1,current_stock:0,error:r instanceof Error?r.message:"Erreur inconnue"}}},my=async e=>{try{const t=await hy(e.source_store_id,e.product_id,e.quantity);if(!t.available)return{success:!1,error:`Stock insuffisant dans le magasin source. Stock disponible: ${t.current_stock}, Quantit demande: ${e.quantity}`};const s=`TRF-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:r,error:a}=await Fu.from("store_transfers").insert({transfer_code:s,source_store_id:e.source_store_id,destination_store_id:e.destination_store_id,product_id:e.product_id,quantity:e.quantity,notes:e.notes,created_by:e.created_by}).select("id").single();if(a)throw a;const n=await(async e=>{try{const{data:t,error:s}=await Fu.from("product_stores").select("id, current_stock").eq("store_id",e.store_id).eq("product_id",e.product_id).maybeSingle();if(s&&"PGRST116"!==s.code)throw s;const r=(null==t?void 0:t.current_stock)||0,a=r+e.quantity_change;if(a<0&&"correction"!==e.adjustment_type)return{success:!1,error:`Stock insuffisant. Stock actuel: ${r}, Tentative de retrait: ${Math.abs(e.quantity_change)}`};let n;if(t){const{error:e}=await Fu.from("product_stores").update({current_stock:a}).eq("id",t.id);if(e)throw e;n=t.id}else{const{data:t,error:s}=await Fu.from("product_stores").insert({store_id:e.store_id,product_id:e.product_id,current_stock:a}).select("id").single();if(s)throw s;n=t.id}const{error:i}=await Fu.from("inventory_adjustments").insert({inventory_id:n,store_id:e.store_id,product_id:e.product_id,adjustment_type:e.adjustment_type,previous_quantity:r,new_quantity:a,quantity_change:e.quantity_change,reason:e.reason,reference_id:e.reference_id,reference_type:e.reference_type,created_by:e.created_by});if(i)throw i;return{success:!0}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Erreur inconnue"}}})({store_id:e.source_store_id,product_id:e.product_id,adjustment_type:"transfer_out",quantity_change:-e.quantity,reason:`Transfert vers ${e.destination_store_id}`,reference_id:r.id,reference_type:"transfer",created_by:e.created_by});return n.success?{success:!0,transfer_id:r.id}:(await Fu.from("store_transfers").update({status:"cancelled"}).eq("id",r.id),{success:!1,error:n.error})}catch(t){return{success:!1,error:t instanceof Error?t.message:"Erreur inconnue"}}};function py({open:e,onOpenChange:t,onSuccess:s}){const{formatAmount:r}=Hh(),{userProfile:a}=Uu(),[n,i]=Ke.useState(!1),[o,l]=Ke.useState([]),[c,d]=Ke.useState([]),[u,h]=Ke.useState([]),[m,p]=Ke.useState({store_id:"",payment_method:"",customer_name:"",customer_email:"",customer_phone:"",notes:""}),[f,x]=Ke.useState(""),[g,v]=Ke.useState(1),[y,j]=Ke.useState(""),[b,w]=Ke.useState(""),{toast:N}=At();Ke.useEffect(()=>{e&&(_(),k(),S())},[e]);const _=async()=>{const{data:e,error:t}=await Fu.from("stores").select("id, name").eq("is_active",!0);t?N({title:"Erreur",description:"Impossible de charger les magasins",variant:"destructive"}):l(e||[])},k=async()=>{const{data:e,error:t}=await Fu.from("products").select("id, name, sku, current_sale_price, min_sale_price");t?N({title:"Erreur",description:"Impossible de charger les produits",variant:"destructive"}):d(e||[])},S=()=>{p({store_id:"",payment_method:"",customer_name:"",customer_email:"",customer_phone:"",notes:""}),h([]),x(""),v(1),j(""),w("")},C=e=>{h(u.filter((t,s)=>s!==e))},T=(e,t)=>{t<=0?C(e):h(u.map((s,r)=>r===e?{...s,quantity:t,total_price:t*s.unit_price}:s))},E=()=>u.reduce((e,t)=>e+t.total_price,0),M=()=>.2*E(),P=()=>E()+M(),A=c.find(e=>e.id===f);return K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[K.jsxs(mp,{children:[K.jsxs(fp,{className:"flex items-center gap-2",children:[K.jsx(_r,{className:"w-5 h-5"}),"Nouvelle Vente"]}),K.jsx(xp,{children:"Crer une nouvelle transaction de vente"})]}),K.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m.store_id&&m.payment_method&&0!==u.length){i(!0);try{const e=`VTE${Date.now().toString().slice(-6)}${Math.random().toString(36).substring(2,5).toUpperCase()}`,r=E(),n=M(),o=P();if(!(null==a?void 0:a.id))return N({title:"Erreur",description:"Profil utilisateur invalide",variant:"destructive"}),void i(!1);const{data:l,error:c}=await Fu.from("sales").insert({sale_code:e,store_id:m.store_id,payment_method:m.payment_method,customer_name:m.customer_name||null,customer_email:m.customer_email||null,customer_phone:m.customer_phone||null,subtotal:r,tax_amount:n,total_amount:o,notes:m.notes||null,sold_by:a.id}).select().single();if(c)throw c;const d=u.map(e=>({sale_id:l.id,product_id:e.product.id,product_name:e.product.name,product_sku:e.product.sku,quantity:e.quantity,unit_price:e.unit_price,total_price:e.total_price,discount_reason:e.discount_reason})),{error:h}=await Fu.from("sale_items").insert(d);if(h)throw h;N({title:"Vente enregistre",description:`Code de vente: ${e}`}),s(),t(!1)}catch(r){N({title:"Erreur",description:"Erreur lors de l'enregistrement de la vente",variant:"destructive"})}finally{i(!1)}}else N({title:"Donnes manquantes",description:"Veuillez remplir tous les champs requis et ajouter des articles",variant:"destructive"})},className:"space-y-6",children:[K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"store",children:"Magasin *"}),K.jsxs(If,{value:m.store_id,onValueChange:e=>p(t=>({...t,store_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un magasin"})}),K.jsx($f,{children:o.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"payment_method",children:"Mthode de paiement *"}),K.jsxs(If,{value:m.payment_method,onValueChange:e=>p(t=>({...t,payment_method:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner une mthode"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"cash",children:"Espces"}),K.jsx(Wf,{value:"card",children:"Carte bancaire"}),K.jsx(Wf,{value:"mobile_money",children:"Mobile Money"}),K.jsx(Wf,{value:"bank_transfer",children:"Virement bancaire"}),K.jsx(Wf,{value:"check",children:"Chque"})]})]})]})]}),K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"customer_name",children:"Nom du client"}),K.jsx(Yu,{id:"customer_name",value:m.customer_name,onChange:e=>p(t=>({...t,customer_name:e.target.value})),placeholder:"Nom du client"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"customer_email",children:"Email"}),K.jsx(Yu,{id:"customer_email",type:"email",value:m.customer_email,onChange:e=>p(t=>({...t,customer_email:e.target.value})),placeholder:"email@exemple.com"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"customer_phone",children:"Tlphone"}),K.jsx(Yu,{id:"customer_phone",value:m.customer_phone,onChange:e=>p(t=>({...t,customer_phone:e.target.value})),placeholder:"Numro de tlphone"})]})]}),K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsx(Lh,{children:"Ajouter des articles"})}),K.jsx(Fh,{className:"space-y-4",children:K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Produit"}),K.jsxs(If,{value:f,onValueChange:x,children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner"})}),K.jsx($f,{children:c.map(e=>K.jsxs(Wf,{value:e.id,children:[e.name," - ",e.sku]},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Quantit"}),K.jsx(Yu,{type:"number",min:"1",value:g,onChange:e=>v(parseInt(e.target.value)||1)})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Prix unitaire"}),K.jsx(Yu,{type:"number",step:"0.01",placeholder:(null==A?void 0:A.current_sale_price.toString())||"0",value:y,onChange:e=>j(e.target.value)}),A&&K.jsxs("p",{className:"text-xs text-muted-foreground",children:["Prix normal: ",r(A.current_sale_price)," | Min: ",r(A.min_sale_price)]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Raison rduction"}),K.jsx(Yu,{placeholder:"Si prix rduit",value:b,onChange:e=>w(e.target.value),disabled:!y||parseFloat(y)>=((null==A?void 0:A.current_sale_price)||0)})]}),K.jsx("div",{className:"flex items-end",children:K.jsxs(Hu,{type:"button",onClick:async()=>{if(!f||g<=0)return void N({title:"Donnes manquantes",description:"Veuillez slectionner un produit et une quantit",variant:"destructive"});if(!m.store_id)return void N({title:"Magasin requis",description:"Veuillez slectionner un magasin avant d'ajouter des produits",variant:"destructive"});const e=c.find(e=>e.id===f);if(!e)return;const t=y?parseFloat(y):e.current_sale_price;if(t<e.min_sale_price&&!b)return void N({title:"Prix minimum requis",description:"Veuillez spcifier une raison pour la rduction",variant:"destructive"});const s=await hy(m.store_id,f,g);if(!s.available)return void N({title:"Stock insuffisant",description:`Stock disponible: ${s.current_stock}, Quantit demande: ${g}`,variant:"destructive"});const r=u.find(s=>s.product.id===e.id&&s.unit_price===t);if(r){const s=r.quantity+g,a=await hy(m.store_id,f,s);if(!a.available)return void N({title:"Stock insuffisant",description:`Stock disponible: ${a.current_stock}, Quantit totale demande: ${s}`,variant:"destructive"});h(u.map(r=>r.product.id===e.id&&r.unit_price===t?{...r,quantity:s,total_price:s*t}:r))}else h([...u,{product:e,quantity:g,unit_price:t,total_price:g*t,discount_reason:t<e.current_sale_price?b:void 0}]);x(""),v(1),j(""),w("")},disabled:!f,className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Ajouter"]})})]})})]}),u.length>0&&K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsxs(Lh,{children:["Panier (",u.length," article",u.length>1?"s":"",")"]})}),K.jsxs(Fh,{children:[K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"Prix unitaire"}),K.jsx(ip,{children:"Quantit"}),K.jsx(ip,{children:"Total"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:u.map((e,t)=>K.jsxs(np,{children:[K.jsx(op,{children:K.jsxs("div",{children:[K.jsx("p",{className:"font-medium",children:e.product.name}),K.jsx("p",{className:"text-sm text-muted-foreground",children:e.product.sku}),e.discount_reason&&K.jsx(Jh,{variant:"secondary",className:"text-xs mt-1",children:e.discount_reason})]})}),K.jsx(op,{children:r(e.unit_price)}),K.jsx(op,{children:K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx(Hu,{type:"button",variant:"outline",size:"sm",onClick:()=>T(t,e.quantity-1),children:K.jsx(lr,{className:"w-3 h-3"})}),K.jsx("span",{className:"w-8 text-center",children:e.quantity}),K.jsx(Hu,{type:"button",variant:"outline",size:"sm",onClick:()=>T(t,e.quantity+1),children:K.jsx(xr,{className:"w-3 h-3"})})]})}),K.jsx(op,{className:"font-medium",children:r(e.total_price)}),K.jsx(op,{children:K.jsx(Hu,{type:"button",variant:"ghost",size:"sm",onClick:()=>C(t),children:K.jsx(qr,{className:"w-4 h-4"})})})]},t))})]}),K.jsxs("div",{className:"mt-4 space-y-2 text-right",children:[K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{children:"Sous-total:"}),K.jsx("span",{children:r(E())})]}),K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{children:"TVA (20%):"}),K.jsx("span",{children:r(M())})]}),K.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[K.jsx("span",{children:"Total:"}),K.jsx("span",{children:r(P())})]})]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"notes",children:"Notes"}),K.jsx(gp,{id:"notes",value:m.notes,onChange:e=>p(t=>({...t,notes:e.target.value})),placeholder:"Notes optionnelles..."})]}),K.jsxs("div",{className:"flex justify-end gap-2",children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsxs(Hu,{type:"submit",disabled:n||0===u.length,children:[n&&K.jsx(rr,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrer la vente"]})]})]})]})})}function fy(){var e,t;const{formatAmount:s}=Hh(),{userProfile:r}=Uu(),{toast:a}=At(),[n,i]=Ke.useState(""),[o,l]=Ke.useState([]),[c,d]=Ke.useState(!0),[u,h]=Ke.useState(null),[m,p]=Ke.useState(!1),[f,x]=Ke.useState(!1),[g,v]=Ke.useState(!1),[y,j]=Ke.useState(!1),[b,w]=Ke.useState(!1),[N,_]=Ke.useState(null),[k,S]=Ke.useState({dateRange:null,store:"all",paymentMethod:"all",status:"all"}),C=(null==r?void 0:r.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(r.role),T=(null==r?void 0:r.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(r.role);(null==r?void 0:r.role)&&["Manager","Admin","SuperAdmin"].includes(r.role);const E=(null==r?void 0:r.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(r.role),M=(null==r?void 0:r.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(r.role),P=(null==r?void 0:r.role)&&["Manager","Admin","SuperAdmin"].includes(r.role),A=(null==r?void 0:r.role)&&["Manager","Admin","SuperAdmin"].includes(r.role),D=e=>!!(null==r?void 0:r.id)&&(!!["Manager","Admin","SuperAdmin"].includes(r.role||"")||"Vendeur"===r.role&&e.sold_by===r.id);Ke.useEffect(()=>{T&&R()},[T]);const O=e=>!(!e||"object"!=typeof e)&&(!(!e.id||!e.sale_code)&&(!(!e.total_amount||e.total_amount<0)&&!!e.created_at)),R=async()=>{try{d(!0),h(null);let e=Fu.from("sales").select("\n          *,\n          sale_items(id, quantity, unit_price, total_price),\n          stores(name)\n        ").order("created_at",{ascending:!1});"Vendeur"===(null==r?void 0:r.role)&&(e=e.eq("sold_by",r.id));const{data:t,error:s}=await e;if(s)throw s;if(t&&t.length>0)if("Vendeur"===(null==r?void 0:r.role)){const e=t.map(e=>({...e,users:{id:r.id,first_name:r.first_name,last_name:r.last_name,email:r.email}}));l(e)}else{const e=[...new Set(t.map(e=>e.sold_by).filter(Boolean))];if(e.length>0){const{data:s,error:r}=await Fu.from("users").select("id, first_name, last_name, email").in("id",e);if(!r&&s){const e=new Map(s.map(e=>[e.id,e])),r=t.map(t=>({...t,users:e.get(t.sold_by)||null}));l(r)}else l(t)}else l(t)}else l([])}catch(e){h("Impossible de charger les ventes"),a({title:"Erreur",description:"Impossible de charger les ventes",variant:"destructive"})}finally{d(!1)}},I=()=>{C?p(!0):a({title:"Permission refuse",description:"Vous n'avez pas les permissions pour crer des ventes",variant:"destructive"})},L=e=>{var t,r;try{const n=`\n        ========================================\n        RECU DE VENTE - ${e.sale_code}\n        ========================================\n        \n        Date: ${new Date(e.created_at).toLocaleDateString("fr-FR")}\n        Heure: ${new Date(e.created_at).toLocaleTimeString("fr-FR")}\n        \n        Client: ${e.customer_name||"Client anonyme"}\n        Magasin: ${(null==(t=e.stores)?void 0:t.name)||"N/A"}\n        Vendeur: ${e.users?`${e.users.first_name||""} ${e.users.last_name||""}`.trim()||e.users.email:"N/A"}\n        \n        ========================================\n        PRODUITS:\n        ${(null==(r=e.sale_items)?void 0:r.map(e=>`${e.product_name||"Produit"} - Qty: ${e.quantity} x ${s(e.unit_price)} = ${s(e.total_price)}`).join("\n"))||"Aucun dtail produit"}\n        ========================================\n        \n        TOTAL: ${s(e.total_amount)}\n        Paiement: ${q(e.payment_method)}\n        Statut: ${e.status||"completed"}\n        \n        ========================================\n        Merci de votre achat !\n        ========================================\n      `,i=window.open("","_blank");i&&(i.document.write(`\n          <html>\n            <head>\n              <title>Reu - ${e.sale_code}</title>\n              <style>\n                body { font-family: monospace; font-size: 12px; line-height: 1.4; }\n                .receipt { white-space: pre-line; }\n              </style>\n            </head>\n            <body>\n              <div class="receipt">${n}</div>\n              <script>window.print(); window.close();<\/script>\n            </body>\n          </html>\n        `),i.document.close(),a({title:"Impression lance",description:"Le reu a t envoy  l'imprimante"}))}catch(n){a({title:"Erreur d'impression",description:"Impossible d'imprimer le reu",variant:"destructive"})}},q=e=>{switch(e){case"card":return"Carte";case"cash":return"Espces";case"check":return"Chque";case"transfer":return"Virement";default:return e}},F=e=>{switch(e){case"completed":return K.jsx(Jh,{variant:"default",children:"Pay"});case"pending":return K.jsx(Jh,{variant:"secondary",children:"En attente"});case"cancelled":return K.jsx(Jh,{variant:"destructive",children:"Annul"});default:return K.jsx(Jh,{variant:"outline",children:e})}},z=()=>{S({dateRange:null,store:"all",paymentMethod:"all",status:"all"})},$=Ke.useMemo(()=>{var e,t;let s=o.filter(O).filter(e=>{var t,s;return""===n||(null==(t=e.sale_code)?void 0:t.toLowerCase().includes(n.toLowerCase()))||(null==(s=e.customer_name)?void 0:s.toLowerCase().includes(n.toLowerCase()))});return k.store&&"all"!==k.store&&(s=s.filter(e=>{var t;return(null==(t=e.stores)?void 0:t.name)===k.store})),k.paymentMethod&&"all"!==k.paymentMethod&&(s=s.filter(e=>e.payment_method===k.paymentMethod)),k.status&&"all"!==k.status&&(s=s.filter(e=>(e.status||"completed")===k.status)),(null==(e=k.dateRange)?void 0:e.from)&&(s=s.filter(e=>new Date(e.created_at)>=k.dateRange.from)),(null==(t=k.dateRange)?void 0:t.to)&&(s=s.filter(e=>new Date(e.created_at)<=k.dateRange.to)),s},[o,n,k]),{totalSales:W,averageTicket:U,pendingSales:V}=Ke.useMemo(()=>{const e=o.reduce((e,t)=>e+(t.total_amount||0),0);return{totalSales:e,averageTicket:o.length>0?e/o.length:0,pendingSales:o.filter(e=>"pending"===e.status).length}},[o]),B=Ke.useMemo(()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(t.getTime()-864e5),r=new Date(t.getTime()-1728e5),a=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(t.getTime()-6048e5),i=o.filter(e=>{const s=new Date(e.created_at);return s>=t&&s<new Date(t.getTime()+864e5)}),l=o.filter(e=>{const r=new Date(e.created_at);return r>=s&&r<t}),c=o.filter(e=>{const t=new Date(e.created_at);return t>=r&&t<s}),d=o.filter(e=>new Date(e.created_at)>=a),u=o.filter(e=>new Date(e.created_at)>=n);return{todayProductsSold:i.reduce((e,t)=>{var s;return e+((null==(s=t.sale_items)?void 0:s.reduce((e,t)=>e+(t.quantity||0),0))||0)},0),yesterdayProductsSold:l.reduce((e,t)=>{var s;return e+((null==(s=t.sale_items)?void 0:s.reduce((e,t)=>e+(t.quantity||0),0))||0)},0),beforeYesterdayProductsSold:c.reduce((e,t)=>{var s;return e+((null==(s=t.sale_items)?void 0:s.reduce((e,t)=>e+(t.quantity||0),0))||0)},0),monthlyProductsSold:d.reduce((e,t)=>{var s;return e+((null==(s=t.sale_items)?void 0:s.reduce((e,t)=>e+(t.quantity||0),0))||0)},0),weeklyProductsSold:u.reduce((e,t)=>{var s;return e+((null==(s=t.sale_items)?void 0:s.reduce((e,t)=>e+(t.quantity||0),0))||0)},0),todaySales:i.reduce((e,t)=>e+(t.total_amount||0),0),todayCount:i.length,monthlySales:d.reduce((e,t)=>e+(t.total_amount||0),0),weeklySales:u.reduce((e,t)=>e+(t.total_amount||0),0),yesterdaySales:l.reduce((e,t)=>e+(t.total_amount||0),0),beforeYesterdaySales:c.reduce((e,t)=>e+(t.total_amount||0),0)}},[o]),H=Ke.useMemo(()=>{const e=o.map(e=>{var t;return null==(t=e.stores)?void 0:t.name}).filter(Boolean);return[...new Set(e)]},[o]);return K.jsxs("div",{className:"space-y-6 p-6",children:[K.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[K.jsxs("div",{children:[K.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Ventes"}),K.jsx("p",{className:"text-muted-foreground",children:"Grez vos ventes et transactions"})]}),C&&K.jsxs(Hu,{onClick:I,className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouvelle vente"]})]}),u?K.jsx(Rh,{className:"bg-destructive/10 border-destructive",children:K.jsxs(Fh,{className:"pt-6",children:[K.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[K.jsx(Ts,{className:"w-5 h-5"}),K.jsx("span",{className:"font-medium",children:"Erreur de chargement"})]}),K.jsx("p",{className:"text-sm text-destructive/80 mt-2",children:u}),K.jsxs(Hu,{onClick:()=>{h(null),T&&R()},variant:"outline",size:"sm",className:"mt-3",children:[K.jsx(vr,{className:"w-4 h-4 mr-2"}),"Ressayer"]})]})}):K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Ventes du jour"}),K.jsx(Er,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:B.todayProductsSold}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[s(B.todaySales)," de chiffre d'affaires"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Chiffre d'affaires"}),K.jsx(Ks,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:s(B.todaySales)}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[B.todayProductsSold," produits vendus"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Nombre de ventes"}),K.jsx(Rr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:B.todayCount}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[s(B.todaySales)," de chiffre d'affaires"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Panier moyen"}),K.jsx(Bs,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:s(U)}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[B.todayProductsSold," produits vendus"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"En attente"}),K.jsx(Ts,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:V}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[s(B.todaySales)," de chiffre d'affaires"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total du mois"}),K.jsx(Rs,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:s(B.monthlySales)}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[B.monthlyProductsSold," produits vendus"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total 7 derniers jours"}),K.jsx(Er,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:s(B.weeklySales)}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[B.weeklyProductsSold," produits vendus"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total hier"}),K.jsx(Rs,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:s(B.yesterdaySales)}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[B.yesterdayProductsSold," produits vendus"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total avant-hier"}),K.jsx(Rs,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:s(B.beforeYesterdaySales)}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[B.beforeYesterdayProductsSold," produits vendus"]})]})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher une vente...",value:n,onChange:e=>i(e.target.value),className:"pl-10"})]}),K.jsxs(Av,{open:f,onOpenChange:x,children:[K.jsx(Dv,{asChild:!0,children:K.jsxs(Hu,{variant:"outline",size:"sm",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})}),K.jsx(Ov,{className:"w-80",align:"end",children:K.jsxs("div",{className:"space-y-4",children:[K.jsx("h4",{className:"font-medium leading-none",children:"Filtres"}),K.jsxs("div",{className:"space-y-2",children:[K.jsx("label",{className:"text-sm font-medium",children:"Priode"}),K.jsx(ov,{mode:"range",selected:k.dateRange,onSelect:e=>S(t=>({...t,dateRange:e})),locale:ep,className:"rounded-md border"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx("label",{className:"text-sm font-medium",children:"Magasin"}),K.jsxs(If,{value:k.store,onValueChange:e=>S(t=>({...t,store:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Tous les magasins"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les magasins"}),H.map(e=>K.jsx(Wf,{value:e,children:e},e))]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx("label",{className:"text-sm font-medium",children:"Mthode de paiement"}),K.jsxs(If,{value:k.paymentMethod,onValueChange:e=>S(t=>({...t,paymentMethod:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Toutes les mthodes"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Toutes les mthodes"}),K.jsx(Wf,{value:"cash",children:"Espces"}),K.jsx(Wf,{value:"card",children:"Carte"}),K.jsx(Wf,{value:"check",children:"Chque"}),K.jsx(Wf,{value:"transfer",children:"Virement"})]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx("label",{className:"text-sm font-medium",children:"Statut"}),K.jsxs(If,{value:k.status,onValueChange:e=>S(t=>({...t,status:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Tous les statuts"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les statuts"}),K.jsx(Wf,{value:"completed",children:"Pay"}),K.jsx(Wf,{value:"pending",children:"En attente"}),K.jsx(Wf,{value:"cancelled",children:"Annul"})]})]})]}),K.jsxs("div",{className:"flex gap-2",children:[K.jsx(Hu,{variant:"outline",size:"sm",onClick:z,className:"flex-1",children:"Effacer"}),K.jsx(Hu,{size:"sm",onClick:()=>x(!1),className:"flex-1",children:"Appliquer"})]})]})})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Historique des ventes"}),K.jsx(qh,{children:"Liste de toutes vos transactions"})]}),K.jsx(Fh,{children:c?K.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((e,t)=>K.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-28 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-16 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-8 rounded"})]},t))}):0===$.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(Er,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),n||Object.values(k).some(e=>"all"!==e&&null!==e)?K.jsxs(K.Fragment,{children:[K.jsx("p",{className:"text-muted-foreground mb-2",children:"Aucune vente trouve avec les critres actuels"}),K.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Essayez de modifier vos filtres ou votre recherche"}),K.jsxs(Hu,{onClick:z,variant:"outline",className:"gap-2",children:[K.jsx(vr,{className:"w-4 h-4"}),"Effacer les filtres"]})]}):K.jsxs(K.Fragment,{children:[K.jsx("p",{className:"text-muted-foreground mb-4",children:"Aucune vente enregistre"}),C&&K.jsx(Hu,{onClick:I,variant:"outline",children:"Crer votre premire vente"})]})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Code"}),K.jsx(ip,{children:"Client"}),K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Montant"}),K.jsx(ip,{children:"Paiement"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Date"}),K.jsx(ip,{children:"Vendeur"}),K.jsx(ip,{children:"Quantit vendue"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:$.map(e=>{var t,r,n;return K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.sale_code}),K.jsx(op,{children:e.customer_name||"Client anonyme"}),K.jsx(op,{children:null==(t=e.stores)?void 0:t.name}),K.jsx(op,{className:"font-medium",children:s(e.total_amount)}),K.jsx(op,{children:K.jsxs("div",{className:"flex items-center gap-1",children:[(n=e.payment_method,"card"===n?K.jsx(Bs,{className:"w-3 h-3"}):K.jsx(Ks,{className:"w-3 h-3"})),K.jsx("span",{className:"text-sm",children:q(e.payment_method)})]})}),K.jsx(op,{children:F(e.status||"completed")}),K.jsx(op,{children:new Date(e.created_at).toLocaleDateString()}),K.jsx(op,{className:"font-medium",children:e.users&&(`${e.users.first_name||""} ${e.users.last_name||""}`.trim()||e.users.email)||"Utilisateur inconnu"}),K.jsx(op,{className:"font-medium",children:(null==(r=e.sale_items)?void 0:r.reduce((e,t)=>e+t.quantity,0))||0}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Sh,{onClick:()=>(e=>{E?(_(e),v(!0)):a({title:"Permission refuse",description:"Vous n'avez pas les permissions pour voir les dtails",variant:"destructive"})})(e),children:"Voir dtails"}),K.jsx(Sh,{onClick:()=>(e=>{M?L(e):a({title:"Permission refuse",description:"Vous n'avez pas les permissions pour imprimer",variant:"destructive"})})(e),children:"Imprimer reu"}),(P||D(e))&&K.jsx(Sh,{onClick:()=>(e=>{P||D(e)?(_(e),j(!0)):a({title:"Permission refuse",description:"Vous n'avez pas les permissions pour grer les retours",variant:"destructive"})})(e),children:"Retour/change"}),(A||D(e))&&K.jsx(Sh,{className:"text-destructive",onClick:()=>(e=>{A||D(e)?(_(e),w(!0)):a({title:"Permission refuse",description:"Vous n'avez pas les permissions pour annuler les ventes",variant:"destructive"})})(e),children:"Annuler"})]})]})})]},e.id)})})]})})]})]}),K.jsx(py,{open:m,onOpenChange:p,onSuccess:R}),g&&N&&K.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:K.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[K.jsxs("div",{className:"flex justify-between items-center mb-4",children:[K.jsxs("h2",{className:"text-xl font-bold",children:["Dtails de la vente ",N.sale_code]}),K.jsx(Hu,{variant:"ghost",onClick:()=>v(!1),children:""})]}),K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx("label",{className:"font-medium text-sm text-gray-600",children:"Code de vente"}),K.jsx("p",{className:"text-lg",children:N.sale_code})]}),K.jsxs("div",{children:[K.jsx("label",{className:"font-medium text-sm text-gray-600",children:"Date"}),K.jsx("p",{className:"text-lg",children:new Date(N.created_at).toLocaleDateString("fr-FR")})]}),K.jsxs("div",{children:[K.jsx("label",{className:"font-medium text-sm text-gray-600",children:"Client"}),K.jsx("p",{className:"text-lg",children:N.customer_name||"Client anonyme"})]}),K.jsxs("div",{children:[K.jsx("label",{className:"font-medium text-sm text-gray-600",children:"Magasin"}),K.jsx("p",{className:"text-lg",children:(null==(e=N.stores)?void 0:e.name)||"N/A"})]}),K.jsxs("div",{children:[K.jsx("label",{className:"font-medium text-sm text-gray-600",children:"Vendeur"}),K.jsx("p",{className:"text-lg",children:N.users&&(`${N.users.first_name||""} ${N.users.last_name||""}`.trim()||N.users.email)||"Utilisateur inconnu"})]}),K.jsxs("div",{children:[K.jsx("label",{className:"font-medium text-sm text-gray-600",children:"Statut"}),K.jsx("div",{className:"mt-1",children:F(N.status||"completed")})]})]}),K.jsxs("div",{children:[K.jsx("label",{className:"font-medium text-sm text-gray-600",children:"Produits vendus"}),K.jsx("div",{className:"mt-2 space-y-2",children:(null==(t=N.sale_items)?void 0:t.map((e,t)=>K.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[K.jsxs("div",{children:[K.jsxs("span",{className:"font-medium",children:["Produit #",t+1]}),K.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["Qty: ",e.quantity," x ",s(e.unit_price)]})]}),K.jsx("span",{className:"font-bold",children:s(e.total_price)})]},t)))||K.jsx("p",{className:"text-gray-500",children:"Aucun dtail produit disponible"})})]}),K.jsxs("div",{className:"border-t pt-4",children:[K.jsxs("div",{className:"flex justify-between items-center text-xl font-bold",children:[K.jsx("span",{children:"Total"}),K.jsx("span",{children:s(N.total_amount)})]}),K.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Paiement: ",q(N.payment_method)]})]})]}),K.jsx("div",{className:"flex justify-end gap-2 mt-6",children:K.jsx(Hu,{variant:"outline",onClick:()=>v(!1),children:"Fermer"})})]})}),y&&N&&K.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:K.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[K.jsxs("div",{className:"flex justify-between items-center mb-4",children:[K.jsx("h2",{className:"text-xl font-bold",children:"Retour/change"}),K.jsx(Hu,{variant:"ghost",onClick:()=>j(!1),children:""})]}),K.jsxs("div",{className:"space-y-4",children:[K.jsxs("p",{className:"text-gray-600",children:["Vente: ",K.jsx("span",{className:"font-medium",children:N.sale_code})]}),K.jsxs("p",{className:"text-gray-600",children:["Client: ",K.jsx("span",{className:"font-medium",children:N.customer_name||"Client anonyme"})]}),K.jsxs("p",{className:"text-gray-600",children:["Montant: ",K.jsx("span",{className:"font-medium",children:s(N.total_amount)})]}),K.jsxs("div",{className:"text-center py-8",children:[K.jsx(Ts,{className:"w-16 h-16 text-orange-500 mx-auto mb-4"}),K.jsx("p",{className:"text-gray-600",children:"Cette fonctionnalit sera bientt disponible pour grer les retours et changes."})]})]}),K.jsx("div",{className:"flex justify-end gap-2 mt-6",children:K.jsx(Hu,{variant:"outline",onClick:()=>j(!1),children:"Fermer"})})]})}),b&&N&&K.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:K.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[K.jsxs("div",{className:"flex justify-between items-center mb-4",children:[K.jsx("h2",{className:"text-xl font-bold",children:"Annuler la vente"}),K.jsx(Hu,{variant:"ghost",onClick:()=>w(!1),children:""})]}),K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"text-center py-4",children:[K.jsx(Ts,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),K.jsx("p",{className:"text-gray-600 mb-2",children:"tes-vous sr de vouloir annuler cette vente ?"}),K.jsxs("p",{className:"text-sm text-gray-500",children:[K.jsx("strong",{children:"Vente:"})," ",N.sale_code,K.jsx("br",{}),K.jsx("strong",{children:"Client:"})," ",N.customer_name||"Client anonyme",K.jsx("br",{}),K.jsx("strong",{children:"Montant:"})," ",s(N.total_amount)]})]}),K.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:K.jsx("p",{className:"text-sm text-red-700",children:" Cette action est irrversible. La vente sera marque comme annule."})})]}),K.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[K.jsx(Hu,{variant:"outline",onClick:()=>w(!1),children:"Annuler"}),K.jsxs(Hu,{variant:"destructive",onClick:async()=>{if(N)try{const{error:e}=await Fu.from("sales").update({status:"cancelled",updated_at:(new Date).toISOString()}).eq("id",N.id);if(e)throw e;a({title:"Vente annule",description:"La vente a t annule avec succs"}),w(!1),_(null),R()}catch(e){a({title:"Erreur",description:"Impossible d'annuler la vente",variant:"destructive"})}},className:"gap-2",children:[K.jsx(Ts,{className:"w-4 h-4"}),"Confirmer l'annulation"]})]})]})})]})}function xy({open:e,onOpenChange:t,onSuccess:s}){const{user:r,userProfile:a}=Uu(),[n,i]=Ke.useState(!1),[o,l]=Ke.useState(!1),[c,d]=Ke.useState(""),[u,h]=Ke.useState(null),[m,p]=Ke.useState([]),[f,x]=Ke.useState({returned_product_id:"",returned_quantity:1,product_condition:"good",new_product_id:"",new_quantity:1,reason:""}),{toast:g}=At();Ke.useEffect(()=>{e&&(v(),y())},[e]);const v=async()=>{try{const{data:e,error:t}=await Fu.from("products").select("id, name, sku, current_sale_price").eq("is_active",!0).order("name");if(t)throw t;p(e||[])}catch(e){g({title:"Erreur",description:"Impossible de charger les produits",variant:"destructive"})}},y=()=>{d(""),h(null),x({returned_product_id:"",returned_quantity:1,product_condition:"good",new_product_id:"",new_quantity:1,reason:""})},j=()=>{if(!f.new_product_id||!f.returned_product_id)return 0;const e=null==u?void 0:u.sale_items.find(e=>e.product_id===f.returned_product_id),t=m.find(e=>e.id===f.new_product_id);if(!e||!t)return 0;const s=e.unit_price*f.returned_quantity;return t.current_sale_price*f.new_quantity-s},b=null==u?void 0:u.sale_items.find(e=>e.product_id===f.returned_product_id),w=m.find(e=>e.id===f.new_product_id),N=j();return K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[K.jsxs(mp,{children:[K.jsxs(fp,{className:"flex items-center gap-2",children:[K.jsx(vr,{className:"w-5 h-5"}),"Nouveau Retour/change"]}),K.jsx(xp,{children:"Traiter un retour ou un change de produit"})]}),K.jsxs("div",{className:"space-y-6",children:[K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsx(Lh,{children:"1. Rechercher la vente"})}),K.jsxs(Fh,{className:"space-y-4",children:[K.jsxs("div",{className:"flex gap-2",children:[K.jsxs("div",{className:"flex-1",children:[K.jsx(Oh,{htmlFor:"sale_code",children:"Code de vente"}),K.jsx(Yu,{id:"sale_code",value:c,onChange:e=>d(e.target.value),placeholder:"Ex: VTE123456"})]}),K.jsx("div",{className:"flex items-end",children:K.jsxs(Hu,{type:"button",onClick:async()=>{if(c.trim()){l(!0);try{const{data:e,error:t}=await Fu.from("sales").select("\n          *,\n          sale_items (\n            id,\n            product_id,\n            quantity,\n            unit_price,\n            products (\n              id,\n              name,\n              sku\n            )\n          )\n        ").eq("sale_code",c.trim()).single();if(t)throw t;e?(h(e),g({title:"Vente trouve",description:`Vente ${e.sale_code} trouve`})):g({title:"Vente non trouve",description:"Aucune vente avec ce code",variant:"destructive"})}catch(e){const t=Uf(e);g({title:"Erreur",description:t,variant:"destructive"})}finally{l(!1)}}else g({title:"Code requis",description:"Veuillez saisir un code de vente",variant:"destructive"})},disabled:o,children:[o?K.jsx(rr,{className:"mr-2 h-4 w-4 animate-spin"}):K.jsx(br,{className:"mr-2 h-4 w-4"}),"Rechercher"]})})]}),u&&K.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[K.jsx("h4",{className:"font-medium mb-2",children:"Informations de la vente"}),K.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[K.jsxs("div",{children:[K.jsxs("p",{children:[K.jsx("strong",{children:"Code:"})," ",u.sale_code]}),K.jsxs("p",{children:[K.jsx("strong",{children:"Date:"})," ",new Date(u.created_at).toLocaleDateString()]})]}),K.jsxs("div",{children:[K.jsxs("p",{children:[K.jsx("strong",{children:"Client:"})," ",u.customer_name||"Client anonyme"]}),K.jsxs("p",{children:[K.jsx("strong",{children:"Email:"})," ",u.customer_email||"Non renseign"]})]})]})]})]})]}),u&&K.jsxs("form",{onSubmit:async e=>{var r;if(e.preventDefault(),u&&f.returned_product_id&&f.reason){i(!0);try{const e=`RET${Date.now().toString().slice(-6)}${Math.random().toString(36).substring(2,5).toUpperCase()}`,a=j(),{error:n}=await Fu.from("returns_exchanges").insert({return_code:e,sale_id:u.id,original_sale_code:u.sale_code,returned_product_id:f.returned_product_id,returned_quantity:f.returned_quantity,product_condition:f.product_condition,new_product_id:f.new_product_id||null,new_quantity:f.new_quantity||0,price_difference:a,reason:f.reason,processed_by:null==(r=(await Fu.auth.getUser()).data.user)?void 0:r.id});if(n)throw n;g({title:"Retour/change enregistr",description:`Code: ${e}`}),s(),t(!1)}catch(a){const e=Uf(a);g({title:"Erreur",description:e,variant:"destructive"})}finally{i(!1)}}else g({title:"Donnes manquantes",description:"Veuillez remplir tous les champs requis",variant:"destructive"})},className:"space-y-6",children:[K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsx(Lh,{children:"2. Produit  retourner"})}),K.jsx(Fh,{className:"space-y-4",children:K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Produit"}),K.jsxs(If,{value:f.returned_product_id,onValueChange:e=>x(t=>({...t,returned_product_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner"})}),K.jsx($f,{children:u.sale_items.map(e=>K.jsxs(Wf,{value:e.product_id,children:[e.products.name," - ",e.products.sku," (Qt: ",e.quantity,")"]},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Quantit  retourner"}),K.jsx(Yu,{type:"number",min:"1",max:(null==b?void 0:b.quantity)||1,value:f.returned_quantity,onChange:e=>x(t=>({...t,returned_quantity:parseInt(e.target.value)||1}))})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"tat du produit"}),K.jsxs(If,{value:f.product_condition,onValueChange:e=>x(t=>({...t,product_condition:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"good",children:"Bon tat"}),K.jsx(Wf,{value:"damaged",children:"Endommag"}),K.jsx(Wf,{value:"defective",children:"Dfectueux"})]})]})]})]})})]}),K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsx(Lh,{children:"3. change (optionnel)"})}),K.jsxs(Fh,{className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Nouveau produit"}),K.jsxs(If,{value:f.new_product_id,onValueChange:e=>x(t=>({...t,new_product_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Aucun change"})}),K.jsx($f,{children:m.map(e=>K.jsxs(Wf,{value:e.id,children:[e.name," - ",e.sku," (",e.current_sale_price,")"]},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Quantit"}),K.jsx(Yu,{type:"number",min:"1",value:f.new_quantity,onChange:e=>x(t=>({...t,new_quantity:parseInt(e.target.value)||1})),disabled:!f.new_product_id})]})]}),f.new_product_id&&w&&b&&K.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[K.jsx("h4",{className:"font-medium mb-2",children:"Calcul de la diffrence"}),K.jsxs("div",{className:"text-sm space-y-1",children:[K.jsxs("p",{children:["Valeur retourne: ",(b.unit_price*f.returned_quantity).toFixed(2),""]}),K.jsxs("p",{children:["Valeur nouveau produit: ",(w.current_sale_price*f.new_quantity).toFixed(2),""]}),K.jsxs("p",{className:"font-medium "+(N>=0?"text-warning":"text-success"),children:["Diffrence: ",N>=0?"+":"",N.toFixed(2),"",N>0&&" ( payer)",N<0&&" ( rembourser)"]})]})]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"reason",children:"Raison du retour/change *"}),K.jsx(gp,{id:"reason",value:f.reason,onChange:e=>x(t=>({...t,reason:e.target.value})),placeholder:"Expliquez la raison du retour ou de l'change...",required:!0})]}),K.jsxs("div",{className:"flex justify-end gap-2",children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsxs(Hu,{type:"submit",disabled:n,children:[n&&K.jsx(rr,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrer"]})]})]})]})]})})}function gy(){const{formatAmount:e}=Hh(),{userProfile:t}=Uu(),{toast:s}=At(),[r,a]=Ke.useState(""),[n,i]=Ke.useState([]),[o,l]=Ke.useState(!0),[c,d]=Ke.useState(null),[u,h]=Ke.useState(!1),[m,p]=Ke.useState(null),f=(null==t?void 0:t.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(t.role),x=(null==t?void 0:t.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(t.role),g=(null==t?void 0:t.role)&&["Manager","Admin","SuperAdmin"].includes(t.role);Ke.useEffect(()=>{x&&v()},[x]);const v=async()=>{try{l(!0),d(null);let e=Fu.from("returns").select("\n          *,\n          original_sale:sales(sale_code, customer_name)\n        ").order("created_at",{ascending:!1});g||(e=e.eq("processed_by",null==t?void 0:t.id));const{data:s,error:r}=await e;if(r)throw r;i(s||[])}catch(e){d("Impossible de charger les retours"),s({title:"Erreur",description:"Impossible de charger les retours",variant:"destructive"})}finally{l(!1)}},y=e=>"exchange"===e.return_type?K.jsxs(Jh,{variant:"outline",className:"gap-1 bg-blue-50 text-blue-700 border-blue-200",children:[K.jsx(Es,{className:"w-3 h-3"}),"change"]}):K.jsxs(Jh,{variant:"outline",className:"gap-1",children:[K.jsx(yr,{className:"w-3 h-3"}),"Retour"]}),j=e=>{switch(e){case"completed":return K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:"Trait"});case"pending":return K.jsx(Jh,{variant:"secondary",children:"En cours"});case"refunded":return K.jsx(Jh,{variant:"outline",className:"bg-primary/10 text-primary",children:"Rembours"});default:return K.jsx(Jh,{variant:"outline",children:e})}},b=()=>{f?h(!0):s({title:"Permission refuse",description:"Vous n'avez pas les permissions pour crer des retours",variant:"destructive"})},{totalReturns:w,totalExchanges:N,totalAmount:_}=Ke.useMemo(()=>{const e=n.filter(e=>"exchange"!==e.return_type),t=n.filter(e=>"exchange"===e.return_type),s=n.reduce((e,t)=>e+Math.abs(t.price_difference||0),0);return{totalReturns:e.length,totalExchanges:t.length,totalAmount:s}},[n]),k=Ke.useMemo(()=>n.filter(e=>{var t,s,a,n;return""===r||(null==(t=e.return_code)?void 0:t.toLowerCase().includes(r.toLowerCase()))||(null==(a=null==(s=e.original_sale)?void 0:s.sale_code)?void 0:a.toLowerCase().includes(r.toLowerCase()))||(null==(n=e.customer_name)?void 0:n.toLowerCase().includes(r.toLowerCase()))}),[n,r]);return c&&!x?K.jsxs("div",{className:"space-y-6",children:[K.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(vr,{className:"w-7 h-7 text-primary"}),"Retours & changes"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les retours et changes de vos clients"})]})}),K.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Accs refus"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:"Vous n'avez pas les permissions pour accder  cette page"})]})]}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(vr,{className:"w-7 h-7 text-primary"}),"Retours & changes"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les retours et changes de vos clients"})]}),f&&K.jsxs(Hu,{onClick:b,size:"touch",className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouveau retour/change"]})]}),c?K.jsx(Rh,{className:"bg-destructive/10 border border-destructive/20",children:K.jsxs(Fh,{className:"p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Erreur de chargement"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:c}),K.jsxs(Hu,{onClick:()=>{d(null),v()},variant:"outline",className:"gap-2",children:[K.jsx(vr,{className:"w-4 h-4"}),"Ressayer"]})]})}):K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total retours"}),K.jsx(yr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:w}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Ce mois-ci"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total changes"}),K.jsx(Es,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:N}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Ce mois-ci"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Montant impact"}),K.jsx(vr,{className:"h-4 w-4 text-warning"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:e(_)}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Total transactions"})]})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un retour/change...",value:r,onChange:e=>a(e.target.value),className:"pl-10"})]}),K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Historique des retours et changes"}),K.jsx(qh,{children:"Liste de toutes les oprations de retour et d'change"})]}),K.jsx(Fh,{children:o?K.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((e,t)=>K.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-28 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-48 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-24 rounded"})]},t))}):0===k.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(vr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:"Aucun retour/change trouv"}),f&&K.jsx(Hu,{onClick:b,variant:"outline",children:"Crer un retour/change"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Code"}),K.jsx(ip,{children:"Type"}),K.jsx(ip,{children:"Vente origine"}),K.jsx(ip,{children:"Client"}),K.jsx(ip,{children:"Raison"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:k.map(e=>{var t;return K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.return_code}),K.jsx(op,{children:y(e)}),K.jsx(op,{children:(null==(t=e.original_sale)?void 0:t.sale_code)||"N/A"}),K.jsx(op,{children:e.customer_name||"Client anonyme"}),K.jsx(op,{className:"max-w-[150px] truncate",children:e.return_reason}),K.jsx(op,{children:j(e.return_status)}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Sh,{onClick:()=>(e=>{x?(p(e),s({title:"Fonctionnalit  venir",description:"Vue dtaille en cours de dveloppement"})):s({title:"Permission refuse",description:"Vous n'avez pas les permissions pour voir les dtails",variant:"destructive"})})(e),children:"Voir dtails"}),K.jsx(Sh,{onClick:()=>{s(x?{title:"Fonctionnalit  venir",description:"Impression en cours de dveloppement"}:{title:"Permission refuse",description:"Vous n'avez pas les permissions pour imprimer",variant:"destructive"})},children:"Imprimer bon"}),g&&K.jsx(Sh,{onClick:()=>(e=>{g?(p(e),h(!0)):s({title:"Permission refuse",description:"Vous n'avez pas les permissions pour modifier",variant:"destructive"})})(e),children:"Modifier"}),g&&K.jsx(Sh,{className:"text-destructive",onClick:()=>(async e=>{if(g)try{const{error:t}=await Fu.from("returns").update({return_status:"cancelled"}).eq("id",e.id);if(t)throw t;s({title:"Retour annul",description:"Le retour a t annul avec succs"}),v()}catch(t){s({title:"Erreur",description:"Impossible d'annuler le retour",variant:"destructive"})}else s({title:"Permission refuse",description:"Vous n'avez pas les permissions pour annuler",variant:"destructive"})})(e),children:"Annuler"})]})]})})]},e.id)})})]})})]})]}),K.jsx(xy,{open:u,onOpenChange:h,onSuccess:v})]})}function vy({open:e,onOpenChange:t,onSuccess:s,productId:r,storeId:a}){const[n,i]=Ke.useState(!1),[o,l]=Ke.useState([]),[c,d]=Ke.useState([]),[u,h]=Ke.useState(null),[m,p]=Ke.useState({product_id:r||"",store_id:a||"",adjustment_type:"set",quantity:0,reason:""}),{toast:f}=At();Ke.useEffect(()=>{e&&(x(),g(),y())},[e]),Ke.useEffect(()=>{m.product_id&&m.store_id&&v()},[m.product_id,m.store_id]);const x=async()=>{const{data:e,error:t}=await Fu.from("products").select("id, name, sku").order("name");t||l(e||[])},g=async()=>{const{data:e,error:t}=await Fu.from("stores").select("id, name").eq("is_active",!0).order("name");t||d(e||[])},v=async()=>{const{data:e,error:t}=await Fu.from("inventory").select("quantity").eq("product_id",m.product_id).eq("store_id",m.store_id).maybeSingle();h(t?0:(null==e?void 0:e.quantity)||0)},y=()=>{p({product_id:r||"",store_id:a||"",adjustment_type:"set",quantity:0,reason:""}),h(null)},j=()=>{if(null===u)return 0;switch(m.adjustment_type){case"set":return m.quantity;case"add":return u+m.quantity;case"subtract":return Math.max(0,u-m.quantity);default:return u}};return o.find(e=>e.id===m.product_id),c.find(e=>e.id===m.store_id),K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-md",children:[K.jsxs(mp,{children:[K.jsxs(fp,{className:"flex items-center gap-2",children:[K.jsx(dr,{className:"w-5 h-5"}),"Ajustement de Stock"]}),K.jsx(xp,{children:"Modifier la quantit en stock d'un produit"})]}),K.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m.product_id&&m.store_id&&m.reason){i(!0);try{const e=j(),{data:r}=await Fu.from("inventory").select("id").eq("product_id",m.product_id).eq("store_id",m.store_id).maybeSingle();if(r){const{error:t}=await Fu.from("inventory").update({quantity:e,updated_at:(new Date).toISOString()}).eq("id",r.id);if(t)throw t}else{const{error:t}=await Fu.from("inventory").insert({product_id:m.product_id,store_id:m.store_id,quantity:e});if(t)throw t}f({title:"Stock ajust",description:`Nouveau stock: ${e}`}),s(),t(!1)}catch(r){f({title:"Erreur",description:"Erreur lors de l'ajustement du stock",variant:"destructive"})}finally{i(!1)}}else f({title:"Donnes manquantes",description:"Veuillez remplir tous les champs requis",variant:"destructive"})},className:"space-y-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Produit"}),K.jsxs(If,{value:m.product_id,onValueChange:e=>p(t=>({...t,product_id:e})),disabled:!!r,children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un produit"})}),K.jsx($f,{children:o.map(e=>K.jsxs(Wf,{value:e.id,children:[e.name," - ",e.sku]},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Magasin"}),K.jsxs(If,{value:m.store_id,onValueChange:e=>p(t=>({...t,store_id:e})),disabled:!!a,children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un magasin"})}),K.jsx($f,{children:c.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]})]}),null!==u&&K.jsx("div",{className:"p-3 bg-muted rounded-lg",children:K.jsxs("p",{className:"text-sm",children:[K.jsx("strong",{children:"Stock actuel:"})," ",u," units"]})}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Type d'ajustement"}),K.jsxs(If,{value:m.adjustment_type,onValueChange:e=>p(t=>({...t,adjustment_type:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"set",children:"Dfinir la quantit"}),K.jsx(Wf,{value:"add",children:"Ajouter  la quantit"}),K.jsx(Wf,{value:"subtract",children:"Retirer de la quantit"})]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsxs(Oh,{children:["Quantit","set"===m.adjustment_type&&" (nouvelle quantit)","add"===m.adjustment_type&&" ( ajouter)","subtract"===m.adjustment_type&&" ( retirer)"]}),K.jsx(Yu,{type:"number",min:"0",value:m.quantity,onChange:e=>p(t=>({...t,quantity:parseInt(e.target.value)||0})),required:!0})]}),null!==u&&K.jsx("div",{className:"p-3 bg-primary/5 rounded-lg",children:K.jsxs("p",{className:"text-sm font-medium",children:["Nouveau stock: ",j()," units"]})}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"reason",children:"Raison de l'ajustement *"}),K.jsx(gp,{id:"reason",value:m.reason,onChange:e=>p(t=>({...t,reason:e.target.value})),placeholder:"Ex: Inventaire physique, casse, vol, correction d'erreur...",required:!0})]}),K.jsxs("div",{className:"flex justify-end gap-2",children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsxs(Hu,{type:"submit",disabled:n||null===u,children:[n&&K.jsx(rr,{className:"mr-2 h-4 w-4 animate-spin"}),"Ajuster le stock"]})]})]})]})})}function yy(){const[e,t]=Ke.useState(""),[s,r]=Ke.useState([]),[a,n]=Ke.useState(!0),[i,o]=Ke.useState(!1),[l,c]=Ke.useState(""),[d,u]=Ke.useState(""),{toast:h}=At();Ke.useEffect(()=>{m()},[]);const m=async()=>{try{const{data:e,error:t}=await Fu.from("product_stores").select("\n          *,\n          products(id, name, sku, alert_stock, categories(name)),\n          stores(name)\n        ").order("assigned_at",{ascending:!1});if(t)throw t;r(e||[])}catch(e){h({title:"Erreur",description:"Impossible de charger l'inventaire",variant:"destructive"})}finally{n(!1)}},p=e=>{var t;const s=e.current_stock,r=(null==(t=e.products)?void 0:t.alert_stock)||10;return 0===s?K.jsxs(Jh,{variant:"destructive",className:"gap-1",children:[K.jsx(Ts,{className:"w-3 h-3"}),"Rupture"]}):s<=r?K.jsxs(Jh,{variant:"secondary",className:"gap-1 bg-warning/10 text-warning",children:[K.jsx(Ts,{className:"w-3 h-3"}),"Stock faible"]}):K.jsxs(Jh,{variant:"default",className:"gap-1 bg-success text-success-foreground",children:[K.jsx(Ls,{className:"w-3 h-3"}),"Normal"]})},f=()=>{c(""),u(""),o(!0)},x=s.length,g=s.filter(e=>{var t;return e.current_stock<=((null==(t=e.products)?void 0:t.alert_stock)||10)&&e.current_stock>0}).length,v=s.filter(e=>0===e.current_stock).length,y=s.filter(t=>{var s,r;return""===e||(null==(s=t.products)?void 0:s.name.toLowerCase().includes(e.toLowerCase()))||(null==(r=t.products)?void 0:r.sku.toLowerCase().includes(e.toLowerCase()))});return K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(Ir,{className:"w-7 h-7 text-primary"}),"Inventaire"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez et suivez vos stocks en temps rel"})]}),K.jsxs(Hu,{onClick:f,size:"touch",className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Faire un inventaire"]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total produits"}),K.jsx(dr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:x}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Rfrences"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Stock faible"}),K.jsx(Ts,{className:"h-4 w-4 text-warning"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-warning",children:g}),K.jsx("p",{className:"text-xs text-muted-foreground",children:" rapprovisionner"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Ruptures"}),K.jsx(Ts,{className:"h-4 w-4 text-destructive"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-destructive",children:v}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Urgence"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Surstockage"}),K.jsx(dr,{className:"h-4 w-4 text-info"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-info",children:0}),K.jsx("p",{className:"text-xs text-muted-foreground",children:" couler"})]})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un produit...",value:e,onChange:e=>t(e.target.value),className:"pl-10"})]}),K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"tat des stocks"}),K.jsx(qh,{children:"Vue d'ensemble de votre inventaire"})]}),K.jsx(Fh,{children:a?K.jsx("div",{className:"flex justify-center py-12",children:K.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):0===y.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(Ir,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:"Aucun produit en stock"}),K.jsx(Hu,{onClick:f,variant:"outline",children:"Ajouter un stock"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"SKU"}),K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Stock actuel"}),K.jsx(ip,{children:"Seuil d'alerte"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Dernire MAJ"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:y.map(e=>{var t,s,r,a;return K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:null==(t=e.products)?void 0:t.name}),K.jsx(op,{children:null==(s=e.products)?void 0:s.sku}),K.jsx(op,{children:null==(r=e.stores)?void 0:r.name}),K.jsx(op,{className:"font-medium",children:e.current_stock}),K.jsx(op,{children:(null==(a=e.products)?void 0:a.alert_stock)||10}),K.jsx(op,{children:p(e)}),K.jsx(op,{children:new Date(e.assigned_at).toLocaleDateString()}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Sh,{onClick:()=>{return t=e.product_id,s=e.store_id,c(t),u(s),void o(!0);var t,s},children:"Ajuster stock"}),K.jsx(Sh,{children:"Voir historique"}),K.jsx(Sh,{children:"Dfinir seuils"}),K.jsx(Sh,{children:"Transfert magasin"})]})]})})]},e.id)})})]})})]}),K.jsx(vy,{open:i,onOpenChange:o,onSuccess:m,productId:l,storeId:d})]})}var jy="Checkbox",[by,wy]=Q(jy),[Ny,_y]=by(jy);function ky(e){const{__scopeCheckbox:t,checked:s,children:r,defaultChecked:a,disabled:n,form:i,name:o,onCheckedChange:l,required:c,value:d="on",internal_do_not_use_render:u}=e,[h,m]=te({prop:s,defaultProp:a??!1,onChange:l,caller:jy}),[p,f]=Ke.useState(null),[x,g]=Ke.useState(null),v=Ke.useRef(!1),y=!p||(!!i||!!p.closest("form")),j={checked:h,disabled:n,setChecked:m,control:p,setControl:f,name:o,form:i,value:d,hasConsumerStoppedPropagationRef:v,required:c,defaultChecked:!Oy(a)&&a,isFormControl:y,bubbleInput:x,setBubbleInput:g};return K.jsx(Ny,{scope:t,...j,children:Dy(u)?u(j):r})}var Sy="CheckboxTrigger",Cy=Ke.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:s,...r},a)=>{const{control:n,value:i,disabled:o,checked:l,required:c,setControl:d,setChecked:u,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:p}=_y(Sy,e),f=Z(a,d),x=Ke.useRef(l);return Ke.useEffect(()=>{const e=null==n?void 0:n.form;if(e){const t=()=>u(x.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[n,u]),K.jsx(J.button,{type:"button",role:"checkbox","aria-checked":Oy(l)?"mixed":l,"aria-required":c,"data-state":Ry(l),"data-disabled":o?"":void 0,disabled:o,value:i,...r,ref:f,onKeyDown:re(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:re(s,e=>{u(e=>!!Oy(e)||!e),p&&m&&(h.current=e.isPropagationStopped(),h.current||e.stopPropagation())})})});Cy.displayName=Sy;var Ty=Ke.forwardRef((e,t)=>{const{__scopeCheckbox:s,name:r,checked:a,defaultChecked:n,required:i,disabled:o,value:l,onCheckedChange:c,form:d,...u}=e;return K.jsx(ky,{__scopeCheckbox:s,checked:a,defaultChecked:n,disabled:o,required:i,onCheckedChange:c,name:r,form:d,value:l,internal_do_not_use_render:({isFormControl:e})=>K.jsxs(K.Fragment,{children:[K.jsx(Cy,{...u,ref:t,__scopeCheckbox:s}),e&&K.jsx(Ay,{__scopeCheckbox:s})]})})});Ty.displayName=jy;var Ey="CheckboxIndicator",My=Ke.forwardRef((e,t)=>{const{__scopeCheckbox:s,forceMount:r,...a}=e,n=_y(Ey,s);return K.jsx(se,{present:r||Oy(n.checked)||!0===n.checked,children:K.jsx(J.span,{"data-state":Ry(n.checked),"data-disabled":n.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});My.displayName=Ey;var Py="CheckboxBubbleInput",Ay=Ke.forwardRef(({__scopeCheckbox:e,...t},s)=>{const{control:r,hasConsumerStoppedPropagationRef:a,checked:n,defaultChecked:i,required:o,disabled:l,name:c,value:d,form:u,bubbleInput:h,setBubbleInput:m}=_y(Py,e),p=Z(s,m),f=yp(n),x=Ye(r);Ke.useEffect(()=>{const e=h;if(!e)return;const t=window.HTMLInputElement.prototype,s=Object.getOwnPropertyDescriptor(t,"checked").set,r=!a.current;if(f!==n&&s){const t=new Event("click",{bubbles:r});e.indeterminate=Oy(n),s.call(e,!Oy(n)&&n),e.dispatchEvent(t)}},[h,f,n,a]);const g=Ke.useRef(!Oy(n)&&n);return K.jsx(J.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??g.current,required:o,disabled:l,name:c,value:d,form:u,...t,tabIndex:-1,ref:p,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function Dy(e){return"function"==typeof e}function Oy(e){return"indeterminate"===e}function Ry(e){return Oy(e)?"indeterminate":e?"checked":"unchecked"}Ay.displayName=Py;const Iy=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Ty,{ref:s,className:Aa("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:K.jsx(My,{className:Aa("flex items-center justify-center text-current"),children:K.jsx(qs,{className:"h-4 w-4"})})}));function Ly({open:e,onOpenChange:t,onSuccess:s,user:r,mode:a}){const[n,i]=Ke.useState(!1),[o,l]=Ke.useState([]),[c,d]=Ke.useState({email:"",first_name:"",last_name:"",phone:"",role:"Vendeur",status:"pending",store_id:"",store_ids:[],password:""}),{toast:u}=At(),{userProfile:h}=Uu();Ke.useEffect(()=>{e&&(m(),"edit"===a&&r?(d({email:r.email||"",first_name:r.first_name||"",last_name:r.last_name||"",phone:r.phone||"",role:r.role||"Vendeur",status:r.status||"pending",store_id:"",store_ids:[],password:""}),f(r.id)):p())},[e,a,r]);const m=async()=>{const{data:e,error:t}=await Fu.from("stores").select("id, name").eq("is_active",!0).order("name");t||l(e||[])},p=()=>{d({email:"",first_name:"",last_name:"",phone:"",role:"Vendeur",status:"pending",store_id:"",store_ids:[],password:""})},f=async e=>{const{data:t}=await Fu.from("user_stores").select("store_id, is_primary").eq("user_id",e).order("is_primary",{ascending:!1}),s=(t||[]).map(e=>e.store_id),r=(t||[]).find(e=>e.is_primary);d(e=>({...e,store_ids:s,store_id:(null==r?void 0:r.store_id)??s[0]??""}))};return K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-md",children:[K.jsxs(mp,{children:[K.jsxs(fp,{className:"flex items-center gap-2",children:[K.jsx(Rr,{className:"w-5 h-5"}),"create"===a?"Nouvel Utilisateur":"Modifier l'Utilisateur"]}),K.jsx(xp,{children:"create"===a?"Crer un nouveau compte utilisateur":"Modifier les informations de l'utilisateur"})]}),K.jsxs("form",{onSubmit:async e=>{var n,o,l;if(e.preventDefault(),c.email&&c.first_name&&c.last_name)if("create"!==a||c.password){i(!0);try{if("create"===a){const{data:e}=await Fu.auth.getSession(),t=null==(n=e.session)?void 0:n.access_token,s=null==(o=e.session)?void 0:o.refresh_token,r=async()=>{t&&s&&await Fu.auth.setSession({access_token:t,refresh_token:s})};let a=null;const{data:i,error:d}=await Fu.auth.signUp({email:c.email,password:c.password,options:{data:{first_name:c.first_name,last_name:c.last_name}}});if(d){if(!d.message.includes("already registered"))throw d;{const{data:e}=await Fu.auth.signInWithPassword({email:c.email,password:c.password});a=(null==(l=e.user)?void 0:l.id)??null}}else i.user&&(a=i.user.id);if(await r(),a){const{data:e,error:t}=await Fu.from("users").upsert({auth_id:a,email:c.email,first_name:c.first_name,last_name:c.last_name,phone:c.phone||null,role:c.role,status:c.status},{onConflict:"auth_id"}).select("id").maybeSingle();if(t)throw t;if(null==e?void 0:e.id){const t=e.id;if(await Fu.from("user_stores").delete().eq("user_id",t),"Vendeur"===c.role){if(c.store_id){const{error:e}=await Fu.from("user_stores").insert({user_id:t,store_id:c.store_id,is_primary:!0,assigned_by:(null==h?void 0:h.id)||null});if(e)throw e}}else if("Manager"===c.role&&c.store_ids&&c.store_ids.length>0){const e=c.store_id&&c.store_ids.includes(c.store_id)?c.store_id:c.store_ids[0],s=c.store_ids.map(s=>({user_id:t,store_id:s,is_primary:s===e,assigned_by:(null==h?void 0:h.id)||null})),{error:r}=await Fu.from("user_stores").insert(s);if(r)throw r}}}}else{const{error:e}=await Fu.from("users").update({first_name:c.first_name,last_name:c.last_name,phone:c.phone||null,role:c.role,status:c.status}).eq("id",r.id);if(e)throw e;if(await Fu.from("user_stores").delete().eq("user_id",r.id),"Vendeur"===c.role){if(c.store_id){const{error:e}=await Fu.from("user_stores").insert({user_id:r.id,store_id:c.store_id,is_primary:!0,assigned_by:(null==h?void 0:h.id)||null});if(e)throw e}}else if("Manager"===c.role&&c.store_ids&&c.store_ids.length>0){const e=c.store_id&&c.store_ids.includes(c.store_id)?c.store_id:c.store_ids[0],t=c.store_ids.map(t=>({user_id:r.id,store_id:t,is_primary:t===e,assigned_by:(null==h?void 0:h.id)||null})),{error:s}=await Fu.from("user_stores").insert(t);if(s)throw s}}u({title:"create"===a?"Utilisateur cr":"Utilisateur modifi",description:"create"===a?"Le nouvel utilisateur a t cr avec succs":"Les modifications ont t enregistres"}),s(),t(!1)}catch(d){u({title:"Erreur",description:d.message||"Une erreur est survenue",variant:"destructive"})}finally{i(!1)}}else u({title:"Mot de passe requis",description:"Veuillez saisir un mot de passe",variant:"destructive"});else u({title:"Donnes manquantes",description:"Veuillez remplir tous les champs requis",variant:"destructive"})},className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"first_name",children:"Prnom *"}),K.jsx(Yu,{id:"first_name",value:c.first_name,onChange:e=>d(t=>({...t,first_name:e.target.value})),required:!0})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"last_name",children:"Nom *"}),K.jsx(Yu,{id:"last_name",value:c.last_name,onChange:e=>d(t=>({...t,last_name:e.target.value})),required:!0})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"email",children:"Email *"}),K.jsx(Yu,{id:"email",type:"email",value:c.email,onChange:e=>d(t=>({...t,email:e.target.value})),disabled:"edit"===a,required:!0})]}),"create"===a&&K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"password",children:"Mot de passe *"}),K.jsx(Yu,{id:"password",type:"password",value:c.password,onChange:e=>d(t=>({...t,password:e.target.value})),required:!0,minLength:6})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"phone",children:"Tlphone"}),K.jsx(Yu,{id:"phone",value:c.phone,onChange:e=>d(t=>({...t,phone:e.target.value}))})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Rle"}),K.jsxs(If,{value:c.role,onValueChange:e=>d(t=>({...t,role:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsx($f,{children:[{value:"Vendeur",label:"Vendeur"},{value:"Manager",label:"Manager"},{value:"Admin",label:"Admin"},{value:"SuperAdmin",label:"Super Admin"}].filter(e=>(e=>!!h&&("SuperAdmin"===h.role||"Admin"===h.role&&"SuperAdmin"!==e))(e.value)).map(e=>K.jsx(Wf,{value:e.value,children:e.label},e.value))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Statut"}),K.jsxs(If,{value:c.status,onValueChange:e=>d(t=>({...t,status:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"pending",children:"En attente"}),K.jsx(Wf,{value:"active",children:"Actif"}),K.jsx(Wf,{value:"rejected",children:"Rejet"})]})]})]}),"Vendeur"===c.role&&K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Magasin (un seul)"}),K.jsxs(If,{value:c.store_id,onValueChange:e=>d(t=>({...t,store_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Aucun magasin assign"})}),K.jsx($f,{children:o.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]})]}),"Manager"===c.role&&K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Magasins (plusieurs)"}),K.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-48 overflow-auto p-2 border rounded-md",children:o.map(e=>{const t=c.store_ids.includes(e.id);return K.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[K.jsx(Iy,{checked:t,onCheckedChange:t=>((e,t)=>{d(s=>{const r=new Set(s.store_ids);t?r.add(e):r.delete(e);const a=Array.from(r);return{...s,store_ids:a,store_id:a.includes(s.store_id)?s.store_id:a[0]??""}})})(e.id,Boolean(t))}),K.jsx("span",{children:e.name})]},e.id)})}),c.store_ids.length>0&&K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Magasin principal"}),K.jsxs(If,{value:c.store_id,onValueChange:e=>d(t=>({...t,store_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsx($f,{children:c.store_ids.map(e=>{const t=o.find(t=>t.id===e);return t?K.jsx(Wf,{value:e,children:t.name},e):null})})]})]})]}),K.jsxs("div",{className:"flex justify-end gap-2",children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsxs(Hu,{type:"submit",disabled:n,children:[n&&K.jsx(rr,{className:"mr-2 h-4 w-4 animate-spin"}),"create"===a?"Crer":"Modifier"]})]})]})]})})}function qy(){const[e,t]=Ke.useState(""),[s,r]=Ke.useState([]),[a,n]=Ke.useState(!0),[i,o]=Ke.useState(!1),[l,c]=Ke.useState(null),[d,u]=Ke.useState("create"),{toast:h}=At(),{userProfile:m}=Uu();Ke.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:e,error:t}=await Fu.from("users").select("\n          *,\n          user_stores:user_stores!user_id (\n            is_primary,\n            stores ( name )\n          )\n        ").order("created_at",{ascending:!1});if(t)throw t;const s=(e||[]).map(e=>({...e,stores:(e.user_stores||[]).sort((e,t)=>Number(t.is_primary)-Number(e.is_primary)).map(e=>{var t;return{name:(null==(t=e.stores)?void 0:t.name)||""}})}));r(s)}catch(e){h({title:"Erreur",description:"Impossible de charger les utilisateurs",variant:"destructive"})}finally{n(!1)}},f=e=>{switch(e){case"SuperAdmin":return K.jsxs(Jh,{variant:"default",className:"gap-1 bg-gradient-primary text-white",children:[K.jsx(Hs,{className:"w-3 h-3"}),"SuperAdmin"]});case"Admin":return K.jsxs(Jh,{variant:"default",className:"gap-1",children:[K.jsx(Hs,{className:"w-3 h-3"}),"Admin"]});case"Manager":return K.jsxs(Jh,{variant:"secondary",className:"gap-1",children:[K.jsx(Ar,{className:"w-3 h-3"}),"Manager"]});case"Vendeur":return K.jsxs(Jh,{variant:"outline",className:"gap-1",children:[K.jsx(Rr,{className:"w-3 h-3"}),"Vendeur"]});default:return K.jsx(Jh,{variant:"outline",children:e})}},x=e=>{switch(e){case"active":return K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:"Actif"});case"pending":return K.jsx(Jh,{variant:"secondary",children:"En attente"});case"rejected":return K.jsx(Jh,{variant:"destructive",children:"Rejet"});default:return K.jsx(Jh,{variant:"outline",children:e})}},g=()=>{c(null),u("create"),o(!0)},v=s.length,y=s.filter(e=>"active"===e.status).length,j=s.filter(e=>"pending"===e.status).length,b=s.filter(e=>"rejected"===e.status).length,w=s.filter(t=>""===e||`${t.first_name} ${t.last_name}`.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase()));return K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(Rr,{className:"w-7 h-7 text-primary"}),"Utilisateurs"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les comptes utilisateurs et leurs permissions"})]}),K.jsxs(Hu,{onClick:g,size:"touch",className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouvel utilisateur"]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total utilisateurs"}),K.jsx(Rr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:v}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Comptes crs"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Utilisateurs actifs"}),K.jsx(Ar,{className:"h-4 w-4 text-success"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-success",children:y}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Connects rcemment"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"En attente"}),K.jsx(Dr,{className:"h-4 w-4 text-warning"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-warning",children:j}),K.jsx("p",{className:"text-xs text-muted-foreground",children:" valider"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Inactifs"}),K.jsx(Dr,{className:"h-4 w-4 text-destructive"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-destructive",children:b}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Dsactivs"})]})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un utilisateur...",value:e,onChange:e=>t(e.target.value),className:"pl-10"})]}),K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Liste des utilisateurs"}),K.jsx(qh,{children:"Grez les comptes et permissions utilisateurs"})]}),K.jsx(Fh,{children:a?K.jsx("div",{className:"flex justify-center py-12",children:K.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):0===w.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(Rr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:"Aucun utilisateur trouv"}),K.jsx(Hu,{onClick:g,variant:"outline",children:"Crer un utilisateur"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Nom"}),K.jsx(ip,{children:"Email"}),K.jsx(ip,{children:"Rle"}),K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Cr le"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:w.map(e=>{var t,s;return K.jsxs(np,{children:[K.jsxs(op,{className:"font-medium",children:[e.first_name," ",e.last_name]}),K.jsx(op,{children:e.email}),K.jsx(op,{children:f(e.role)}),K.jsx(op,{children:(null==(t=e.stores)?void 0:t.map(e=>e.name).join(", "))||"Aucun"}),K.jsx(op,{children:x(e.status)}),K.jsx(op,{children:new Date(e.created_at).toLocaleDateString()}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",disabled:(s=e,!(m&&("SuperAdmin"===m.role||"Admin"===m.role&&"SuperAdmin"!==s.role))),children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Sh,{onClick:()=>(e=>{c(e),u("edit"),o(!0)})(e),children:"Modifier profil"}),K.jsx(Sh,{children:"Rinitialiser mot de passe"}),K.jsx(Sh,{className:"active"===e.status?"text-warning":"text-success",onClick:()=>(async e=>{const t="active"===e.status?"rejected":"active";try{const{error:s}=await Fu.from("users").update({status:t}).eq("id",e.id);if(s)throw s;h({title:"Statut mis  jour",description:"Utilisateur "+("active"===t?"activ":"dsactiv")}),p()}catch(s){h({title:"Erreur",description:"Impossible de modifier le statut",variant:"destructive"})}})(e),children:"active"===e.status?"Dsactiver":"Activer"}),K.jsx(Sh,{className:"text-destructive",children:"Supprimer"})]})]})})]},e.id)})})]})})]}),K.jsx(Ly,{open:i,onOpenChange:o,onSuccess:p,user:l,mode:d})]})}Iy.displayName=Ty.displayName;var Fy="Switch",[zy,$y]=Q(Fy),[Wy,Uy]=zy(Fy),Vy=Ke.forwardRef((e,t)=>{const{__scopeSwitch:s,name:r,checked:a,defaultChecked:n,required:i,disabled:o,value:l="on",onCheckedChange:c,form:d,...u}=e,[h,m]=Ke.useState(null),p=Z(t,e=>m(e)),f=Ke.useRef(!1),x=!h||(d||!!h.closest("form")),[g,v]=te({prop:a,defaultProp:n??!1,onChange:c,caller:Fy});return K.jsxs(Wy,{scope:s,checked:g,disabled:o,children:[K.jsx(J.button,{type:"button",role:"switch","aria-checked":g,"aria-required":i,"data-state":Gy(g),"data-disabled":o?"":void 0,disabled:o,value:l,...u,ref:p,onClick:re(e.onClick,e=>{v(e=>!e),x&&(f.current=e.isPropagationStopped(),f.current||e.stopPropagation())})}),x&&K.jsx(Yy,{control:h,bubbles:!f.current,name:r,value:l,checked:g,required:i,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});Vy.displayName=Fy;var By="SwitchThumb",Hy=Ke.forwardRef((e,t)=>{const{__scopeSwitch:s,...r}=e,a=Uy(By,s);return K.jsx(J.span,{"data-state":Gy(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:t})});Hy.displayName=By;var Yy=Ke.forwardRef(({__scopeSwitch:e,control:t,checked:s,bubbles:r=!0,...a},n)=>{const i=Ke.useRef(null),o=Z(i,n),l=yp(s),c=Ye(t);return Ke.useEffect(()=>{const e=i.current;if(!e)return;const t=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(t,"checked").set;if(l!==s&&a){const t=new Event("click",{bubbles:r});a.call(e,s),e.dispatchEvent(t)}},[l,s,r]),K.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:o,style:{...a.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function Gy(e){return e?"checked":"unchecked"}Yy.displayName="SwitchBubbleInput";var Ky=Vy,Jy=Hy;const Qy=Ke.forwardRef(({className:e,...t},s)=>K.jsx(Ky,{className:Aa("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:s,children:K.jsx(Jy,{className:Aa("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));function Xy({open:e,onOpenChange:t,store:s,onSuccess:r}){const[a,n]=Ke.useState(!1),[i,o]=Ke.useState({name:"",address:"",phone:"",email:"",is_active:!0}),{toast:l}=At();Ke.useEffect(()=>{o(s||{name:"",address:"",phone:"",email:"",is_active:!0})},[s]);return K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{children:[K.jsxs(mp,{children:[K.jsxs(fp,{children:[s?"Modifier":"Crer"," un magasin"]}),K.jsx(xp,{children:s?"Modifiez les informations du magasin":"Crez un nouveau magasin"})]}),K.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{if(null==s?void 0:s.id){const{error:e}=await Fu.from("stores").update({name:i.name,address:i.address||null,phone:i.phone||null,email:i.email||null,is_active:i.is_active}).eq("id",s.id);if(e)throw e;l({title:"Succs",description:"Magasin modifi avec succs"})}else{const{error:e}=await Fu.from("stores").insert({name:i.name,address:i.address||null,phone:i.phone||null,email:i.email||null,is_active:i.is_active});if(e)throw e;l({title:"Succs",description:"Magasin cr avec succs"})}r(),t(!1)}catch(a){l({title:"Erreur",description:a.message||"Erreur lors de l'enregistrement",variant:"destructive"})}finally{n(!1)}},children:[K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"name",children:"Nom du magasin *"}),K.jsx(Yu,{id:"name",value:i.name,onChange:e=>o({...i,name:e.target.value}),required:!0})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"address",children:"Adresse"}),K.jsx(gp,{id:"address",value:i.address||"",onChange:e=>o({...i,address:e.target.value}),rows:2})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"phone",children:"Tlphone"}),K.jsx(Yu,{id:"phone",type:"tel",value:i.phone||"",onChange:e=>o({...i,phone:e.target.value})})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"email",children:"Email"}),K.jsx(Yu,{id:"email",type:"email",value:i.email||"",onChange:e=>o({...i,email:e.target.value})})]})]}),K.jsxs("div",{className:"flex items-center space-x-2",children:[K.jsx(Qy,{id:"is_active",checked:i.is_active,onCheckedChange:e=>o({...i,is_active:e})}),K.jsx(Oh,{htmlFor:"is_active",children:"Magasin actif"})]})]}),K.jsxs(pp,{className:"mt-6",children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsx(Hu,{type:"submit",disabled:a,children:a?"Enregistrement...":"Enregistrer"})]})]})]})})}Qy.displayName=Ky.displayName;const Zy=async(e,t)=>{try{let s=Fu.from("stores").select("id, name").eq("is_active",!0).order("name");if("SuperAdmin"===t||"Admin"===t){const{data:e,error:t}=await s;if(t)throw t;return e||[]}if("Manager"===t||"Vendeur"===t){const{data:t,error:r}=await Fu.from("user_stores").select("store_id").eq("user_id",e);if(r)throw r;if(t&&t.length>0){const e=t.map(e=>e.store_id),{data:r,error:a}=await s.in("id",e);if(a)throw a;return r||[]}return[]}return[]}catch(s){return[]}},ej=async()=>{try{const{data:e,error:t}=await Fu.from("stores").select("id, name").eq("is_active",!0).order("name");if(t)throw t;return e||[]}catch(e){return[]}},tj=async(e,t,s,r)=>{try{const a=await(async(e,t,s)=>{try{if("SuperAdmin"===s||"Admin"===s)return!0;if("Manager"===s||"Vendeur"===s){const{data:s,error:r}=await Fu.from("user_stores").select("id").eq("user_id",e).eq("store_id",t).single();return!r&&!!s}return!1}catch(r){return!1}})(e,s,t);return a?s===r?{canCreate:!1,error:"Le magasin source et destination doivent tre diffrents"}:{canCreate:!0}:{canCreate:!1,error:"Vous n'avez pas accs au magasin source. Vous devez tre assign  ce magasin pour transfrer des produits."}}catch(a){return{canCreate:!1,error:"Erreur lors de la vrification des permissions"}}};function sj({open:e,onOpenChange:t,onSuccess:s}){const{toast:r}=At(),{user:a,userProfile:n}=Uu(),[i,o]=Ke.useState(!1),[l,c]=Ke.useState([]),[d,u]=Ke.useState([]),[h,m]=Ke.useState([]),[p,f]=Ke.useState(null),[x,g]=Ke.useState({source_store_id:"",destination_store_id:"",product_id:"",quantity:0,notes:""});Ke.useEffect(()=>{e&&(v(),y(),b())},[e]),Ke.useEffect(()=>{x.source_store_id&&x.product_id&&j()},[x.source_store_id,x.product_id]);const v=async()=>{try{const{data:e,error:t}=await Fu.from("products").select("id, name, sku").eq("is_active",!0).order("name");if(t)throw t;c(e||[])}catch(e){r({title:"Erreur",description:"Impossible de charger les produits",variant:"destructive"})}},y=async()=>{try{if(!(null==n?void 0:n.id)||!(null==n?void 0:n.role))return void r({title:"Erreur",description:"Informations utilisateur manquantes",variant:"destructive"});try{await ej()}catch(e){}const[t,s]=await Promise.all([Zy(n.id,n.role),ej()]);u(t),m(s),0===t.length&&r({title:"Attention",description:"Aucun magasin source accessible. Contactez votre administrateur.",variant:"destructive"}),0===s.length&&r({title:"Attention",description:"Aucun magasin destination disponible. Contactez votre administrateur.",variant:"destructive"})}catch(t){r({title:"Erreur",description:"Impossible de charger la liste des magasins",variant:"destructive"})}},j=async()=>{try{const{data:e,error:t}=await Fu.from("product_stores").select("current_stock").eq("product_id",x.product_id).eq("store_id",x.source_store_id).single();if(t)throw t;f((null==e?void 0:e.current_stock)||0)}catch(e){f(0)}},b=()=>{g({source_store_id:"",destination_store_id:"",product_id:"",quantity:0,notes:""}),f(null)};l.find(e=>e.id===x.product_id);const w=d.find(e=>e.id===x.source_store_id);return h.find(e=>e.id===x.destination_store_id),K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"max-w-md",children:[K.jsxs(mp,{children:[K.jsxs(fp,{className:"flex items-center gap-2",children:[K.jsx(Pr,{className:"w-5 h-5"}),"Transfert entre Magasins"]}),K.jsx(xp,{children:"Transfrer des produits d'un magasin  un autre"})]}),K.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),x.source_store_id&&x.destination_store_id&&x.product_id&&!(x.quantity<=0))if(x.source_store_id!==x.destination_store_id){if((null==n?void 0:n.id)&&(null==n?void 0:n.role)){const e=await tj(n.id,n.role,x.source_store_id,x.destination_store_id);if(!e.canCreate)return void r({title:"Permission refuse",description:e.error||"Vous n'avez pas les permissions pour crer ce transfert",variant:"destructive"})}if(a){o(!0);try{const e=await hy(x.source_store_id,x.product_id,x.quantity);if(!e.available)return void r({title:"Stock insuffisant",description:`Stock disponible: ${e.current_stock}, Quantit demande: ${x.quantity}`,variant:"destructive"});const n=await my({source_store_id:x.source_store_id,destination_store_id:x.destination_store_id,product_id:x.product_id,quantity:x.quantity,notes:x.notes,created_by:a.id});if(!n.success)throw new Error(n.error);r({title:"Transfert cr",description:`Transfert de ${x.quantity} units cr avec succs`}),s(),t(!1)}catch(i){r({title:"Erreur",description:"Erreur lors de la cration du transfert",variant:"destructive"})}finally{o(!1)}}else r({title:"Erreur",description:"Utilisateur non connect",variant:"destructive"})}else r({title:"Magasins identiques",description:"Le magasin source et destination ne peuvent pas tre identiques",variant:"destructive"});else r({title:"Donnes manquantes",description:"Veuillez remplir tous les champs requis",variant:"destructive"})},className:"space-y-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Magasin Source"}),K.jsxs(If,{value:x.source_store_id,onValueChange:e=>g(t=>({...t,source_store_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner le magasin source"})}),K.jsx($f,{children:d.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Magasin Destination"}),K.jsxs(If,{value:x.destination_store_id,onValueChange:e=>g(t=>({...t,destination_store_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner le magasin destination"})}),K.jsx($f,{children:h.filter(e=>e.id!==x.source_store_id).map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Produit"}),K.jsxs(If,{value:x.product_id,onValueChange:e=>g(t=>({...t,product_id:e})),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un produit"})}),K.jsx($f,{children:l.map(e=>K.jsxs(Wf,{value:e.id,children:[e.name," - ",e.sku]},e.id))})]})]}),null!==p&&K.jsx("div",{className:"p-3 bg-muted rounded-lg",children:K.jsxs("p",{className:"text-sm",children:[K.jsxs("strong",{children:["Stock disponible dans ",null==w?void 0:w.name,":"]})," ",p," units"]})}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"quantity",children:"Quantit  transfrer"}),K.jsx(Yu,{id:"quantity",type:"number",min:"1",max:p||void 0,value:x.quantity,onChange:e=>g(t=>({...t,quantity:parseInt(e.target.value)||0})),required:!0})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"notes",children:"Notes (optionnel)"}),K.jsx(gp,{id:"notes",value:x.notes,onChange:e=>g(t=>({...t,notes:e.target.value})),placeholder:"Raison du transfert, urgence, etc."})]}),K.jsxs("div",{className:"flex justify-end gap-2",children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsxs(Hu,{type:"submit",disabled:i||null===p||x.quantity>(p||0),children:[i&&K.jsx(rr,{className:"mr-2 h-4 w-4 animate-spin"}),"Crer le Transfert"]})]})]})]})})}function rj(){const[e,t]=Ke.useState(""),[s,r]=Ke.useState([]),[a,n]=Ke.useState(!0),[i,o]=Ke.useState(null),[l,c]=Ke.useState(!1),[d,u]=Ke.useState(!1),{toast:h}=At();Ke.useEffect(()=>{m()},[]);const m=async()=>{try{const{data:e,error:t}=await Fu.from("stores").select("*").order("created_at",{ascending:!1});if(t)throw t;r(e||[])}catch(e){h({title:"Erreur",description:"Impossible de charger les magasins",variant:"destructive"})}finally{n(!1)}},p=()=>{o(null),c(!0)},f=s.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.address&&t.address.toLowerCase().includes(e.toLowerCase())||t.email&&t.email.toLowerCase().includes(e.toLowerCase())),x=s.length,g=s.filter(e=>e.is_active).length;return K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(Sr,{className:"w-7 h-7 text-primary"}),"Magasins"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez vos points de vente et entrepts"})]}),K.jsxs("div",{className:"flex gap-2",children:[K.jsxs(Hu,{onClick:()=>u(!0),variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Es,{className:"w-4 h-4"}),"Transfert"]}),K.jsxs(Hu,{onClick:p,size:"touch",className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouveau magasin"]})]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total magasins"}),K.jsx(Sr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:x}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Points de vente"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Magasins actifs"}),K.jsx(Sr,{className:"h-4 w-4 text-success"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-success",children:g}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"En fonctionnement"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Transferts en cours"}),K.jsx(Es,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:"-"}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"En attente validation"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Taux activit"}),K.jsx(Sr,{className:"h-4 w-4 text-info"})]}),K.jsxs(Fh,{children:[K.jsxs("div",{className:"text-2xl font-bold text-info",children:[x>0?Math.round(g/x*100):0,"%"]}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Magasins actifs"})]})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un magasin...",value:e,onChange:e=>t(e.target.value),className:"pl-10"})]}),K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Liste des magasins"}),K.jsx(qh,{children:"Grez vos points de vente et leurs informations"})]}),K.jsx(Fh,{children:a?K.jsx("div",{className:"flex items-center justify-center py-12",children:K.jsx("div",{className:"text-muted-foreground",children:"Chargement..."})}):0===f.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(Sr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:"Aucun magasin trouv"}),K.jsx(Hu,{onClick:p,variant:"outline",children:"Crer un magasin"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Nom"}),K.jsx(ip,{children:"Adresse"}),K.jsx(ip,{children:"Contact"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:f.map(e=>{return K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.name}),K.jsx(op,{children:e.address?K.jsxs("div",{className:"flex items-start gap-1",children:[K.jsx(ir,{className:"w-3 h-3 text-muted-foreground mt-0.5 shrink-0"}),K.jsx("span",{className:"text-sm max-w-[200px]",children:e.address})]}):K.jsx("span",{className:"text-muted-foreground text-sm",children:"Non renseigne"})}),K.jsx(op,{children:K.jsxs("div",{className:"space-y-1",children:[e.phone&&K.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[K.jsx(pr,{className:"w-3 h-3 text-muted-foreground"}),e.phone]}),e.email&&K.jsx("div",{className:"text-xs text-muted-foreground",children:e.email}),!e.phone&&!e.email&&K.jsx("span",{className:"text-muted-foreground text-sm",children:"Non renseign"})]})}),K.jsx(op,{children:(t=e.is_active,t?K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:"Actif"}):K.jsx(Jh,{variant:"destructive",children:"Inactif"}))}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Sh,{onClick:()=>(e=>{o(e),c(!0)})(e),children:"Modifier"}),K.jsx(Sh,{children:"Voir inventaire"}),K.jsx(Sh,{className:"text-destructive",onClick:()=>(async e=>{try{const{error:t}=await Fu.from("stores").delete().eq("id",e);if(t)throw t;h({title:"Succs",description:"Magasin supprim avec succs"}),m()}catch(t){h({title:"Erreur",description:"Erreur lors de la suppression",variant:"destructive"})}})(e.id),children:"Supprimer"})]})]})})]},e.id);var t})})]})})]}),K.jsx(Xy,{open:l,onOpenChange:c,store:i,onSuccess:m}),K.jsx(sj,{open:d,onOpenChange:u,onSuccess:()=>{h({title:"Succs",description:"Demande de transfert cre"})}})]})}function aj({open:e,onOpenChange:t,supplier:s,onSuccess:r}){const[a,n]=Ke.useState(!1),[i,o]=Ke.useState({name:"",contact_person:"",email:"",phone:"",address:"",is_active:!0}),{toast:l}=At();Ke.useEffect(()=>{o(s||{name:"",contact_person:"",email:"",phone:"",address:"",is_active:!0})},[s]);return K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{children:[K.jsxs(mp,{children:[K.jsxs(fp,{children:[s?"Modifier":"Crer"," un fournisseur"]}),K.jsx(xp,{children:s?"Modifiez les informations du fournisseur":"Crez un nouveau fournisseur"})]}),K.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{if(null==s?void 0:s.id){const{error:e}=await Fu.from("suppliers").update({name:i.name,contact_person:i.contact_person||null,email:i.email||null,phone:i.phone||null,address:i.address||null,is_active:i.is_active}).eq("id",s.id);if(e)throw e;l({title:"Succs",description:"Fournisseur modifi avec succs"})}else{const{error:e}=await Fu.from("suppliers").insert({name:i.name,contact_person:i.contact_person||null,email:i.email||null,phone:i.phone||null,address:i.address||null,is_active:i.is_active});if(e)throw e;l({title:"Succs",description:"Fournisseur cr avec succs"})}r(),t(!1)}catch(a){l({title:"Erreur",description:a.message||"Erreur lors de l'enregistrement",variant:"destructive"})}finally{n(!1)}},children:[K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"name",children:"Nom du fournisseur *"}),K.jsx(Yu,{id:"name",value:i.name,onChange:e=>o({...i,name:e.target.value}),required:!0})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"contact_person",children:"Personne de contact"}),K.jsx(Yu,{id:"contact_person",value:i.contact_person||"",onChange:e=>o({...i,contact_person:e.target.value})})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"email",children:"Email"}),K.jsx(Yu,{id:"email",type:"email",value:i.email||"",onChange:e=>o({...i,email:e.target.value})})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"phone",children:"Tlphone"}),K.jsx(Yu,{id:"phone",type:"tel",value:i.phone||"",onChange:e=>o({...i,phone:e.target.value})})]})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"address",children:"Adresse"}),K.jsx(gp,{id:"address",value:i.address||"",onChange:e=>o({...i,address:e.target.value}),rows:2})]}),K.jsxs("div",{className:"flex items-center space-x-2",children:[K.jsx(Qy,{id:"is_active",checked:i.is_active,onCheckedChange:e=>o({...i,is_active:e})}),K.jsx(Oh,{htmlFor:"is_active",children:"Fournisseur actif"})]})]}),K.jsxs(pp,{className:"mt-6",children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsx(Hu,{type:"submit",disabled:a,children:a?"Enregistrement...":"Enregistrer"})]})]})]})})}function nj(){const[e,t]=Ke.useState(""),[s,r]=Ke.useState([]),[a,n]=Ke.useState(!0),[i,o]=Ke.useState(null),[l,c]=Ke.useState(!1),{toast:d}=At();Ke.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:e,error:t}=await Fu.from("suppliers").select("*").order("created_at",{ascending:!1});if(t)throw t;r(e||[])}catch(e){d({title:"Erreur",description:"Impossible de charger les fournisseurs",variant:"destructive"})}finally{n(!1)}},h=()=>{o(null),c(!0)},m=s.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.contact_person&&t.contact_person.toLowerCase().includes(e.toLowerCase())||t.email&&t.email.toLowerCase().includes(e.toLowerCase())),p=s.length,f=s.filter(e=>e.is_active).length;return K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(Pr,{className:"w-7 h-7 text-primary"}),"Fournisseurs"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez vos fournisseurs et partenaires commerciaux"})]}),K.jsxs(Hu,{onClick:h,size:"touch",className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouveau fournisseur"]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total fournisseurs"}),K.jsx(Pr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:p}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Partenaires"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Fournisseurs actifs"}),K.jsx(Pr,{className:"h-4 w-4 text-success"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-success",children:f}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"En activit"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Commandes ce mois"}),K.jsx(Pr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:"-"}),K.jsx("p",{className:"text-xs text-muted-foreground",children:" implmenter"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Taux activit"}),K.jsx(Pr,{className:"h-4 w-4 text-info"})]}),K.jsxs(Fh,{children:[K.jsxs("div",{className:"text-2xl font-bold text-info",children:[p>0?Math.round(f/p*100):0,"%"]}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Fournisseurs actifs"})]})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un fournisseur...",value:e,onChange:e=>t(e.target.value),className:"pl-10"})]}),K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Liste des fournisseurs"}),K.jsx(qh,{children:"Grez vos fournisseurs et leurs informations"})]}),K.jsx(Fh,{children:a?K.jsx("div",{className:"flex items-center justify-center py-12",children:K.jsx("div",{className:"text-muted-foreground",children:"Chargement..."})}):0===m.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(Pr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:"Aucun fournisseur trouv"}),K.jsx(Hu,{onClick:h,variant:"outline",children:"Crer un fournisseur"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Nom"}),K.jsx(ip,{children:"Contact"}),K.jsx(ip,{children:"Coordonnes"}),K.jsx(ip,{children:"Adresse"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:m.map(e=>{return K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.name}),K.jsx(op,{children:e.contact_person?K.jsxs("div",{className:"flex items-center gap-1",children:[K.jsx(Or,{className:"w-3 h-3 text-muted-foreground"}),K.jsx("span",{className:"text-sm",children:e.contact_person})]}):K.jsx("span",{className:"text-muted-foreground text-sm",children:"Non renseign"})}),K.jsx(op,{children:K.jsxs("div",{className:"space-y-1",children:[e.phone&&K.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[K.jsx(pr,{className:"w-3 h-3 text-muted-foreground"}),e.phone]}),e.email&&K.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[K.jsx(nr,{className:"w-3 h-3 text-muted-foreground"}),e.email]}),!e.phone&&!e.email&&K.jsx("span",{className:"text-muted-foreground text-sm",children:"Non renseignes"})]})}),K.jsx(op,{children:e.address?K.jsxs("div",{className:"flex items-start gap-1",children:[K.jsx(ir,{className:"w-3 h-3 text-muted-foreground mt-0.5 shrink-0"}),K.jsx("span",{className:"text-sm max-w-[200px]",children:e.address})]}):K.jsx("span",{className:"text-muted-foreground text-sm",children:"Non renseigne"})}),K.jsx(op,{children:(t=e.is_active,t?K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:"Actif"}):K.jsx(Jh,{variant:"destructive",children:"Inactif"}))}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Sh,{onClick:()=>(e=>{o(e),c(!0)})(e),children:"Modifier"}),K.jsx(Sh,{children:"Voir commandes"}),K.jsx(Sh,{className:"text-destructive",onClick:()=>(async e=>{try{const{error:t}=await Fu.from("suppliers").delete().eq("id",e);if(t)throw t;d({title:"Succs",description:"Fournisseur supprim avec succs"}),u()}catch(t){d({title:"Erreur",description:t.message||"Erreur lors de la suppression",variant:"destructive"})}})(e.id),children:"Supprimer"})]})]})})]},e.id);var t})})]})})]}),K.jsx(aj,{open:l,onOpenChange:c,supplier:i,onSuccess:u})]})}function ij({open:e,onOpenChange:t,onSuccess:s}){const[r,a]=Ke.useState(!1),[n,i]=Ke.useState([]),[o,l]=Ke.useState(new Date),{toast:c}=At(),{userProfile:d}=Uu(),[u,h]=Ke.useState({title:"",category:"",amount:"",description:"",store_id:"all"});Ke.useEffect(()=>{e&&m()},[e]);const m=async()=>{try{const{data:e,error:t}=await Fu.from("stores").select("id, name").eq("is_active",!0).order("name");if(t)throw t;i(e||[])}catch(e){c({title:"Erreur",description:"Impossible de charger les magasins",variant:"destructive"})}},p=(e,t)=>{h(s=>({...s,[e]:t}))};return K.jsx(lp,{open:e,onOpenChange:t,children:K.jsxs(hp,{className:"sm:max-w-[500px]",children:[K.jsxs(mp,{children:[K.jsx(fp,{children:"Nouvelle Dpense"}),K.jsx(xp,{children:"Enregistrez une nouvelle dpense pour le suivi financier"})]}),K.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d){if(u.title.trim()?u.category?u.amount&&Hf(parseFloat(u.amount))||(c({title:"Erreur",description:"Le montant doit tre valide",variant:"destructive"}),0):(c({title:"Erreur",description:"La catgorie est obligatoire",variant:"destructive"}),0):(c({title:"Erreur",description:"Le titre est obligatoire",variant:"destructive"}),0))if(o&&o>new Date)c({title:"Erreur",description:"La date de dpense ne peut pas tre dans le futur",variant:"destructive"});else{a(!0);try{const e={title:u.title,category:u.category,amount:parseFloat(u.amount),description:u.description||null,store_id:"all"===u.store_id?null:u.store_id,expense_date:null==o?void 0:o.toISOString().split("T")[0],created_by:d.id},{error:r}=await Fu.from("expenses").insert(e);if(r)throw new Error(r.message||"Erreur lors de l'enregistrement de la dpense");c({title:"Succs",description:"Dpense enregistre avec succs"}),h({title:"",category:"",amount:"",description:"",store_id:"all"}),l(new Date),s(),t(!1)}catch(r){c({title:"Erreur",description:r.message||"Erreur lors de l'enregistrement",variant:"destructive"})}finally{a(!1)}}}else c({title:"Erreur",description:"Utilisateur non connect",variant:"destructive"})},className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"title",children:"Titre *"}),K.jsx(Yu,{id:"title",value:u.title,onChange:e=>p("title",e.target.value),placeholder:"Ex: Facture lectricit",required:!0})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"category",children:"Catgorie *"}),K.jsxs(If,{value:u.category,onValueChange:e=>p("category",e),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner une catgorie"})}),K.jsx($f,{children:["Loyer","lectricit","Eau","Internet/Tlphone","Assurance","Maintenance","Matriel","Marketing","Formation","Transport","Frais bancaires","Autre"].map(e=>K.jsx(Wf,{value:e,children:e},e))})]})]})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"amount",children:"Montant *"}),K.jsx(Yu,{id:"amount",type:"number",step:"0.01",value:u.amount,onChange:e=>p("amount",e.target.value),placeholder:"0.00",required:!0})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"store",children:"Magasin"}),K.jsxs(If,{value:u.store_id,onValueChange:e=>p("store_id",e),children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un magasin"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les magasins"}),n.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))]})]})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"date",children:"Date de la dpense"}),K.jsxs(Av,{children:[K.jsx(Dv,{asChild:!0,children:K.jsxs(Hu,{variant:"outline",className:Aa("w-full justify-start text-left font-normal",!o&&"text-muted-foreground"),children:[K.jsx(Rs,{className:"mr-2 h-4 w-4"}),o?Km(o,"PPP",{locale:ep}):K.jsx("span",{children:"Slectionner une date"})]})}),K.jsx(Ov,{className:"w-auto p-0",children:K.jsx(ov,{mode:"single",selected:o,onSelect:e=>l(e||new Date),initialFocus:!0})})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"description",children:"Description"}),K.jsx(gp,{id:"description",value:u.description,onChange:e=>p("description",e.target.value),placeholder:"Description optionnelle de la dpense...",rows:3})]}),K.jsxs(pp,{children:[K.jsx(Hu,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),K.jsx(Hu,{type:"submit",disabled:r,children:r?"Enregistrement...":"Enregistrer"})]})]})]})})}function oj(){const{formatAmount:e}=Hh(),[t,s]=Ke.useState(""),[r,a]=Ke.useState(!1),[n,i]=Ke.useState([]),[o,l]=Ke.useState({totalRevenue:0,totalExpenses:0,netProfit:0,monthlyGrowth:0}),[c,d]=Ke.useState(!0),{toast:u}=At(),{userProfile:h}=Uu();Ke.useEffect(()=>{m()},[]);const m=async()=>{try{d(!0);const{data:e,error:t}=await Fu.from("expenses").select("\n          *,\n          stores(name)\n        ").order("expense_date",{ascending:!1});if(t)throw t;const{data:s,error:r}=await Fu.from("sales").select("total_amount, created_at").gte("created_at",new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString());if(r)throw r;const a=(null==e?void 0:e.reduce((e,t)=>e+t.amount,0))||0,n=(null==s?void 0:s.reduce((e,t)=>e+t.total_amount,0))||0,o=n-a,c=new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),{data:u}=await Fu.from("sales").select("total_amount, created_at").gte("created_at",c.toISOString()).lt("created_at",new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString()),h=(null==u?void 0:u.reduce((e,t)=>e+t.total_amount,0))||0,m=h>0?(n-h)/h*100:0;i(e||[]),l({totalRevenue:n,totalExpenses:a,netProfit:o,monthlyGrowth:m})}catch(e){u({title:"Erreur",description:"Impossible de charger les donnes financires",variant:"destructive"})}finally{d(!1)}},p=()=>{a(!0)},f=n.filter(e=>e.title.toLowerCase().includes(t.toLowerCase())||e.category.toLowerCase().includes(t.toLowerCase()));return K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(Ks,{className:"w-7 h-7 text-primary"}),"Gestion Financire"]}),K.jsx("p",{className:"text-muted-foreground",children:"Suivi des finances et comptabilit"})]}),K.jsxs(Hu,{onClick:p,className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouvelle Dpense"]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Revenus Totaux"}),K.jsx(Er,{className:"h-4 w-4 text-success"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:e(o.totalRevenue)}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",o.monthlyGrowth.toFixed(1),"% par rapport au mois dernier"]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Dpenses Totales"}),K.jsx(Tr,{className:"h-4 w-4 text-destructive"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:e(o.totalExpenses)}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Dpenses du mois en cours"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Bnfice Net"}),K.jsx(Ks,{className:"h-4 w-4 text-primary"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold "+(o.netProfit>=0?"text-success":"text-destructive"),children:e(o.netProfit)}),K.jsx("p",{className:"text-xs text-muted-foreground",children:o.netProfit>=0?"Bnfice":"Perte"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Croissance Mensuelle"}),K.jsx(fr,{className:"h-4 w-4 text-accent"})]}),K.jsxs(Fh,{children:[K.jsxs("div",{className:"text-2xl font-bold "+(o.monthlyGrowth>=0?"text-success":"text-destructive"),children:[o.monthlyGrowth>=0?"+":"",o.monthlyGrowth.toFixed(1),"%"]}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Par rapport au mois dernier"})]})]})]}),K.jsxs(ty,{defaultValue:"expenses",className:"space-y-4",children:[K.jsxs(sy,{children:[K.jsx(ry,{value:"expenses",children:"Dpenses"}),K.jsx(ry,{value:"analytics",children:"Analytics"})]}),K.jsx(ay,{value:"expenses",className:"space-y-4",children:K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Dpenses"}),K.jsx(qh,{children:"Liste de toutes les dpenses enregistres"}),K.jsxs("div",{className:"flex items-center space-x-2",children:[K.jsx(br,{className:"w-4 h-4 text-muted-foreground"}),K.jsx(Yu,{placeholder:"Rechercher une dpense...",value:t,onChange:e=>s(e.target.value),className:"max-w-sm"})]})]}),K.jsx(Fh,{children:c?K.jsx("div",{className:"flex items-center justify-center py-8",children:K.jsx("div",{className:"text-muted-foreground",children:"Chargement..."})}):0===f.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[K.jsx(Ks,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground",children:"Aucune dpense enregistre"}),K.jsx(Hu,{onClick:p,className:"mt-4",children:"Ajouter une dpense"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Dpense"}),K.jsx(ip,{children:"Catgorie"}),K.jsx(ip,{children:"Montant"}),K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Date"})]})}),K.jsx(ap,{children:f.map(t=>{var s;return K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:t.title}),K.jsx(op,{children:K.jsx(Jh,{variant:"outline",children:t.category})}),K.jsx(op,{className:"font-medium text-destructive",children:e(t.amount)}),K.jsx(op,{children:(null==(s=t.stores)?void 0:s.name)||"Tous"}),K.jsx(op,{children:new Date(t.expense_date).toLocaleDateString()})]},t.id)})})]})})]})}),K.jsx(ay,{value:"analytics",className:"space-y-4",children:K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Analytics Financiers"}),K.jsx(qh,{children:"Graphiques et analyses des performances financires"})]}),K.jsx(Fh,{children:K.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[K.jsx(fr,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground",children:"Graphiques et analytics  venir"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Intgration de graphiques interactifs pour l'analyse financire"})]})})]})})]}),K.jsx(ij,{open:r,onOpenChange:a,onSuccess:m})]})}function lj({data:e,title:t,type:s="area"}){const{formatAmount:r}=Hh(),a=({active:e,payload:t,label:s})=>e&&t&&t.length?K.jsxs("div",{className:"bg-background border rounded-lg p-3 shadow-lg",children:[K.jsx("p",{className:"font-medium",children:s}),K.jsxs("p",{className:"text-success",children:["Ventes: ",t[0].value]}),K.jsxs("p",{className:"text-primary",children:["CA: ",r(t[1].value)]})]}):null;return"line"===s?K.jsxs("div",{className:"w-full h-80",children:[K.jsx("h3",{className:"text-lg font-semibold mb-4",children:t}),K.jsx(st,{width:"100%",height:"100%",children:K.jsxs(rt,{data:e,children:[K.jsx(at,{strokeDasharray:"3 3",className:"opacity-30"}),K.jsx(nt,{dataKey:"date",className:"text-xs",tick:{fontSize:12}}),K.jsx(it,{className:"text-xs",tick:{fontSize:12},tickFormatter:e=>e.toLocaleString()}),K.jsx(ot,{content:K.jsx(a,{})}),K.jsx(lt,{type:"monotone",dataKey:"sales",stroke:"#10b981",strokeWidth:2,dot:{fill:"#10b981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10b981",strokeWidth:2}}),K.jsx(lt,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2}})]})})]}):K.jsxs("div",{className:"w-full h-80",children:[K.jsx("h3",{className:"text-lg font-semibold mb-4",children:t}),K.jsx(st,{width:"100%",height:"100%",children:K.jsxs(ct,{data:e,children:[K.jsx(at,{strokeDasharray:"3 3",className:"opacity-30"}),K.jsx(nt,{dataKey:"date",className:"text-xs",tick:{fontSize:12}}),K.jsx(it,{className:"text-xs",tick:{fontSize:12},tickFormatter:e=>e.toLocaleString()}),K.jsx(ot,{content:K.jsx(a,{})}),K.jsx(dt,{type:"monotone",dataKey:"sales",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.3}),K.jsx(dt,{type:"monotone",dataKey:"revenue",stackId:"2",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3})]})})]})}const cj=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16","#f97316"];function dj({data:e,title:t,type:s="bar",dataKey:r="revenue"}){const{formatAmount:a}=Hh(),n=({active:e,payload:t,label:s})=>{if(e&&t&&t.length){const e=t[0].payload;return K.jsxs("div",{className:"bg-background border rounded-lg p-3 shadow-lg",children:[K.jsx("p",{className:"font-medium",children:s}),K.jsxs("p",{className:"text-primary",children:["Quantit: ",e.quantity]}),K.jsxs("p",{className:"text-success",children:["CA: ",a(e.revenue)]}),K.jsxs("p",{className:"text-warning",children:["Marge: ",e.margin,"%"]})]})}return null},i=({active:e,payload:t})=>{if(e&&t&&t.length){const e=t[0].payload;return K.jsxs("div",{className:"bg-background border rounded-lg p-3 shadow-lg",children:[K.jsx("p",{className:"font-medium",children:e.name}),K.jsxs("p",{className:"text-primary",children:["quantity"===r?"Quantit":"revenue"===r?"CA":"Marge",": ","revenue"===r?a(e[r]):e[r]]})]})}return null};return"pie"===s?K.jsxs("div",{className:"w-full h-80",children:[K.jsx("h3",{className:"text-lg font-semibold mb-4",children:t}),K.jsx(st,{width:"100%",height:"100%",children:K.jsxs(ut,{children:[K.jsx(ht,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:t})=>`${e} ${(100*t).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:r,children:e.map((e,t)=>K.jsx(mt,{fill:cj[t%cj.length]},`cell-${t}`))}),K.jsx(ot,{content:K.jsx(i,{})}),K.jsx(pt,{})]})})]}):K.jsxs("div",{className:"w-full h-80",children:[K.jsx("h3",{className:"text-lg font-semibold mb-4",children:t}),K.jsx(st,{width:"100%",height:"100%",children:K.jsxs(ft,{data:e,children:[K.jsx(at,{strokeDasharray:"3 3",className:"opacity-30"}),K.jsx(nt,{dataKey:"name",className:"text-xs",tick:{fontSize:10},angle:-45,textAnchor:"end",height:80}),K.jsx(it,{className:"text-xs",tick:{fontSize:12},tickFormatter:e=>"revenue"===r?a(e):e.toLocaleString()}),K.jsx(ot,{content:K.jsx(n,{})}),K.jsx(xt,{dataKey:r,fill:"#3b82f6",radius:[4,4,0,0]})]})})]})}function uj({data:e,title:t,type:s="bar"}){const{formatAmount:r}=Hh(),a=({active:e,payload:t,label:s})=>{if(e&&t&&t.length){const e=t[0].payload;return K.jsxs("div",{className:"bg-background border rounded-lg p-3 shadow-lg",children:[K.jsx("p",{className:"font-medium",children:s}),K.jsxs("p",{className:"text-primary",children:["Ventes: ",e.sales]}),K.jsxs("p",{className:"text-success",children:["CA: ",r(e.revenue)]}),K.jsxs("p",{className:"text-warning",children:["Panier moyen: ",formatCurrency(e.avgTicket)]}),K.jsxs("p",{className:""+(e.growth>=0?"text-success":"text-destructive"),children:["Croissance: ",e.growth>=0?"+":"",e.growth,"%"]})]})}return null};return"radar"===s?K.jsxs("div",{className:"w-full h-80",children:[K.jsx("h3",{className:"text-lg font-semibold mb-4",children:t}),K.jsx(st,{width:"100%",height:"100%",children:K.jsxs(gt,{data:e,children:[K.jsx(vt,{}),K.jsx(yt,{dataKey:"name"}),K.jsx(jt,{}),K.jsx(bt,{name:"Performance",dataKey:"revenue",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3}),K.jsx(ot,{content:K.jsx(a,{})})]})})]}):"composed"===s?K.jsxs("div",{className:"w-full h-80",children:[K.jsx("h3",{className:"text-lg font-semibold mb-4",children:t}),K.jsx(st,{width:"100%",height:"100%",children:K.jsxs(wt,{data:e,children:[K.jsx(at,{strokeDasharray:"3 3",className:"opacity-30"}),K.jsx(nt,{dataKey:"name",className:"text-xs",tick:{fontSize:10}}),K.jsx(it,{className:"text-xs",tick:{fontSize:12},yAxisId:"left",tickFormatter:e=>e.toLocaleString()}),K.jsx(it,{className:"text-xs",tick:{fontSize:12},yAxisId:"right",orientation:"right",tickFormatter:e=>r(e)}),K.jsx(ot,{content:K.jsx(a,{})}),K.jsx(xt,{dataKey:"sales",fill:"#10b981",yAxisId:"left",radius:[4,4,0,0]}),K.jsx(lt,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,yAxisId:"right",dot:{fill:"#3b82f6",strokeWidth:2,r:4}})]})})]}):K.jsxs("div",{className:"w-full h-80",children:[K.jsx("h3",{className:"text-lg font-semibold mb-4",children:t}),K.jsx(st,{width:"100%",height:"100%",children:K.jsxs(ft,{data:e,children:[K.jsx(at,{strokeDasharray:"3 3",className:"opacity-30"}),K.jsx(nt,{dataKey:"name",className:"text-xs",tick:{fontSize:10},angle:-45,textAnchor:"end",height:80}),K.jsx(it,{className:"text-xs",tick:{fontSize:12},tickFormatter:e=>r(e)}),K.jsx(ot,{content:K.jsx(a,{})}),K.jsx(xt,{dataKey:"revenue",fill:"#3b82f6",radius:[4,4,0,0]})]})})]})}function hj({icon:e,title:t,description:s,action:r,className:a}){return K.jsxs("div",{className:Aa("flex flex-col items-center justify-center py-12 text-center",a),children:[e&&K.jsx(e,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:t}),s&&K.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-sm",children:s}),r&&K.jsx("div",{className:"flex items-center gap-2",children:r})]})}function mj({icon:e=rr,title:t="Chargement...",description:s,size:r="md",className:a}){return K.jsxs("div",{className:Aa("flex flex-col items-center justify-center py-8 text-center",a),children:[K.jsx(e,{className:Aa("animate-spin text-muted-foreground mb-3",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[r])}),K.jsx("h3",{className:"text-sm font-medium text-foreground mb-1",children:t}),s&&K.jsx("p",{className:"text-xs text-muted-foreground",children:s})]})}function pj(){var e,t,s,r,a,n;const{formatAmount:i}=Hh(),[o,l]=Ke.useState("graphs"),[c,d]=Ke.useState("7d"),[u,h]=Ke.useState(!0),[m,p]=Ke.useState({salesChartData:[],productChartData:[],storeChartData:[],topProducts:[],storePerformance:[],recentSales:[],stockAlerts:[],userPerformance:[]}),{toast:f}=At();Ke.useEffect(()=>{x()},[c]);const x=async()=>{try{h(!0);const{data:e,error:t}=await Fu.from("sales").select("\n          *,\n          sale_items(*, products(name)),\n          stores(name)\n        ").order("created_at",{ascending:!1});if(t)return void f({title:"Erreur",description:"Impossible de charger les donnes de ventes",variant:"destructive"});const{data:s,error:r}=await Fu.from("product_stores").select("\n          *,\n          products(name, current_sale_price),\n          stores(name)\n        ");if(r)return void f({title:"Erreur",description:"Impossible de charger les donnes d'inventaire",variant:"destructive"});const a=g(e,c),n={};null==e||e.forEach(e=>{var t;null==(t=e.sale_items)||t.forEach(e=>{var t;const s=null==(t=e.products)?void 0:t.name;s&&(n[s]||(n[s]={quantity:0,revenue:0,margin:0}),n[s].quantity+=e.quantity,n[s].revenue+=Number(e.total_price))})});const i=Object.entries(n).map(([e,t])=>{const s=Vf(t.revenue,t.quantity,100);return{name:e,...t,margin:Math.max(0,Math.min(100,s))}}).sort((e,t)=>t.revenue-e.revenue).slice(0,10),o={};null==e||e.forEach(e=>{var t;const s=(null==(t=e.stores)?void 0:t.name)||"Magasin principal";o[s]||(o[s]={sales:0,revenue:0,avgTicket:0,growth:0}),o[s].sales+=1,o[s].revenue+=Number(e.total_amount)}),Object.keys(o).forEach(t=>{const s=o[t];s.avgTicket=Bf(s.revenue,s.sales);const r="7d"===c?7:"30d"===c?30:90,a=2*r,n=(null==e?void 0:e.filter(e=>{var s;return(null==(s=e.stores)?void 0:s.name)===t&&new Date(e.created_at)>new Date(Date.now()-24*r*60*60*1e3)}).length)||0,i=(null==e?void 0:e.filter(e=>{var s;return(null==(s=e.stores)?void 0:s.name)===t&&new Date(e.created_at)<=new Date(Date.now()-24*r*60*60*1e3)&&new Date(e.created_at)>new Date(Date.now()-24*a*60*60*1e3)}).length)||0;var l,d;s.growth=(l=n,0===(d=i)?l>0?100:0:Math.round((l-d)/d*100))});const l=Object.entries(o).map(([e,t])=>({name:e,...t})),d={};null==e||e.forEach(e=>{var t;const s=e.created_by,r=e.users;s&&(d[s]||(d[s]={id:s,name:r?`${r.first_name} ${r.last_name}`:"Utilisateur",sales:0,revenue:0,avgTicket:0,productsSold:0,efficiency:0}),d[s].sales+=1,d[s].revenue+=Number(e.total_amount),d[s].productsSold+=(null==(t=e.sale_items)?void 0:t.reduce((e,t)=>e+t.quantity,0))||0)}),Object.keys(d).forEach(e=>{const t=d[e];t.avgTicket=Bf(t.revenue,t.sales);const s="7d"===c?7:"30d"===c?30:90;t.efficiency=((e,t,s)=>{if(e<=0||s<=0)return 0;const r=e/s,a=t/e;return Math.round(r*a/1e3*100)/100})(t.sales,t.revenue,s)});const u=Object.values(d).sort((e,t)=>t.revenue-e.revenue).slice(0,10);p({salesChartData:a,productChartData:i,storeChartData:l,topProducts:i,storePerformance:l,recentSales:(null==e?void 0:e.slice(0,10))||[],stockAlerts:(null==s?void 0:s.filter(e=>e.quantity<10))||[],userPerformance:u})}catch(e){f({title:"Erreur",description:"Impossible de charger les donnes d'analyse",variant:"destructive"})}finally{h(!1)}},g=(e,t)=>{const s=[];for(let r=("7d"===t?7:"30d"===t?30:90)-1;r>=0;r--){const t=new Date;t.setDate(t.getDate()-r);const a=t.toISOString().split("T")[0],n=(null==e?void 0:e.filter(e=>e.created_at.startsWith(a)))||[],i=n.reduce((e,t)=>e+Number(t.total_amount),0),o=n.length;s.push({date:t.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"}),sales:o,revenue:i})}return s};return u?K.jsx(mj,{title:"Chargement des analyses",description:"Rcupration des donnes en cours..."}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(As,{className:"w-7 h-7 text-primary"}),"Analytics"]}),K.jsx("p",{className:"text-muted-foreground",children:"Analyse approfondie de vos donnes commerciales"})]}),K.jsxs("div",{className:"flex gap-2",children:[K.jsxs(If,{value:c,onValueChange:d,children:[K.jsx(qf,{className:"w-32",children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"7d",children:"7 jours"}),K.jsx(Wf,{value:"30d",children:"30 jours"}),K.jsx(Wf,{value:"90d",children:"90 jours"})]})]}),K.jsx(Hu,{variant:"outline",onClick:x,children:K.jsx(vr,{className:"w-4 h-4"})}),K.jsxs(Hu,{onClick:()=>{f({title:"Export",description:`Export ${"PDF"} en cours de dveloppement`})},children:[K.jsx(Js,{className:"w-4 h-4 mr-2"}),"Exporter"]})]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"CA Total"}),K.jsx(Er,{className:"h-4 w-4 text-success"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:i(m.salesChartData.reduce((e,t)=>e+t.revenue,0))}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"7d"===c?"7 derniers jours":"30d"===c?"30 derniers jours":"90 derniers jours"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Ventes"}),K.jsx(dr,{className:"h-4 w-4 text-primary"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:m.salesChartData.reduce((e,t)=>e+t.sales,0)}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Transactions totales"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Produits"}),K.jsx(dr,{className:"h-4 w-4 text-info"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:m.topProducts.length}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Produits vendus"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Magasins"}),K.jsx(Sr,{className:"h-4 w-4 text-warning"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:m.storePerformance.length}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Magasins actifs"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Utilisateurs"}),K.jsx(Rr,{className:"h-4 w-4 text-purple-500"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:m.userPerformance.length}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Utilisateurs actifs"})]})]})]}),K.jsxs(ty,{value:o,onValueChange:l,className:"space-y-4",children:[K.jsxs(sy,{className:"grid w-full grid-cols-2",children:[K.jsx(ry,{value:"graphs",children:"Graphiques"}),K.jsx(ry,{value:"data",children:"Donnes"})]}),K.jsxs(ay,{value:"graphs",className:"space-y-6",children:[K.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"volution des Ventes"}),K.jsxs(qh,{children:["Ventes et CA sur ","7d"===c?"7 jours":"30d"===c?"30 jours":"90 jours"]})]}),K.jsx(Fh,{children:K.jsx(lj,{data:m.salesChartData,title:"",type:"area"})})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Top Produits par CA"}),K.jsx(qh,{children:"Produits les plus rentables"})]}),K.jsx(Fh,{children:K.jsx(dj,{data:m.productChartData.slice(0,5),title:"",type:"bar",dataKey:"revenue"})})]})]}),K.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Rpartition des Produits"}),K.jsx(qh,{children:"Rpartition par quantit vendue"})]}),K.jsx(Fh,{children:K.jsx(dj,{data:m.productChartData.slice(0,6),title:"",type:"pie",dataKey:"quantity"})})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Performance des Magasins"}),K.jsx(qh,{children:"Ventes et CA par magasin"})]}),K.jsx(Fh,{children:K.jsx(uj,{data:m.storeChartData,title:"",type:"composed"})})]})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Performance des Utilisateurs"}),K.jsx(qh,{children:"Top 5 utilisateurs par CA"})]}),K.jsx(Fh,{children:K.jsx("div",{className:"h-80",children:K.jsx("div",{className:"space-y-4",children:m.userPerformance.slice(0,5).map((e,t)=>K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-sm font-bold",children:t+1}),K.jsxs("div",{children:[K.jsx("p",{className:"font-medium",children:e.name}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.sales," ventes"]})]})]}),K.jsxs("div",{className:"text-right",children:[K.jsx("p",{className:"font-bold",children:i(e.revenue)}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:["Panier: ",i(e.avgTicket)]})]})]},e.id))})})})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Analyse des Tendances"}),K.jsx(qh,{children:"volution dtaille des ventes"})]}),K.jsx(Fh,{children:K.jsx(lj,{data:m.salesChartData,title:"",type:"line"})})]})]}),K.jsxs(ay,{value:"data",className:"space-y-6",children:[K.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[K.jsxs(Rh,{children:[K.jsx(Ih,{className:"pb-2",children:K.jsx(Lh,{className:"text-sm",children:"Meilleur Vendeur"})}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-lg font-bold",children:(null==(e=m.userPerformance[0])?void 0:e.name)||"N/A"}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:[m.userPerformance[0]?i(m.userPerformance[0].revenue):"0"," de CA"]})]})]}),K.jsxs(Rh,{children:[K.jsx(Ih,{className:"pb-2",children:K.jsx(Lh,{className:"text-sm",children:"Meilleur Panier"})}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-lg font-bold",children:(null==(t=m.userPerformance.sort((e,t)=>t.avgTicket-e.avgTicket)[0])?void 0:t.name)||"N/A"}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:[m.userPerformance.sort((e,t)=>t.avgTicket-e.avgTicket)[0]?i(m.userPerformance.sort((e,t)=>t.avgTicket-e.avgTicket)[0].avgTicket):"0"," par vente"]})]})]}),K.jsxs(Rh,{children:[K.jsx(Ih,{className:"pb-2",children:K.jsx(Lh,{className:"text-sm",children:"Plus de Ventes"})}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-lg font-bold",children:(null==(s=m.userPerformance.sort((e,t)=>t.sales-e.sales)[0])?void 0:s.name)||"N/A"}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:[(null==(r=m.userPerformance.sort((e,t)=>t.sales-e.sales)[0])?void 0:r.sales)||0," ventes"]})]})]}),K.jsxs(Rh,{children:[K.jsx(Ih,{className:"pb-2",children:K.jsx(Lh,{className:"text-sm",children:"Plus Efficace"})}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-lg font-bold",children:(null==(a=m.userPerformance.sort((e,t)=>t.efficiency-e.efficiency)[0])?void 0:a.name)||"N/A"}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:["Score: ",(null==(n=m.userPerformance.sort((e,t)=>t.efficiency-e.efficiency)[0])?void 0:n.efficiency.toFixed(2))||"0"]})]})]})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Top Produits"}),K.jsx(qh,{children:"Produits les plus performants"})]}),K.jsx(Fh,{children:K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Rang"}),K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"Quantit"}),K.jsx(ip,{children:"CA"}),K.jsx(ip,{children:"Marge"})]})}),K.jsx(ap,{children:m.topProducts.map((e,t)=>K.jsxs(np,{children:[K.jsx(op,{children:K.jsxs(Jh,{variant:t<3?"default":"secondary",children:["#",t+1]})}),K.jsx(op,{className:"font-medium",children:e.name}),K.jsx(op,{children:e.quantity}),K.jsx(op,{children:i(e.revenue)}),K.jsx(op,{children:K.jsxs(Jh,{variant:e.margin>30?"default":"secondary",children:[e.margin,"%"]})})]},e.name))})]})})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Performance des Magasins"}),K.jsx(qh,{children:"Comparaison des performances par magasin"})]}),K.jsx(Fh,{children:K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Ventes"}),K.jsx(ip,{children:"CA"}),K.jsx(ip,{children:"Panier Moyen"}),K.jsx(ip,{children:"Croissance"})]})}),K.jsx(ap,{children:m.storePerformance.map(e=>K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.name}),K.jsx(op,{children:e.sales}),K.jsx(op,{children:i(e.revenue)}),K.jsx(op,{children:i(e.avgTicket)}),K.jsx(op,{children:K.jsxs(Jh,{variant:e.growth>=0?"default":"destructive",children:[e.growth>=0?"+":"",e.growth,"%"]})})]},e.name))})]})})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Performance des Utilisateurs"}),K.jsx(qh,{children:"Classement des utilisateurs par performance"})]}),K.jsx(Fh,{children:0===m.userPerformance.length?K.jsx(hj,{icon:Rr,title:"Aucune donne de performance",description:"Aucun utilisateur n'a encore effectu de ventes dans cette priode"}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Rang"}),K.jsx(ip,{children:"Utilisateur"}),K.jsx(ip,{children:"Ventes"}),K.jsx(ip,{children:"CA"}),K.jsx(ip,{children:"Panier Moyen"}),K.jsx(ip,{children:"Produits Vendus"}),K.jsx(ip,{children:"Efficacit"})]})}),K.jsx(ap,{children:m.userPerformance.map((e,t)=>K.jsxs(np,{children:[K.jsx(op,{children:K.jsxs(Jh,{variant:t<3?"default":"secondary",children:["#",t+1]})}),K.jsx(op,{className:"font-medium",children:e.name}),K.jsx(op,{children:e.sales}),K.jsx(op,{children:i(e.revenue)}),K.jsx(op,{children:i(e.avgTicket)}),K.jsx(op,{children:e.productsSold}),K.jsx(op,{children:K.jsx(Jh,{variant:e.efficiency>.5?"default":e.efficiency>.3?"secondary":"outline",children:e.efficiency.toFixed(2)})})]},e.id))})]})})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Alertes de Stock"}),K.jsx(qh,{children:"Produits ncessitant un rapprovisionnement"})]}),K.jsx(Fh,{children:0===m.stockAlerts.length?K.jsx(hj,{icon:dr,title:"Aucune alerte de stock",description:"Tous les produits ont des stocks suffisants"}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"Stock Actuel"}),K.jsx(ip,{children:"Magasin"}),K.jsx(ip,{children:"Statut"})]})}),K.jsx(ap,{children:m.stockAlerts.map(e=>{var t,s;return K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:null==(t=e.products)?void 0:t.name}),K.jsx(op,{children:e.quantity}),K.jsx(op,{children:null==(s=e.stores)?void 0:s.name}),K.jsx(op,{children:K.jsx(Jh,{variant:"destructive",children:"Stock Critique"})})]},e.id)})})]})})]})]})]})]})}function fj(){const{formatAmount:e}=Hh(),[t,s]=Ke.useState(""),[r,a]=Ke.useState([]),[n,i]=Ke.useState({totalReports:0,recentReports:0,todayRevenue:0,itemsSold:0}),[o,l]=Ke.useState(!0),{toast:c}=At();Ke.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:e}=await Fu.from("sales").select("*, sale_items(*)"),t=(new Date).toISOString().split("T")[0],s=(null==e?void 0:e.filter(e=>e.created_at.startsWith(t)))||[],r=s.reduce((e,t)=>e+Number(t.total_amount),0),n=s.reduce((e,t)=>{var s;return e+((null==(s=t.sale_items)?void 0:s.reduce((e,t)=>e+t.quantity,0))||0)},0),o=[{id:"RPT001",name:"Rapport des ventes journalires",type:"Ventes",period:"Aujourd'hui",totalSales:r,transactions:s.length,generatedAt:(new Date).toISOString().split("T")[0],status:"Gnr"},{id:"RPT002",name:"Rapport des ventes hebdomadaires",type:"Ventes",period:"Cette semaine",totalSales:7*r,transactions:7*s.length,generatedAt:(new Date).toISOString().split("T")[0],status:"Gnr"},{id:"RPT003",name:"Rapport des ventes mensuelles",type:"Ventes",period:"Ce mois",totalSales:30*r,transactions:30*s.length,generatedAt:(new Date).toISOString().split("T")[0],status:"En cours"}];a(o),i({totalReports:o.length,recentReports:o.length,todayRevenue:r,itemsSold:n})}catch(e){c({title:"Erreur",description:"Impossible de charger les donnes de rapport",variant:"destructive"})}finally{l(!1)}},u=e=>{switch(e){case"Ventes":return K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:e});case"Inventaire":return K.jsx(Jh,{variant:"secondary",children:e});case"RH":return K.jsx(Jh,{variant:"outline",className:"bg-info/10 text-info",children:e});case"Finance":return K.jsx(Jh,{variant:"default",className:"bg-primary text-primary-foreground",children:e});default:return K.jsx(Jh,{variant:"outline",children:e})}},h=e=>{switch(e){case"Gnr":return K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:e});case"En cours":return K.jsx(Jh,{variant:"secondary",className:"bg-warning/10 text-warning",children:e});default:return K.jsx(Jh,{variant:"outline",children:e})}},m=()=>{c({title:"Nouveau Rapport",description:"Fonctionnalit en cours de dveloppement"})},p=e=>{c({title:"Gnration",description:`Gnration du rapport ${e} en cours...`})},f=r.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())||e.type.toLowerCase().includes(t.toLowerCase()));return o?K.jsx("div",{className:"flex items-center justify-center py-12",children:K.jsx("div",{className:"text-muted-foreground",children:"Chargement des rapports..."})}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(As,{className:"w-7 h-7 text-primary"}),"Rapports"]}),K.jsx("p",{className:"text-muted-foreground",children:"Gestion et gnration de rapports"})]}),K.jsxs(Hu,{onClick:m,size:"touch",className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouveau rapport"]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Rapports totaux"}),K.jsx(As,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:n.totalReports}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Gnrs"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Cette semaine"}),K.jsx(Rs,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:n.recentReports}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Nouveaux rapports"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"CA aujourd'hui"}),K.jsx(Er,{className:"h-4 w-4 text-success"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-success",children:e(n.todayRevenue)}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"+12% vs hier"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Articles vendus"}),K.jsx(As,{className:"h-4 w-4 text-info"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold text-info",children:n.itemsSold}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"Aujourd'hui"})]})]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>p("Ventes"),children:[K.jsxs(Ih,{className:"text-center",children:[K.jsx(Er,{className:"w-12 h-12 text-success mx-auto mb-2"}),K.jsx(Lh,{className:"text-lg",children:"Rapport de ventes"}),K.jsx(qh,{children:"Gnrer un rapport des ventes quotidiennes"})]}),K.jsx(Fh,{children:K.jsx(Hu,{className:"w-full",variant:"outline",children:"Gnrer maintenant"})})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>p("Inventaire"),children:[K.jsxs(Ih,{className:"text-center",children:[K.jsx(As,{className:"w-12 h-12 text-info mx-auto mb-2"}),K.jsx(Lh,{className:"text-lg",children:"Analyse des stocks"}),K.jsx(qh,{children:"Vue d'ensemble de l'tat des stocks"})]}),K.jsx(Fh,{children:K.jsx(Hu,{className:"w-full",variant:"outline",children:"Analyser stocks"})})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>p("Finance"),children:[K.jsxs(Ih,{className:"text-center",children:[K.jsx(Rs,{className:"w-12 h-12 text-primary mx-auto mb-2"}),K.jsx(Lh,{className:"text-lg",children:"Bilan mensuel"}),K.jsx(qh,{children:"Rapport financier du mois coul"})]}),K.jsx(Fh,{children:K.jsx(Hu,{className:"w-full",variant:"outline",children:"Crer bilan"})})]})]}),K.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[K.jsxs("div",{className:"relative flex-1",children:[K.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),K.jsx(Yu,{placeholder:"Rechercher un rapport...",value:t,onChange:e=>s(e.target.value),className:"pl-10"})]}),K.jsxs(Hu,{variant:"outline",size:"touch",className:"gap-2",children:[K.jsx(Zs,{className:"w-4 h-4"}),"Filtres"]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Historique des rapports"}),K.jsx(qh,{children:"Liste de tous vos rapports gnrs"})]}),K.jsx(Fh,{children:0===f.length?K.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[K.jsx(As,{className:"w-16 h-16 text-muted-foreground/20 mb-4"}),K.jsx("p",{className:"text-muted-foreground mb-4",children:"Aucun rapport trouv"}),K.jsx(Hu,{onClick:m,variant:"outline",children:"Crer un rapport"})]}):K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Nom du rapport"}),K.jsx(ip,{children:"Type"}),K.jsx(ip,{children:"Priode"}),K.jsx(ip,{children:"Donnes cls"}),K.jsx(ip,{children:"Gnr le"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:f.map(t=>K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:t.name}),K.jsx(op,{children:u(t.type)}),K.jsx(op,{children:t.period}),K.jsx(op,{children:K.jsxs("div",{className:"text-sm space-y-1",children:[t.totalSales&&K.jsxs("div",{children:["CA: ",e(t.totalSales)]}),t.transactions&&K.jsxs("div",{children:[t.transactions," transactions"]}),t.totalProducts&&K.jsxs("div",{children:[t.totalProducts," produits"]}),t.revenue&&K.jsxs("div",{children:["Revenus: ",e(t.revenue)]})]})}),K.jsx(op,{children:new Date(t.generatedAt).toLocaleDateString()}),K.jsx(op,{children:h(t.status)}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsxs(Sh,{className:"gap-2",children:[K.jsx(Xs,{className:"w-4 h-4"}),"Voir rapport"]}),K.jsxs(Sh,{className:"gap-2",children:[K.jsx(Js,{className:"w-4 h-4"}),"Tlcharger PDF"]}),K.jsxs(Sh,{className:"gap-2",children:[K.jsx(Js,{className:"w-4 h-4"}),"Exporter Excel"]}),K.jsx(Sh,{children:"Dupliquer"}),K.jsx(Sh,{className:"text-destructive",children:"Supprimer"})]})]})})]},t.id))})]})})]})]})}function xj(){const[e,t]=Ke.useState({email:!0,push:!1,lowStock:!0,newSales:!0}),[s,r]=Ke.useState({autoBackup:!0,maintenanceMode:!1,debugMode:!1});return K.jsxs("div",{className:"space-y-6",children:[K.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(wr,{className:"w-7 h-7 text-primary"}),"Configuration"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les paramtres de votre application"})]})}),K.jsxs(ty,{defaultValue:"general",className:"w-full",children:[K.jsxs(sy,{className:"grid w-full grid-cols-5",children:[K.jsxs(ry,{value:"general",className:"gap-2",children:[K.jsx(wr,{className:"w-4 h-4"}),"Gnral"]}),K.jsxs(ry,{value:"stores",className:"gap-2",children:[K.jsx(Sr,{className:"w-4 h-4"}),"Magasins"]}),K.jsxs(ry,{value:"users",className:"gap-2",children:[K.jsx(Rr,{className:"w-4 h-4"}),"Utilisateurs"]}),K.jsxs(ry,{value:"notifications",className:"gap-2",children:[K.jsx(Ds,{className:"w-4 h-4"}),"Notifications"]}),K.jsxs(ry,{value:"system",className:"gap-2",children:[K.jsx(Ys,{className:"w-4 h-4"}),"Systme"]})]}),K.jsxs(ay,{value:"general",className:"space-y-6",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(tr,{className:"w-5 h-5 text-primary"}),"Informations gnrales"]}),K.jsx(qh,{children:"Configuration de base de l'application"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"company-name",children:"Nom de l'entreprise"}),K.jsx(Yu,{id:"company-name",defaultValue:"GesFlex Solutions"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"business-type",children:"Type d'activit"}),K.jsx(Yu,{id:"business-type",defaultValue:"Commerce de dtail"})]})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"currency",children:"Devise par dfaut"}),K.jsx(Yu,{id:"currency",defaultValue:"EUR - Euro"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"timezone",children:"Fuseau horaire"}),K.jsx(Yu,{id:"timezone",defaultValue:"Europe/Paris"})]})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"address",children:"Adresse principale"}),K.jsx(Yu,{id:"address",defaultValue:"123 Rue de la Rpublique, 75001 Paris"})]}),K.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"phone",children:"Tlphone"}),K.jsx(Yu,{id:"phone",defaultValue:"+33 1 23 45 67 89"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{htmlFor:"email",children:"Email"}),K.jsx(Yu,{id:"email",defaultValue:"contact@gesflex.com"})]})]}),K.jsx(Hu,{children:"Enregistrer les modifications"})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(ur,{className:"w-5 h-5 text-primary"}),"Apparence"]}),K.jsx(qh,{children:"Personnalisez l'interface utilisateur"})]}),K.jsxs(Fh,{className:"space-y-4",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Mode sombre"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Activer le thme sombre"})]}),K.jsx(Qy,{})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Sidebar compacte"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Rduire la taille de la barre latrale"})]}),K.jsx(Qy,{})]})]})]})]}),K.jsx(ay,{value:"stores",className:"space-y-6",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Sr,{className:"w-5 h-5 text-primary"}),"Configuration des magasins"]}),K.jsx(qh,{children:"Paramtres globaux pour tous les magasins"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Multi-magasins"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Activer la gestion multi-magasins"})]}),K.jsx(Qy,{defaultChecked:!0})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Transferts automatiques"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Permettre les transferts automatiques entre magasins"})]}),K.jsx(Qy,{})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Horaires par dfaut"}),K.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[K.jsx(Yu,{placeholder:"Heure d'ouverture",defaultValue:"09:00"}),K.jsx(Yu,{placeholder:"Heure de fermeture",defaultValue:"19:00"})]})]})]})]})}),K.jsx(ay,{value:"users",className:"space-y-6",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Rr,{className:"w-5 h-5 text-primary"}),"Gestion des utilisateurs"]}),K.jsx(qh,{children:"Paramtres de scurit et d'accs"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Inscription libre"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Permettre aux nouveaux utilisateurs de s'inscrire"})]}),K.jsx(Qy,{})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Validation des comptes"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Validation manuelle des nouveaux comptes"})]}),K.jsx(Qy,{defaultChecked:!0})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Authentification  deux facteurs"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Obligatoire pour les administrateurs"})]}),K.jsx(Qy,{})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Dure de session (minutes)"}),K.jsx(Yu,{type:"number",defaultValue:"480",placeholder:"480"})]})]})]})}),K.jsx(ay,{value:"notifications",className:"space-y-6",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Ds,{className:"w-5 h-5 text-primary"}),"Notifications"]}),K.jsx(qh,{children:"Configurez les alertes et notifications"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Notifications par email"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Recevoir les alertes par email"})]}),K.jsx(Qy,{checked:e.email,onCheckedChange:e=>t(t=>({...t,email:e}))})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Notifications push"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Alertes en temps rel dans l'application"})]}),K.jsx(Qy,{checked:e.push,onCheckedChange:e=>t(t=>({...t,push:e}))})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Alertes de stock faible"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Notification quand un produit est en rupture"})]}),K.jsx(Qy,{checked:e.lowStock,onCheckedChange:e=>t(t=>({...t,lowStock:e}))})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Nouvelles ventes"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Notification pour chaque nouvelle vente"})]}),K.jsx(Qy,{checked:e.newSales,onCheckedChange:e=>t(t=>({...t,newSales:e}))})]})]})]})}),K.jsxs(ay,{value:"system",className:"space-y-6",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Ys,{className:"w-5 h-5 text-primary"}),"Paramtres systme"]}),K.jsx(qh,{children:"Configuration technique de l'application"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Sauvegarde automatique"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Sauvegarde quotidienne des donnes"})]}),K.jsx(Qy,{checked:s.autoBackup,onCheckedChange:e=>r(t=>({...t,autoBackup:e}))})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Mode maintenance"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Dsactiver l'accs utilisateur temporairement"})]}),K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx(Qy,{checked:s.maintenanceMode,onCheckedChange:e=>r(t=>({...t,maintenanceMode:e}))}),s.maintenanceMode&&K.jsx(Jh,{variant:"destructive",children:"Actif"})]})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-1",children:[K.jsx(Oh,{children:"Mode debug"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Activer les logs dtaills pour le support"})]}),K.jsx(Qy,{checked:s.debugMode,onCheckedChange:e=>r(t=>({...t,debugMode:e}))})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"space-y-4",children:[K.jsx(Oh,{children:"Actions systme"}),K.jsxs("div",{className:"flex gap-2 flex-wrap",children:[K.jsxs(Hu,{variant:"outline",className:"gap-2",children:[K.jsx(Ys,{className:"w-4 h-4"}),"Sauvegarder maintenant"]}),K.jsxs(Hu,{variant:"outline",className:"gap-2",children:[K.jsx(Nr,{className:"w-4 h-4"}),"Vrifier intgrit"]}),K.jsxs(Hu,{variant:"destructive",className:"gap-2",children:[K.jsx(Ys,{className:"w-4 h-4"}),"Rinitialiser cache"]})]})]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Informations systme"}),K.jsx(qh,{children:"tat actuel de l'application"})]}),K.jsx(Fh,{children:K.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Version de l'application"}),K.jsx("p",{className:"text-sm font-mono",children:"v2.1.3"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Dernire sauvegarde"}),K.jsx("p",{className:"text-sm",children:"27/01/2025  03:00"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Base de donnes"}),K.jsx("div",{className:"flex items-center gap-2",children:K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:"En ligne"})})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Espace utilis"}),K.jsx("p",{className:"text-sm",children:"2.4 GB / 10 GB"})]})]})})]})]})]})]})}function gj(){var e,t,s,r;const{toast:a}=At(),{userProfile:n}=Uu();Hh();const[i,o]=Ke.useState([]),[l,c]=Ke.useState([]),[d,u]=Ke.useState(!0),[h,m]=Ke.useState(null),[p,f]=Ke.useState(!1),[x,g]=Ke.useState(null),[v,y]=Ke.useState(!1),[j,b]=Ke.useState(!1),[w,N]=Ke.useState(""),[_,k]=Ke.useState("validate"),[S,C]=Ke.useState({search:"",sourceStore:"all",destinationStore:"all",status:"all",dateRange:{from:null,to:null}}),T=(null==n?void 0:n.role)&&["Manager","Admin","SuperAdmin"].includes(n.role),E=(null==n?void 0:n.role)&&["Manager","Admin","SuperAdmin"].includes(n.role),M=(null==n?void 0:n.role)&&["Manager","Admin","SuperAdmin"].includes(n.role),P=(null==n?void 0:n.role)&&["Vendeur","Manager","Admin","SuperAdmin"].includes(n.role);Ke.useEffect(()=>{P&&(D(),A())},[P]);const A=async()=>{try{const{data:e,error:t}=await Fu.from("stores").select("id, name").eq("is_active",!0).order("name");if(t)throw t;c(e||[])}catch(e){a({title:"Erreur",description:"Impossible de charger la liste des magasins",variant:"destructive"})}},D=async()=>{try{u(!0),m(null);let e=Fu.from("store_transfers").select("\n          *,\n          source_store:stores!store_transfers_source_store_id_fkey(id, name),\n          destination_store:stores!store_transfers_destination_store_id_fkey(id, name),\n          product:products(id, name, sku),\n          created_by_user:users!store_transfers_created_by_fkey(id, first_name, last_name)\n        ").order("created_at",{ascending:!1});if(!M){const{data:t,error:s}=await Fu.from("user_stores").select("store_id").eq("user_id",n.id);if(s)throw s;if(!(t&&t.length>0))return void o([]);{const s=t.map(e=>e.store_id);e=e.or(`source_store_id.in.(${s.join(",")}),destination_store_id.in.(${s.join(",")})`)}}const{data:t,error:s}=await e;if(s)throw s;o(t||[])}catch(e){m("Impossible de charger les transferts"),a({title:"Erreur",description:"Impossible de charger les transferts",variant:"destructive"})}finally{u(!1)}},O=e=>{switch(e){case"pending":return K.jsxs(Jh,{variant:"secondary",className:"gap-1",children:[K.jsx(Vs,{className:"w-3 h-3"}),"En attente"]});case"validated":return K.jsxs(Jh,{variant:"default",className:"gap-1 bg-green-600",children:[K.jsx(Is,{className:"w-3 h-3"}),"Valid"]});case"rejected":return K.jsxs(Jh,{variant:"destructive",className:"gap-1",children:[K.jsx(Lr,{className:"w-3 h-3"}),"Rejet"]});default:return K.jsx(Jh,{variant:"secondary",children:e})}},R=Ke.useMemo(()=>i.filter(e=>{var t,s,r,a,n,i,o,l;const c=S.search.toLowerCase(),d=!S.search||(null==(s=null==(t=e.product)?void 0:t.name)?void 0:s.toLowerCase().includes(c))||(null==(a=null==(r=e.product)?void 0:r.sku)?void 0:a.toLowerCase().includes(c))||(null==(i=null==(n=e.source_store)?void 0:n.name)?void 0:i.toLowerCase().includes(c))||(null==(l=null==(o=e.destination_store)?void 0:o.name)?void 0:l.toLowerCase().includes(c)),u="all"===S.sourceStore||e.source_store_id===S.sourceStore,h="all"===S.destinationStore||e.destination_store_id===S.destinationStore,m="all"===S.status||e.status===S.status;return d&&u&&h&&m}),[i,S]),{pendingTransfers:I,validatedTransfers:L,totalQuantityTransferred:q}=Ke.useMemo(()=>{const e=i.filter(e=>"pending"===e.status),t=i.filter(e=>"validated"===e.status),s=t.reduce((e,t)=>e+t.quantity,0);return{pendingTransfers:e,validatedTransfers:t,totalQuantityTransferred:s}},[i]);return h&&!P?K.jsxs("div",{className:"space-y-6 p-6",children:[K.jsx("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:K.jsxs("div",{children:[K.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[K.jsx(Pr,{className:"w-8 h-8 text-primary"}),"Transferts entre Magasins"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les transferts de stock entre vos magasins"})]})}),K.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Accs refus"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:"Vous n'avez pas les permissions pour accder  cette page"})]})]}):K.jsxs("div",{className:"space-y-6 p-6",children:[K.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[K.jsx(Pr,{className:"w-8 h-8 text-primary"}),"Transferts entre Magasins"]}),K.jsx("p",{className:"text-muted-foreground",children:"Grez les transferts de stock entre vos magasins"})]}),T&&K.jsxs(Hu,{onClick:()=>f(!0),className:"gap-2",children:[K.jsx(xr,{className:"w-4 h-4"}),"Nouveau Transfert"]})]}),h?K.jsx(Rh,{className:"bg-destructive/10 border border-destructive/20",children:K.jsxs(Fh,{className:"p-6 text-center",children:[K.jsx(Ts,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),K.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Erreur de chargement"}),K.jsx("p",{className:"text-destructive/80 mb-4",children:h}),K.jsxs(Hu,{onClick:()=>{m(null),D()},variant:"outline",className:"gap-2",children:[K.jsx(vr,{className:"w-4 h-4"}),"Ressayer"]})]})}):K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[K.jsxs(Rh,{children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"En attente"}),K.jsx(Vs,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:I.length}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"transferts  valider"})]})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Valids"}),K.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:L.length}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"ce mois"})]})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total transfr"}),K.jsx(dr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:q}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"units ce mois"})]})]}),K.jsxs(Rh,{children:[K.jsxs(Ih,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[K.jsx(Lh,{className:"text-sm font-medium",children:"Total transferts"}),K.jsx(Pr,{className:"h-4 w-4 text-muted-foreground"})]}),K.jsxs(Fh,{children:[K.jsx("div",{className:"text-2xl font-bold",children:i.length}),K.jsx("p",{className:"text-xs text-muted-foreground",children:"tous statuts"})]})]})]}),K.jsx(Rh,{children:K.jsx(Fh,{className:"pt-6",children:K.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[K.jsx("div",{className:"flex-1",children:K.jsxs("div",{className:"relative",children:[K.jsx(br,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),K.jsx(Yu,{placeholder:"Rechercher par produit, SKU, magasin...",value:S.search,onChange:e=>C(t=>({...t,search:e.target.value})),className:"pl-8"})]})}),K.jsxs("div",{className:"flex gap-2",children:[K.jsxs(If,{value:S.sourceStore,onValueChange:e=>C(t=>({...t,sourceStore:e})),children:[K.jsx(qf,{className:"w-40",children:K.jsx(Lf,{placeholder:"Magasin source"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les magasins"}),l.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))]})]}),K.jsxs(If,{value:S.destinationStore,onValueChange:e=>C(t=>({...t,destinationStore:e})),children:[K.jsx(qf,{className:"w-40",children:K.jsx(Lf,{placeholder:"Magasin destination"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous les magasins"}),l.map(e=>K.jsx(Wf,{value:e.id,children:e.name},e.id))]})]}),K.jsxs(If,{value:S.status,onValueChange:e=>C(t=>({...t,status:e})),children:[K.jsx(qf,{className:"w-32",children:K.jsx(Lf,{placeholder:"Statut"})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"all",children:"Tous"}),K.jsx(Wf,{value:"pending",children:"En attente"}),K.jsx(Wf,{value:"validated",children:"Valid"}),K.jsx(Wf,{value:"rejected",children:"Rejet"})]})]})]})]})})}),K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Liste des transferts"}),K.jsxs(qh,{children:[R.length," transfert",R.length>1?"s":""]})]}),K.jsx(Fh,{children:K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Produit"}),K.jsx(ip,{children:"Source  Destination"}),K.jsx(ip,{children:"Quantit"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Cr par"}),K.jsx(ip,{children:"Date"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:d?Array.from({length:5}).map((e,t)=>K.jsxs(np,{children:[K.jsx(op,{children:K.jsxs("div",{className:"space-y-2",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-3 w-24 rounded"})]})}),K.jsx(op,{children:K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-4 rounded"}),K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"})]})}),K.jsx(op,{children:K.jsx("div",{className:"animate-pulse bg-gray-300 h-6 w-20 rounded"})}),K.jsx(op,{children:K.jsx("div",{className:"animate-pulse bg-gray-300 h-6 w-20 rounded"})}),K.jsx(op,{children:K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"})}),K.jsx(op,{children:K.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"})}),K.jsx(op,{children:K.jsx("div",{className:"animate-pulse bg-gray-300 h-8 w-8 rounded"})})]},t)):0===R.length?K.jsx(np,{children:K.jsx(op,{colSpan:7,className:"text-center py-8",children:"Aucun transfert trouv"})}):R.map(e=>{var t,s,r,a;return K.jsxs(np,{children:[K.jsx(op,{children:K.jsxs("div",{children:[K.jsx("div",{className:"font-medium",children:null==(t=e.product)?void 0:t.name}),K.jsx("div",{className:"text-sm text-muted-foreground",children:null==(s=e.product)?void 0:s.sku})]})}),K.jsx(op,{children:K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx("span",{className:"text-sm",children:null==(r=e.source_store)?void 0:r.name}),K.jsx(Ms,{className:"w-4 h-4 text-muted-foreground"}),K.jsx("span",{className:"text-sm",children:null==(a=e.destination_store)?void 0:a.name})]})}),K.jsx(op,{children:K.jsxs(Jh,{variant:"outline",children:[e.quantity," units"]})}),K.jsx(op,{children:O(e.status)}),K.jsx(op,{children:K.jsx("div",{className:"text-sm",children:e.created_by_user?`${e.created_by_user.first_name} ${e.created_by_user.last_name}`:"Utilisateur inconnu"})}),K.jsx(op,{children:K.jsx("div",{className:"text-sm",children:new Date(e.created_at).toLocaleDateString("fr-FR")})}),K.jsx(op,{children:K.jsxs(Nh,{children:[K.jsx(_h,{asChild:!0,children:K.jsx(Hu,{variant:"ghost",className:"h-8 w-8 p-0",children:K.jsx(cr,{className:"h-4 w-4"})})}),K.jsxs(kh,{align:"end",children:[K.jsx(Ch,{children:"Actions"}),K.jsx(Sh,{onClick:()=>{g(e),y(!0)},children:"Voir dtails"}),E&&"pending"===e.status&&K.jsxs(K.Fragment,{children:[K.jsx(Th,{}),K.jsxs(Sh,{onClick:()=>{g(e),k("validate"),b(!0)},children:[K.jsx(Is,{className:"w-4 h-4 mr-2"}),"Valider"]}),K.jsxs(Sh,{onClick:()=>{g(e),k("reject"),b(!0)},children:[K.jsx(Lr,{className:"w-4 h-4 mr-2"}),"Rejeter"]})]})]})]})})]},e.id)})})]})})]})]}),K.jsx(sj,{open:p,onOpenChange:f,onSuccess:D}),K.jsx(lp,{open:v,onOpenChange:y,children:K.jsxs(hp,{className:"max-w-2xl",children:[K.jsx(mp,{children:K.jsx(fp,{children:"Dtails du transfert"})}),x&&K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Produit"}),K.jsx("p",{className:"font-medium",children:null==(e=x.product)?void 0:e.name}),K.jsx("p",{className:"text-sm text-muted-foreground",children:null==(t=x.product)?void 0:t.sku})]}),K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Quantit"}),K.jsxs("p",{className:"font-medium",children:[x.quantity," units"]})]})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Magasin source"}),K.jsx("p",{className:"font-medium",children:null==(s=x.source_store)?void 0:s.name})]}),K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Magasin destination"}),K.jsx("p",{className:"font-medium",children:null==(r=x.destination_store)?void 0:r.name})]})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Statut"}),K.jsx("div",{className:"mt-1",children:O(x.status)})]}),K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Date de cration"}),K.jsx("p",{className:"font-medium",children:new Date(x.created_at).toLocaleString("fr-FR")})]})]}),K.jsx("div",{className:"grid grid-cols-2 gap-4",children:K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Cr par"}),K.jsx("p",{className:"font-medium",children:x.created_by_user?`${x.created_by_user.first_name} ${x.created_by_user.last_name}`:"Utilisateur inconnu"})]})}),x.notes&&K.jsxs("div",{children:[K.jsx(Oh,{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),K.jsx("p",{className:"mt-1 p-3 bg-muted rounded-lg",children:x.notes})]})]})]})}),K.jsx(lp,{open:j,onOpenChange:b,children:K.jsxs(hp,{className:"max-w-md",children:[K.jsxs(mp,{children:[K.jsx(fp,{children:"validate"===_?"Valider le transfert":"Rejeter le transfert"}),K.jsx(xp,{children:"validate"===_?"Ce transfert sera valid et le stock sera mis  jour.":"Ce transfert sera rejet et annul."})]}),K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"validation-notes",children:"Notes (optionnel)"}),K.jsx(gp,{id:"validation-notes",value:w,onChange:e=>N(e.target.value),placeholder:"Raison de la validation/rejet..."})]}),K.jsxs("div",{className:"flex justify-end gap-2",children:[K.jsx(Hu,{variant:"outline",onClick:()=>b(!1),children:"Annuler"}),K.jsx(Hu,{variant:"validate"===_?"default":"destructive",onClick:()=>x&&(async(e,t,s)=>{if(null==n?void 0:n.id)if(E)try{if("validate"===t)return a({title:"Validation via Arrivages",description:"Pour valider un transfert, allez dans Arrivages et enregistrez la rception."}),b(!1),void g(null);const{error:r}=await Fu.from("store_transfers").update({status:"rejected",notes:s||null}).eq("id",e);if(r)throw r;a({title:"Transfert rejet",description:"Le transfert a t rejet."}),D(),b(!1),g(null)}catch(r){a({title:"Erreur",description:"Erreur lors de la validation du transfert",variant:"destructive"})}else a({title:"Permission refuse",description:"Vous n'avez pas les permissions pour valider les transferts",variant:"destructive"});else a({title:"Erreur",description:"Utilisateur non identifi",variant:"destructive"})})(x.id,_,w),children:"validate"===_?"Valider":"Rejeter"})]})]})]})})]})}const vj={enableStoreTransfers:!0,globalStockAlerts:!0,globalStockThreshold:10,defaultOpeningTime:"09:00",defaultClosingTime:"19:00",autoBackup:!0,debugMode:!1,enableRealTimeAnalytics:!0,gamificationEnabled:!0,dailySalesTarget:5e4,performanceThreshold:80,pointsPerSale:10,autoGenerateReports:!0,reportSchedule:"weekly",maintenanceMode:!1,maintenanceMessage:"",adminOnlyAccess:!1,defaultCurrency:"XOF",currencySymbol:"CFA",currencyPosition:"after",decimalPlaces:0};function yj(){const{user:e}=Uu(),{settings:t,loading:s,error:r,hasEditPermissions:a,saveSetting:n,saveAllSettings:i,resetToDefaults:o}=function(){const[e,t]=Ke.useState(vj),[s,r]=Ke.useState(!0),[a,n]=Ke.useState(null),{toast:i}=At(),{userProfile:o}=Uu(),l="Admin"===(null==o?void 0:o.role)||"SuperAdmin"===(null==o?void 0:o.role),c={enableStoreTransfers:"stores.enable_transfers",globalStockAlerts:"stores.global_stock_alerts",globalStockThreshold:"stores.global_stock_threshold",defaultOpeningTime:"stores.default_opening_time",defaultClosingTime:"stores.default_closing_time",autoBackup:"system.auto_backup",debugMode:"system.debug_mode",enableRealTimeAnalytics:"system.enable_real_time_analytics",gamificationEnabled:"performance.gamification_enabled",dailySalesTarget:"performance.daily_sales_target",performanceThreshold:"performance.performance_threshold",pointsPerSale:"performance.points_per_sale",autoGenerateReports:"performance.auto_generate_reports",reportSchedule:"performance.report_schedule",maintenanceMode:"maintenance.mode",maintenanceMessage:"maintenance.message",adminOnlyAccess:"maintenance.admin_only_access",defaultCurrency:"currency.default",currencySymbol:"currency.symbol",currencyPosition:"currency.position",decimalPlaces:"currency.decimal_places"},d=async()=>{try{r(!0),n(null);const{data:e,error:s}=await Fu.from("system_settings").select("*").order("setting_key");if(s)throw s;if(e){const s={...vj};e.forEach(e=>{const t=Object.keys(c).find(t=>c[t]===e.setting_key);if(t){let r=e.setting_value;"number"===e.setting_type?r=Number(r):"boolean"===e.setting_type&&(r="true"===r||!0===r),s[t]=r}}),t(s)}}catch(e){n(e instanceof Error?e.message:"Erreur inconnue"),i({title:"Erreur",description:"Impossible de charger les configurations",variant:"destructive"})}finally{r(!1)}},u=async e=>{var s,r;try{if(!l){const e=new Error("Permissions insuffisantes. Seuls les Admin et SuperAdmin peuvent modifier les configurations.");throw i({title:"Erreur de permissions",description:e.message,variant:"destructive"}),e}const{data:s}=await Fu.from("system_settings").select("setting_key, id"),r=new Set((null==s?void 0:s.map(e=>e.setting_key))||[]),a=[],n=[];if(Object.entries(e).forEach(([e,t])=>{const s=c[e];if(!s)return;let i="string";"number"==typeof t?i="number":"boolean"==typeof t?i="boolean":Array.isArray(t)?i="array":"object"==typeof t&&(i="json");const o={setting_key:s,setting_value:t,setting_type:i,category:s.split(".")[0],updated_at:(new Date).toISOString()};r.has(s)?a.push(o):n.push(o)}),a.length>0)for(const e of a){const{error:t}=await Fu.from("system_settings").update(e).eq("setting_key",e.setting_key);if(t)throw t}if(n.length>0){const{error:e}=await Fu.from("system_settings").insert(n);if(e)throw e}t(e),i({title:"Succs",description:"Toutes les configurations ont t sauvegardes"})}catch(a){throw(null==(s=a.message)?void 0:s.includes("Permissions insuffisantes"))||(null==(r=a.message)?void 0:r.includes("Erreur de scurit"))||i({title:"Erreur",description:"Impossible de sauvegarder les configurations",variant:"destructive"}),a}};return Ke.useEffect(()=>{d()},[]),{settings:e,loading:s,error:a,hasEditPermissions:l,saveSetting:async(e,s)=>{var r,a;try{if(!l){const e=new Error("Permissions insuffisantes. Seuls les Admin et SuperAdmin peuvent modifier les configurations.");throw i({title:"Erreur de permissions",description:e.message,variant:"destructive"}),e}const r=c[e];if(!r)throw new Error(`Cl de configuration invalide: ${e}`);let a="string";"number"==typeof s?a="number":"boolean"==typeof s?a="boolean":Array.isArray(s)?a="array":"object"==typeof s&&(a="json");const{data:n}=await Fu.from("system_settings").select("id").eq("setting_key",r).single();if(n){const{error:e}=await Fu.from("system_settings").update({setting_value:s,setting_type:a,category:r.split(".")[0],updated_at:(new Date).toISOString()}).eq("setting_key",r);if(e)throw e}else{const{error:e}=await Fu.from("system_settings").insert({setting_key:r,setting_value:s,setting_type:a,category:r.split(".")[0],updated_at:(new Date).toISOString()});if(e)throw e}t(t=>({...t,[e]:s})),i({title:"Succs",description:"Configuration sauvegarde"})}catch(n){throw(null==(r=n.message)?void 0:r.includes("Permissions insuffisantes"))||(null==(a=n.message)?void 0:a.includes("Erreur de scurit"))||i({title:"Erreur",description:"Impossible de sauvegarder la configuration",variant:"destructive"}),n}},saveAllSettings:u,resetToDefaults:async()=>{try{await u(vj),i({title:"Succs",description:"Configurations rinitialises aux valeurs par dfaut"})}catch(e){i({title:"Erreur",description:"Impossible de rinitialiser les configurations",variant:"destructive"})}},reloadSettings:d}}(),l=async()=>{try{await i(t)}catch(e){}},c=(e,t)=>{n(e,t)};return s?K.jsx("div",{className:"flex items-center justify-center h-64",children:K.jsxs("div",{className:"text-center",children:[K.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),K.jsx("p",{className:"text-muted-foreground",children:"Chargement des configurations..."})]})}):r?K.jsx("div",{className:"flex items-center justify-center h-64",children:K.jsxs("div",{className:"text-center",children:[K.jsx(Ts,{className:"h-8 w-8 text-destructive mx-auto mb-4"}),K.jsx("p",{className:"text-destructive mb-2",children:"Erreur de chargement"}),K.jsx("p",{className:"text-muted-foreground text-sm",children:r})]})}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[K.jsxs("div",{children:[K.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-2",children:[K.jsx(wr,{className:"w-7 h-7 text-primary"}),"Configuration Systme"]}),K.jsx("p",{className:"text-muted-foreground",children:"Paramtres avancs du systme GesFlex"})]}),K.jsxs("div",{className:"flex gap-2",children:[K.jsx(Hu,{variant:"outline",onClick:o,disabled:!a,children:"Rinitialiser"}),K.jsxs(Hu,{onClick:l,size:"touch",className:"gap-2",disabled:!a,children:[K.jsx(jr,{className:"w-4 h-4"}),"Sauvegarder"]})]})]}),!a&&K.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:K.jsxs("div",{className:"flex items-start gap-3",children:[K.jsx(Ts,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),K.jsxs("div",{children:[K.jsx("h3",{className:"font-medium text-yellow-800",children:"Permissions limites"}),K.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Vous pouvez consulter les configurations mais vous n'avez pas les permissions pour les modifier. Seuls les utilisateurs Admin et SuperAdmin peuvent modifier les configurations systme."})]})]})}),K.jsxs(ty,{defaultValue:"stores",className:"space-y-4",children:[K.jsxs(sy,{className:"grid w-full grid-cols-5",children:[K.jsx(ry,{value:"stores",children:"Multi-Magasins"}),K.jsx(ry,{value:"system",children:"Systme"}),K.jsx(ry,{value:"performance",children:"Performance"}),K.jsx(ry,{value:"currency",children:"Devise"}),K.jsx(ry,{value:"maintenance",children:"Maintenance"})]}),K.jsx(ay,{value:"stores",className:"space-y-6",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Sr,{className:"w-5 h-5"}),"Configuration Multi-Magasins"]}),K.jsx(qh,{children:"Paramtres globaux pour la gestion multi-magasins"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Transferts automatiques"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Permettre les transferts automatiques entre magasins"})]}),K.jsx(Qy,{checked:t.enableStoreTransfers,onCheckedChange:e=>c("enableStoreTransfers",e)})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Alertes stock globales"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Alertes de stock faible pour tous les magasins"})]}),K.jsx(Qy,{checked:t.globalStockAlerts,onCheckedChange:e=>c("globalStockAlerts",e)})]}),t.globalStockAlerts&&K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"globalStockThreshold",children:"Seuil global d'alerte stock"}),K.jsx(Yu,{id:"globalStockThreshold",type:"number",value:t.globalStockThreshold,onChange:e=>c("globalStockThreshold",parseInt(e.target.value)),className:"w-32"}),K.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Seuil minimum pour tous les magasins"})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"defaultOpeningTime",children:"Heure d'ouverture par dfaut"}),K.jsx(Yu,{id:"defaultOpeningTime",type:"time",value:t.defaultOpeningTime,onChange:e=>c("defaultOpeningTime",e.target.value)})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"defaultClosingTime",children:"Heure de fermeture par dfaut"}),K.jsx(Yu,{id:"defaultClosingTime",type:"time",value:t.defaultClosingTime,onChange:e=>c("defaultClosingTime",e.target.value)})]})]})]})]})}),K.jsxs(ay,{value:"system",className:"space-y-6",children:[K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Ys,{className:"w-5 h-5"}),"Paramtres Systme"]}),K.jsx(qh,{children:"Configuration technique et performance du systme"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Sauvegarde automatique"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Sauvegarde quotidienne des donnes"})]}),K.jsx(Qy,{checked:t.autoBackup,onCheckedChange:e=>c("autoBackup",e)})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Mode debug"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Activer les logs dtaills pour le support"})]}),K.jsx(Qy,{checked:t.debugMode,onCheckedChange:e=>c("debugMode",e)})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Analytics en temps rel"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Afficher les donnes en temps rel"})]}),K.jsx(Qy,{checked:t.enableRealTimeAnalytics,onCheckedChange:e=>c("enableRealTimeAnalytics",e)})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"space-y-4",children:[K.jsx(Oh,{children:"Actions systme"}),K.jsxs("div",{className:"flex gap-2 flex-wrap",children:[K.jsxs(Hu,{variant:"outline",className:"gap-2",children:[K.jsx(Ys,{className:"w-4 h-4"}),"Sauvegarder maintenant"]}),K.jsxs(Hu,{variant:"outline",className:"gap-2",children:[K.jsx(Nr,{className:"w-4 h-4"}),"Vrifier intgrit"]}),K.jsxs(Hu,{variant:"destructive",className:"gap-2",children:[K.jsx(Ys,{className:"w-4 h-4"}),"Rinitialiser cache"]})]})]})]})]}),K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Informations systme"}),K.jsx(qh,{children:"tat actuel de l'application"})]}),K.jsx(Fh,{children:K.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Version de l'application"}),K.jsx("p",{className:"text-sm font-mono",children:"v2.1.3"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Dernire sauvegarde"}),K.jsx("p",{className:"text-sm",children:"27/01/2025  03:00"})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Base de donnes"}),K.jsx("div",{className:"flex items-center gap-2",children:K.jsx(Jh,{variant:"default",className:"bg-success text-success-foreground",children:"En ligne"})})]}),K.jsxs("div",{className:"space-y-2",children:[K.jsx(Oh,{children:"Espace utilis"}),K.jsx("p",{className:"text-sm",children:"2.4 GB / 10 GB"})]})]})})]})]}),K.jsx(ay,{value:"performance",className:"space-y-6",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Fr,{className:"w-5 h-5"}),"Paramtres de Performance"]}),K.jsx(qh,{children:"Optimisation des performances et seuils de gamification"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Gamification active"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Activer le systme de rcompenses et points"})]}),K.jsx(Qy,{checked:t.gamificationEnabled,onCheckedChange:e=>c("gamificationEnabled",e)})]}),t.gamificationEnabled&&K.jsxs(K.Fragment,{children:[K.jsx(Xu,{}),K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"salesTarget",children:"Objectif de vente quotidien"}),K.jsx(Yu,{id:"salesTarget",type:"number",value:t.dailySalesTarget,onChange:e=>c("dailySalesTarget",parseFloat(e.target.value))})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"performanceThreshold",children:"Seuil de performance (%)"}),K.jsx(Yu,{id:"performanceThreshold",type:"number",value:t.performanceThreshold,onChange:e=>c("performanceThreshold",parseInt(e.target.value))})]})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"pointsPerSale",children:"Points par vente"}),K.jsx(Yu,{id:"pointsPerSale",type:"number",value:t.pointsPerSale,onChange:e=>c("pointsPerSale",parseInt(e.target.value)),className:"w-32"})]})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Rapports automatiques"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Gnrer automatiquement des rapports de performance"})]}),K.jsx(Qy,{checked:t.autoGenerateReports,onCheckedChange:e=>c("autoGenerateReports",e)})]}),t.autoGenerateReports&&K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"reportSchedule",children:"Frquence des rapports"}),K.jsxs(If,{value:t.reportSchedule,onValueChange:e=>c("reportSchedule",e),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"daily",children:"Quotidien"}),K.jsx(Wf,{value:"weekly",children:"Hebdomadaire"}),K.jsx(Wf,{value:"monthly",children:"Mensuel"})]})]})]})]})]})}),K.jsx(ay,{value:"currency",className:"space-y-6",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Ks,{className:"w-5 h-5"}),"Configuration de la Devise"]}),K.jsx(qh,{children:"Paramtres de formatage montaire pour l'application"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"defaultCurrency",children:"Devise par dfaut"}),K.jsxs(If,{value:t.defaultCurrency,onValueChange:e=>c("defaultCurrency",e),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"XOF",children:"Franc CFA (XOF)"}),K.jsx(Wf,{value:"EUR",children:"Euro (EUR)"}),K.jsx(Wf,{value:"USD",children:"Dollar US (USD)"}),K.jsx(Wf,{value:"GBP",children:"Livre Sterling (GBP)"}),K.jsx(Wf,{value:"JPY",children:"Yen Japonais (JPY)"}),K.jsx(Wf,{value:"CNY",children:"Yuan Chinois (CNY)"})]})]})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"currencySymbol",children:"Symbole de la devise"}),K.jsx(Yu,{id:"currencySymbol",value:t.currencySymbol,onChange:e=>c("currencySymbol",e.target.value),placeholder:"CFA, , $, "})]})]}),K.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"currencyPosition",children:"Position du symbole"}),K.jsxs(If,{value:t.currencyPosition,onValueChange:e=>c("currencyPosition",e),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"before",children:"Avant le montant"}),K.jsx(Wf,{value:"after",children:"Aprs le montant"})]})]})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"decimalPlaces",children:"Nombre de dcimales"}),K.jsxs(If,{value:t.decimalPlaces.toString(),onValueChange:e=>c("decimalPlaces",parseInt(e)),children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"0",children:"0 (entiers)"}),K.jsx(Wf,{value:"2",children:"2 (cents)"}),K.jsx(Wf,{value:"3",children:"3 (millimes)"})]})]})]})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[K.jsx(Oh,{className:"text-sm font-medium mb-2 block",children:"Aperu du formatage"}),K.jsxs("div",{className:"space-y-2 text-sm",children:[K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{children:"Montant: 1234567"}),K.jsx("span",{className:"font-mono",children:"before"===t.currencyPosition?`${t.currencySymbol} 1,234,567`:`1,234,567 ${t.currencySymbol}`})]}),K.jsxs("div",{className:"flex justify-between",children:[K.jsx("span",{children:"Montant avec dcimales: 1234.56"}),K.jsx("span",{className:"font-mono",children:"before"===t.currencyPosition?`${t.currencySymbol} 1,234${t.decimalPlaces>0?".56":""}`:`1,234${t.decimalPlaces>0?".56":""} ${t.currencySymbol}`})]})]})]})]})]})}),K.jsx(ay,{value:"maintenance",className:"space-y-6",children:K.jsxs(Rh,{className:"bg-gradient-card shadow-card",children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Nr,{className:"w-5 h-5"}),"Mode Maintenance"]}),K.jsx(qh,{children:"Contrle d'accs et maintenance du systme"})]}),K.jsxs(Fh,{className:"space-y-6",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Mode maintenance"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Dsactiver l'accs utilisateur temporairement"})]}),K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx(Qy,{checked:t.maintenanceMode,onCheckedChange:e=>c("maintenanceMode",e)}),t.maintenanceMode&&K.jsx(Jh,{variant:"destructive",children:"Actif"})]})]}),t.maintenanceMode&&K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"maintenanceMessage",children:"Message de maintenance"}),K.jsx(Yu,{id:"maintenanceMessage",value:t.maintenanceMessage,onChange:e=>c("maintenanceMessage",e.target.value),placeholder:"Le systme est en maintenance..."})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"space-y-0.5",children:[K.jsx(Oh,{children:"Accs administrateur uniquement"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Restreindre l'accs aux administrateurs pendant la maintenance"})]}),K.jsx(Qy,{checked:t.adminOnlyAccess,onCheckedChange:e=>c("adminOnlyAccess",e)})]}),K.jsx(Xu,{}),K.jsxs("div",{className:"space-y-4",children:[K.jsx(Oh,{children:"Actions de maintenance"}),K.jsxs("div",{className:"flex gap-2 flex-wrap",children:[K.jsxs(Hu,{variant:"outline",className:"gap-2",children:[K.jsx(Ys,{className:"w-4 h-4"}),"Optimiser base de donnes"]}),K.jsxs(Hu,{variant:"outline",className:"gap-2",children:[K.jsx(As,{className:"w-4 h-4"}),"Nettoyer logs"]}),K.jsxs(Hu,{variant:"destructive",className:"gap-2",children:[K.jsx(Nr,{className:"w-4 h-4"}),"Redmarrer services"]})]})]})]})]})})]}),K.jsx("div",{className:"flex justify-end",children:K.jsxs(Hu,{onClick:l,size:"lg",className:"gap-2",children:[K.jsx(jr,{className:"w-4 h-4"}),"Sauvegarder tous les paramtres"]})})]})}function jj(){const{signOut:e,userProfile:t}=Uu();return K.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:K.jsxs(Rh,{className:"w-full max-w-md shadow-lg",children:[K.jsxs(Ih,{className:"text-center",children:[K.jsx("div",{className:"w-16 h-16 bg-warning/10 rounded-full flex items-center justify-center mx-auto mb-4",children:K.jsx(Vs,{className:"w-8 h-8",style:{color:"hsl(var(--warning))"}})}),K.jsx(Lh,{className:"text-xl",children:"Compte en attente"}),K.jsx(qh,{children:"Votre compte est en cours de validation"})]}),K.jsxs(Fh,{className:"space-y-4",children:[K.jsxs("div",{className:"text-center space-y-2",children:[K.jsxs("p",{className:"text-sm text-muted-foreground",children:["Bonjour ",K.jsxs("strong",{children:[null==t?void 0:t.first_name," ",null==t?void 0:t.last_name]})]}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Votre compte a t cr avec succs et est en attente de validation par un administrateur."}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Vous recevrez une notification par email ds que votre compte sera activ."})]}),K.jsx("div",{className:"pt-4",children:K.jsxs(Hu,{variant:"outline",className:"w-full gap-2",onClick:e,children:[K.jsx(ar,{className:"w-4 h-4"}),"Se dconnecter"]})})]})]})})}function bj(){const[e,t]=Ke.useState([]),[s,r]=Ke.useState([]),[a,n]=Ke.useState([]),[i,o]=Ke.useState([]),[l,c]=Ke.useState([]),[d,u]=Ke.useState([]),[h,m]=Ke.useState(!0),{toast:p}=At(),[f,x]=Ke.useState(!1),[g,v]=Ke.useState(!1),[y,j]=Ke.useState(!1),[b,w]=Ke.useState(!1),[N,_]=Ke.useState(!1),[k,S]=Ke.useState(null),[C,T]=Ke.useState(null),[E,M]=Ke.useState(null),[P,A]=Ke.useState(null),D=[{value:"star",label:"toile",icon:kr},{value:"award",label:"Rcompense",icon:Ps},{value:"trophy",label:"Trophe",icon:Mr},{value:"target",label:"Cible",icon:Cr},{value:"users",label:"Utilisateurs",icon:Rr},{value:"trending-up",label:"Tendance",icon:Er}];Ke.useEffect(()=>{O()},[]);const O=async()=>{try{const[e,s,a,i,l,d]=await Promise.all([Fu.from("gamification_levels").select("*").order("min_points"),Fu.from("gamification_point_rules").select("*").order("created_at"),Fu.from("gamification_badges").select("*").order("created_at"),Fu.from("gamification_trophies").select("*").order("created_at"),Fu.from("gamification_points").select("*, users(first_name, last_name)").order("created_at",{ascending:!1}).limit(20),Fu.from("users").select("id, first_name, last_name, role").eq("status","active")]);t(e.data||[]),r(s.data||[]),n(a.data||[]),o(i.data||[]),c(l.data||[]),u(d.data||[])}catch(e){p({title:"Erreur",description:"Impossible de charger les donnes de gamification",variant:"destructive"})}finally{m(!1)}};return h?K.jsx("div",{className:"flex items-center justify-center h-64",children:"Chargement..."}):K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{children:[K.jsx("h1",{className:"text-3xl font-bold",children:"Gamification"}),K.jsx("p",{className:"text-muted-foreground",children:"Configuration du systme de rcompenses"})]}),K.jsxs(ty,{defaultValue:"levels",className:"space-y-4",children:[K.jsxs(sy,{children:[K.jsx(ry,{value:"levels",children:"Niveaux"}),K.jsx(ry,{value:"rules",children:"Rgles de Points"}),K.jsx(ry,{value:"badges",children:"Badges"}),K.jsx(ry,{value:"trophies",children:"Trophes"}),K.jsx(ry,{value:"manual",children:"Points Manuels"})]}),K.jsx(ay,{value:"levels",children:K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsxs("div",{className:"flex justify-between items-center",children:[K.jsxs("div",{children:[K.jsx(Lh,{children:"Niveaux de Points"}),K.jsx(qh,{children:"Configurez les niveaux bass sur les points"})]}),K.jsxs(lp,{open:f,onOpenChange:x,children:[K.jsx(cp,{asChild:!0,children:K.jsxs(Hu,{onClick:()=>S(null),children:[K.jsx(xr,{className:"w-4 h-4 mr-2"}),"Nouveau Niveau"]})}),K.jsxs(hp,{children:[K.jsx(mp,{children:K.jsxs(fp,{children:[k?"Modifier":"Crer"," un Niveau"]})}),K.jsxs("form",{onSubmit:e=>{e.preventDefault();(async e=>{const t={name:e.get("name"),min_points:parseInt(e.get("min_points")),max_points:parseInt(e.get("max_points")),color:e.get("color"),icon:e.get("icon")};try{k?await Fu.from("gamification_levels").update(t).eq("id",k.id):await Fu.from("gamification_levels").insert(t),p({title:"Succs",description:`Niveau ${k?"modifi":"cr"} avec succs`}),x(!1),S(null),O()}catch(s){p({title:"Erreur",description:"Impossible de sauvegarder le niveau",variant:"destructive"})}})(new FormData(e.currentTarget))},children:[K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"name",children:"Nom"}),K.jsx(Yu,{name:"name",defaultValue:null==k?void 0:k.name,required:!0})]}),K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"min_points",children:"Points Minimum"}),K.jsx(Yu,{name:"min_points",type:"number",defaultValue:null==k?void 0:k.min_points,required:!0})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"max_points",children:"Points Maximum"}),K.jsx(Yu,{name:"max_points",type:"number",defaultValue:null==k?void 0:k.max_points,required:!0})]})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"color",children:"Couleur"}),K.jsx(Yu,{name:"color",type:"color",defaultValue:(null==k?void 0:k.color)||"#3B82F6"})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"icon",children:"Icne"}),K.jsxs(If,{name:"icon",defaultValue:null==k?void 0:k.icon,children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsx($f,{children:D.map(e=>K.jsx(Wf,{value:e.value,children:K.jsxs("div",{className:"flex items-center",children:[K.jsx(e.icon,{className:"w-4 h-4 mr-2"}),e.label]})},e.value))})]})]})]}),K.jsx(pp,{className:"mt-6",children:K.jsx(Hu,{type:"submit",children:"Sauvegarder"})})]})]})]})]})}),K.jsx(Fh,{children:K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Nom"}),K.jsx(ip,{children:"Plage de Points"}),K.jsx(ip,{children:"Couleur"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:e.map(e=>K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.name}),K.jsxs(op,{children:[e.min_points," - ",e.max_points]}),K.jsx(op,{children:K.jsxs("div",{className:"flex items-center",children:[K.jsx("div",{className:"w-4 h-4 rounded mr-2",style:{backgroundColor:e.color}}),e.color]})}),K.jsx(op,{children:K.jsx(Hu,{variant:"ghost",size:"sm",onClick:()=>{S(e),x(!0)},children:K.jsx(mr,{className:"w-4 h-4"})})})]},e.id))})]})})]})}),K.jsx(ay,{value:"rules",children:K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsxs("div",{className:"flex justify-between items-center",children:[K.jsxs("div",{children:[K.jsx(Lh,{children:"Rgles d'Attribution de Points"}),K.jsx(qh,{children:"Configurez l'attribution automatique de points"})]}),K.jsxs(lp,{open:g,onOpenChange:v,children:[K.jsx(cp,{asChild:!0,children:K.jsxs(Hu,{onClick:()=>T(null),children:[K.jsx(xr,{className:"w-4 h-4 mr-2"}),"Nouvelle Rgle"]})}),K.jsxs(hp,{children:[K.jsx(mp,{children:K.jsxs(fp,{children:[C?"Modifier":"Crer"," une Rgle"]})}),K.jsxs("form",{onSubmit:e=>{e.preventDefault();(async e=>{const t={name:e.get("name"),description:e.get("description"),event_type:e.get("event_type"),points_awarded:parseInt(e.get("points_awarded")),condition_value:JSON.parse(e.get("condition_value")||"{}"),is_active:"on"===e.get("is_active")};try{C?await Fu.from("gamification_point_rules").update(t).eq("id",C.id):await Fu.from("gamification_point_rules").insert(t),p({title:"Succs",description:`Rgle ${C?"modifie":"cre"} avec succs`}),v(!1),T(null),O()}catch(s){p({title:"Erreur",description:"Impossible de sauvegarder la rgle",variant:"destructive"})}})(new FormData(e.currentTarget))},children:[K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"name",children:"Nom"}),K.jsx(Yu,{name:"name",defaultValue:null==C?void 0:C.name,required:!0})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"description",children:"Description"}),K.jsx(gp,{name:"description",defaultValue:null==C?void 0:C.description})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"event_type",children:"Type d'vnement"}),K.jsxs(If,{name:"event_type",defaultValue:null==C?void 0:C.event_type,children:[K.jsx(qf,{children:K.jsx(Lf,{})}),K.jsxs($f,{children:[K.jsx(Wf,{value:"sale",children:"Vente"}),K.jsx(Wf,{value:"return",children:"Retour"}),K.jsx(Wf,{value:"target_achieved",children:"Objectif Atteint"})]})]})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"points_awarded",children:"Points Attribus"}),K.jsx(Yu,{name:"points_awarded",type:"number",defaultValue:null==C?void 0:C.points_awarded,required:!0})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"condition_value",children:"Conditions (JSON)"}),K.jsx(gp,{name:"condition_value",defaultValue:JSON.stringify((null==C?void 0:C.condition_value)||{},null,2),placeholder:'{"min_amount": 100}'})]}),K.jsxs("div",{className:"flex items-center space-x-2",children:[K.jsx(Qy,{name:"is_active",defaultChecked:!1!==(null==C?void 0:C.is_active)}),K.jsx(Oh,{htmlFor:"is_active",children:"Rgle Active"})]})]}),K.jsx(pp,{className:"mt-6",children:K.jsx(Hu,{type:"submit",children:"Sauvegarder"})})]})]})]})]})}),K.jsx(Fh,{children:K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Nom"}),K.jsx(ip,{children:"Type"}),K.jsx(ip,{children:"Points"}),K.jsx(ip,{children:"Statut"}),K.jsx(ip,{children:"Actions"})]})}),K.jsx(ap,{children:s.map(e=>K.jsxs(np,{children:[K.jsx(op,{className:"font-medium",children:e.name}),K.jsx(op,{children:e.event_type}),K.jsxs(op,{children:[e.points_awarded," pts"]}),K.jsx(op,{children:K.jsx(Jh,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"})}),K.jsx(op,{children:K.jsx(Hu,{variant:"ghost",size:"sm",onClick:()=>{T(e),v(!0)},children:K.jsx(mr,{className:"w-4 h-4"})})})]},e.id))})]})})]})}),K.jsx(ay,{value:"manual",children:K.jsx("div",{className:"grid gap-6",children:K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsxs("div",{className:"flex justify-between items-center",children:[K.jsxs("div",{children:[K.jsx(Lh,{children:"Attribution Manuelle de Points"}),K.jsx(qh,{children:"Ajoutez ou retirez des points manuellement"})]}),K.jsxs(lp,{open:N,onOpenChange:_,children:[K.jsx(cp,{asChild:!0,children:K.jsxs(Hu,{children:[K.jsx(xr,{className:"w-4 h-4 mr-2"}),"Ajouter Points"]})}),K.jsxs(hp,{children:[K.jsx(mp,{children:K.jsx(fp,{children:"Attribution Manuelle de Points"})}),K.jsxs("form",{onSubmit:e=>{e.preventDefault();(async e=>{const t={user_id:e.get("user_id"),points:parseInt(e.get("points")),reason:e.get("reason")};try{await Fu.from("gamification_points").insert(t),p({title:"Succs",description:"Points ajouts avec succs"}),_(!1),O()}catch(s){p({title:"Erreur",description:"Impossible d'ajouter les points",variant:"destructive"})}})(new FormData(e.currentTarget))},children:[K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"user_id",children:"Utilisateur"}),K.jsxs(If,{name:"user_id",required:!0,children:[K.jsx(qf,{children:K.jsx(Lf,{placeholder:"Slectionner un utilisateur"})}),K.jsx($f,{children:d.map(e=>K.jsxs(Wf,{value:e.id,children:[e.first_name," ",e.last_name," (",e.role,")"]},e.id))})]})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"points",children:"Points (utilisez un nombre ngatif pour retirer)"}),K.jsx(Yu,{name:"points",type:"number",required:!0})]}),K.jsxs("div",{children:[K.jsx(Oh,{htmlFor:"reason",children:"Raison"}),K.jsx(gp,{name:"reason",required:!0})]})]}),K.jsx(pp,{className:"mt-6",children:K.jsx(Hu,{type:"submit",children:"Attribuer"})})]})]})]})]})}),K.jsx(Fh,{children:K.jsxs(sp,{children:[K.jsx(rp,{children:K.jsxs(np,{children:[K.jsx(ip,{children:"Utilisateur"}),K.jsx(ip,{children:"Points"}),K.jsx(ip,{children:"Raison"}),K.jsx(ip,{children:"Date"})]})}),K.jsx(ap,{children:l.map(e=>K.jsxs(np,{children:[K.jsxs(op,{children:[e.users.first_name," ",e.users.last_name]}),K.jsx(op,{children:K.jsxs("span",{className:e.points>=0?"text-green-600":"text-red-600",children:[e.points>=0?"+":"",e.points," pts"]})}),K.jsx(op,{children:e.reason}),K.jsx(op,{children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]})})]})})})]})]})}var wj="Progress",[Nj,_j]=Q(wj),[kj,Sj]=Nj(wj),Cj=Ke.forwardRef((e,t)=>{const{__scopeProgress:s,value:r=null,max:a,getValueLabel:n=Mj,...i}=e;(a||0===a)&&Dj(a);const o=Dj(a)?a:100;null!==r&&Oj(r,o);const l=Oj(r,o)?r:null,c=Aj(l)?n(l,o):void 0;return K.jsx(kj,{scope:s,value:l,max:o,children:K.jsx(J.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Aj(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Pj(l,o),"data-value":l??void 0,"data-max":o,...i,ref:t})})});Cj.displayName=wj;var Tj="ProgressIndicator",Ej=Ke.forwardRef((e,t)=>{const{__scopeProgress:s,...r}=e,a=Sj(Tj,s);return K.jsx(J.div,{"data-state":Pj(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:t})});function Mj(e,t){return`${Math.round(e/t*100)}%`}function Pj(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function Aj(e){return"number"==typeof e}function Dj(e){return Aj(e)&&!isNaN(e)&&e>0}function Oj(e,t){return Aj(e)&&!isNaN(e)&&e<=t&&e>=0}Ej.displayName=Tj;var Rj=Cj,Ij=Ej;const Lj=Ke.forwardRef(({className:e,value:t,...s},r)=>K.jsx(Rj,{ref:r,className:Aa("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:K.jsx(Ij,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Lj.displayName=Rj.displayName;var qj={exports:{}},Fj={},zj=Ke;var $j="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Wj=zj.useState,Uj=zj.useEffect,Vj=zj.useLayoutEffect,Bj=zj.useDebugValue;function Hj(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!$j(e,s)}catch(r){return!0}}var Yj="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),r=Wj({inst:{value:s,getSnapshot:t}}),a=r[0].inst,n=r[1];return Vj(function(){a.value=s,a.getSnapshot=t,Hj(a)&&n({inst:a})},[e,s,t]),Uj(function(){return Hj(a)&&n({inst:a}),e(function(){Hj(a)&&n({inst:a})})},[e]),Bj(s),s};Fj.useSyncExternalStore=void 0!==zj.useSyncExternalStore?zj.useSyncExternalStore:Yj,qj.exports=Fj;var Gj=qj.exports;function Kj(){return()=>{}}var Jj="Avatar",[Qj,Xj]=Q(Jj),[Zj,eb]=Qj(Jj),tb=Ke.forwardRef((e,t)=>{const{__scopeAvatar:s,...r}=e,[a,n]=Ke.useState("idle");return K.jsx(Zj,{scope:s,imageLoadingStatus:a,onImageLoadingStatusChange:n,children:K.jsx(J.span,{...r,ref:t})})});tb.displayName=Jj;var sb="AvatarImage",rb=Ke.forwardRef((e,t)=>{const{__scopeAvatar:s,src:r,onLoadingStatusChange:a=()=>{},...n}=e,i=eb(sb,s),o=function(e,{referrerPolicy:t,crossOrigin:s}){const r=Gj.useSyncExternalStore(Kj,()=>!0,()=>!1),a=Ke.useRef(null),n=r?(a.current||(a.current=new window.Image),a.current):null,[i,o]=Ke.useState(()=>ib(n,e));return oe(()=>{o(ib(n,e))},[n,e]),oe(()=>{const e=e=>()=>{o(e)};if(!n)return;const r=e("loaded"),a=e("error");return n.addEventListener("load",r),n.addEventListener("error",a),t&&(n.referrerPolicy=t),"string"==typeof s&&(n.crossOrigin=s),()=>{n.removeEventListener("load",r),n.removeEventListener("error",a)}},[n,s,t]),i}(r,n),l=ae(e=>{a(e),i.onImageLoadingStatusChange(e)});return oe(()=>{"idle"!==o&&l(o)},[o,l]),"loaded"===o?K.jsx(J.img,{...n,ref:t,src:r}):null});rb.displayName=sb;var ab="AvatarFallback",nb=Ke.forwardRef((e,t)=>{const{__scopeAvatar:s,delayMs:r,...a}=e,n=eb(ab,s),[i,o]=Ke.useState(void 0===r);return Ke.useEffect(()=>{if(void 0!==r){const e=window.setTimeout(()=>o(!0),r);return()=>window.clearTimeout(e)}},[r]),i&&"loaded"!==n.imageLoadingStatus?K.jsx(J.span,{...a,ref:t}):null});function ib(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}nb.displayName=ab;var ob=tb,lb=rb,cb=nb;const db=Ke.forwardRef(({className:e,...t},s)=>K.jsx(ob,{ref:s,className:Aa("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));db.displayName=ob.displayName;Ke.forwardRef(({className:e,...t},s)=>K.jsx(lb,{ref:s,className:Aa("aspect-square h-full w-full",e),...t})).displayName=lb.displayName;const ub=Ke.forwardRef(({className:e,...t},s)=>K.jsx(cb,{ref:s,className:Aa("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));ub.displayName=cb.displayName;const hb=e=>({star:kr,award:Ps,trophy:Mr,target:Cr,crown:Hs,gem:er,medal:or,user:Or}[e]||kr);function mb(){var e,t;const{userProfile:s}=Uu(),[r,a]=Ke.useState(null),[n,i]=Ke.useState(!0),[o,l]=Ke.useState([]),{toast:c}=At();Ke.useEffect(()=>{s&&d()},[s]);const d=async()=>{if(s)try{const{data:e}=await Fu.from("gamification_points").select("points").eq("user_id",s.id),t=(null==e?void 0:e.reduce((e,t)=>e+t.points,0))||0,{data:r}=await Fu.from("gamification_levels").select("*").order("min_points");let n=null,i=null;if(r){for(let e=0;e<r.length;e++){const s=r[e];if(t>=s.min_points&&t<=s.max_points){n=s,i=r[e+1]||null;break}}!n&&r.length>0&&(n=r[0],i=r[1]||null)}const{data:o}=await Fu.from("user_badges").select("\n          awarded_at,\n          gamification_badges (\n            id, name, description, icon\n          )\n        ").eq("user_id",s.id).order("awarded_at",{ascending:!1}),c=(null==o?void 0:o.map(e=>({id:e.gamification_badges.id,name:e.gamification_badges.name,description:e.gamification_badges.description,icon:e.gamification_badges.icon,awarded_at:e.awarded_at})))||[],{data:d}=await Fu.from("user_trophies").select("\n          awarded_at, period_month, period_year,\n          gamification_trophies (\n            id, name, description, icon\n          )\n        ").eq("user_id",s.id).order("awarded_at",{ascending:!1}),u=(null==d?void 0:d.map(e=>({id:e.gamification_trophies.id,name:e.gamification_trophies.name,description:e.gamification_trophies.description,icon:e.gamification_trophies.icon,awarded_at:e.awarded_at,period_month:e.period_month,period_year:e.period_year})))||[],{data:h}=await Fu.from("gamification_points").select("points, reason, created_at").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(10),{data:m}=await Fu.from("user_stores").select("\n          is_primary,\n          stores (\n            id, name, code, is_active\n          )\n        ").eq("user_id",s.id).order("is_primary",{ascending:!1}),p=(m||[]).map(e=>{var t,s,r,a;return{id:null==(t=e.stores)?void 0:t.id,name:null==(s=e.stores)?void 0:s.name,code:(null==(r=e.stores)?void 0:r.code)??null,is_active:(null==(a=e.stores)?void 0:a.is_active)??null,is_primary:Boolean(e.is_primary)}});l(p),a({totalPoints:t,currentLevel:n,nextLevel:i,badges:c,trophies:u,recentPoints:h||[]})}catch(e){c({title:"Erreur",description:"Impossible de charger les statistiques",variant:"destructive"})}finally{i(!1)}};if(n)return K.jsx("div",{className:"flex items-center justify-center h-64",children:"Chargement..."});if(!s||!r)return K.jsx("div",{className:"flex items-center justify-center h-64",children:"Aucune donne disponible"});const u=r.nextLevel?(r.totalPoints-((null==(e=r.currentLevel)?void 0:e.min_points)||0))/(r.nextLevel.min_points-((null==(t=r.currentLevel)?void 0:t.min_points)||0))*100:100;return K.jsxs("div",{className:"space-y-6",children:[K.jsxs("div",{children:[K.jsx("h1",{className:"text-3xl font-bold",children:"Mon Profil"}),K.jsx("p",{className:"text-muted-foreground",children:"Vos informations personnelles et rcompenses"})]}),K.jsxs(ty,{defaultValue:"overview",className:"space-y-4",children:[K.jsxs(sy,{children:[K.jsx(ry,{value:"overview",children:"Vue d'ensemble"}),K.jsx(ry,{value:"badges",children:"Mes Badges"}),K.jsx(ry,{value:"trophies",children:"Mes Trophes"}),K.jsx(ry,{value:"points",children:"Historique Points"}),K.jsx(ry,{value:"info",children:"Informations"})]}),K.jsxs(ay,{value:"overview",className:"space-y-6",children:[K.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsxs(Lh,{className:"flex items-center gap-4",children:[K.jsx(db,{className:"w-16 h-16",children:K.jsxs(ub,{children:[s.first_name.charAt(0),s.last_name.charAt(0)]})}),K.jsxs("div",{children:[K.jsxs("h2",{className:"text-xl font-bold",children:[s.first_name," ",s.last_name]}),K.jsx("p",{className:"text-muted-foreground",children:s.role})]})]})}),K.jsx(Fh,{className:"space-y-4",children:r.currentLevel&&K.jsxs("div",{className:"space-y-2",children:[K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("div",{className:"flex items-center gap-2",children:[(()=>{const e=hb(r.currentLevel.icon);return K.jsx(e,{className:"w-5 h-5",style:{color:r.currentLevel.color}})})(),K.jsxs("span",{className:"font-medium",style:{color:r.currentLevel.color},children:["Niveau ",r.currentLevel.name]})]}),K.jsxs("span",{className:"text-sm text-muted-foreground",children:[r.totalPoints," points"]})]}),r.nextLevel&&K.jsxs("div",{className:"space-y-2",children:[K.jsx(Lj,{value:u,className:"h-2"}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.nextLevel.min_points-r.totalPoints," points pour atteindre ",r.nextLevel.name]})]})]})})]}),K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsx(Lh,{children:"Mes Rcompenses"})}),K.jsx(Fh,{children:K.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[K.jsxs("div",{children:[K.jsx("div",{className:"text-2xl font-bold text-primary",children:r.totalPoints}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Points Total"})]}),K.jsxs("div",{children:[K.jsx("div",{className:"text-2xl font-bold text-primary",children:r.badges.length}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Badges"})]}),K.jsxs("div",{children:[K.jsx("div",{className:"text-2xl font-bold text-primary",children:r.trophies.length}),K.jsx("p",{className:"text-sm text-muted-foreground",children:"Trophes"})]})]})})]})]}),K.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Ps,{className:"w-5 h-5"}),"Badges Rcents"]})}),K.jsx(Fh,{children:r.badges.length>0?K.jsx("div",{className:"space-y-3",children:r.badges.slice(0,3).map(e=>{const t=hb(e.icon);return K.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-muted/50",children:[K.jsx(t,{className:"w-8 h-8 text-primary"}),K.jsxs("div",{className:"flex-1",children:[K.jsx("p",{className:"font-medium",children:e.name}),K.jsx("p",{className:"text-sm text-muted-foreground",children:e.description}),K.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(e.awarded_at).toLocaleDateString()})]})]},e.id)})}):K.jsx("p",{className:"text-muted-foreground text-center py-4",children:"Aucun badge obtenu"})})]}),K.jsxs(Rh,{children:[K.jsx(Ih,{children:K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Mr,{className:"w-5 h-5"}),"Trophes Rcents"]})}),K.jsx(Fh,{children:r.trophies.length>0?K.jsx("div",{className:"space-y-3",children:r.trophies.slice(0,3).map(e=>{const t=hb(e.icon);return K.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-muted/50",children:[K.jsx(t,{className:"w-8 h-8 text-yellow-500"}),K.jsxs("div",{className:"flex-1",children:[K.jsx("p",{className:"font-medium",children:e.name}),K.jsx("p",{className:"text-sm text-muted-foreground",children:e.description}),K.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.period_month,"/",e.period_year," - ",new Date(e.awarded_at).toLocaleDateString()]})]})]},e.id)})}):K.jsx("p",{className:"text-muted-foreground text-center py-4",children:"Aucun trophe obtenu"})})]})]})]}),K.jsx(ay,{value:"badges",children:K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Tous mes Badges"}),K.jsx(qh,{children:"Les badges que vous avez obtenus au fil du temps"})]}),K.jsx(Fh,{children:r.badges.length>0?K.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.badges.map(e=>{const t=hb(e.icon);return K.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg border",children:[K.jsx(t,{className:"w-10 h-10 text-primary"}),K.jsxs("div",{className:"flex-1",children:[K.jsx("p",{className:"font-medium",children:e.name}),K.jsx("p",{className:"text-sm text-muted-foreground",children:e.description}),K.jsx(Jh,{variant:"secondary",className:"mt-1",children:new Date(e.awarded_at).toLocaleDateString()})]})]},e.id)})}):K.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Aucun badge obtenu pour le moment"})})]})}),K.jsx(ay,{value:"trophies",children:K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Tous mes Trophes"}),K.jsx(qh,{children:"Les trophes que vous avez remports"})]}),K.jsx(Fh,{children:r.trophies.length>0?K.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.trophies.map(e=>{const t=hb(e.icon);return K.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg border bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20",children:[K.jsx(t,{className:"w-10 h-10 text-yellow-500"}),K.jsxs("div",{className:"flex-1",children:[K.jsx("p",{className:"font-medium",children:e.name}),K.jsx("p",{className:"text-sm text-muted-foreground",children:e.description}),K.jsxs("div",{className:"flex gap-2 mt-1",children:[K.jsxs(Jh,{variant:"secondary",children:[e.period_month,"/",e.period_year]}),K.jsx(Jh,{variant:"secondary",children:new Date(e.awarded_at).toLocaleDateString()})]})]})]},e.id)})}):K.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Aucun trophe obtenu pour le moment"})})]})}),K.jsx(ay,{value:"points",children:K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsxs(Lh,{className:"flex items-center gap-2",children:[K.jsx(Er,{className:"w-5 h-5"}),"Historique des Points"]}),K.jsx(qh,{children:"Vos dernires activits gnratrices de points"})]}),K.jsx(Fh,{children:r.recentPoints.length>0?K.jsx("div",{className:"space-y-3",children:r.recentPoints.map((e,t)=>K.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[K.jsxs("div",{className:"flex-1",children:[K.jsx("p",{className:"font-medium",children:e.reason}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:[new Date(e.created_at).toLocaleDateString(),"  ",new Date(e.created_at).toLocaleTimeString()]})]}),K.jsxs(Jh,{variant:e.points>=0?"default":"destructive",children:[e.points>=0?"+":"",e.points," pts"]})]},t))}):K.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Aucune activit de points enregistre"})})]})}),K.jsx(ay,{value:"info",children:K.jsxs(Rh,{children:[K.jsxs(Ih,{children:[K.jsx(Lh,{children:"Informations Personnelles"}),K.jsx(qh,{children:"Vos donnes de profil (non modifiables)"})]}),K.jsxs(Fh,{className:"space-y-4",children:[K.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx(Or,{className:"w-5 h-5 text-muted-foreground"}),K.jsxs("div",{children:[K.jsx("p",{className:"text-sm font-medium",children:"Nom complet"}),K.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.first_name," ",s.last_name]})]})]}),K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx(nr,{className:"w-5 h-5 text-muted-foreground"}),K.jsxs("div",{children:[K.jsx("p",{className:"text-sm font-medium",children:"Email"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]})]}),s.phone&&K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx(pr,{className:"w-5 h-5 text-muted-foreground"}),K.jsxs("div",{children:[K.jsx("p",{className:"text-sm font-medium",children:"Tlphone"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:s.phone})]})]}),K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx(Hs,{className:"w-5 h-5 text-muted-foreground"}),K.jsxs("div",{children:[K.jsx("p",{className:"text-sm font-medium",children:"Rle"}),K.jsx(Jh,{variant:"outline",children:s.role})]})]}),K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx(Cr,{className:"w-5 h-5 text-muted-foreground"}),K.jsxs("div",{children:[K.jsx("p",{className:"text-sm font-medium",children:"Statut"}),K.jsx(Jh,{variant:"active"===s.status?"default":"secondary",children:"active"===s.status?"Actif":s.status})]})]}),K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx(Rs,{className:"w-5 h-5 text-muted-foreground"}),K.jsxs("div",{children:[K.jsx("p",{className:"text-sm font-medium",children:"Membre depuis"}),K.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})]})]}),K.jsx("div",{className:"space-y-3 pt-4",children:K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx(ir,{className:"w-5 h-5 text-muted-foreground"}),K.jsxs("div",{children:[K.jsx("p",{className:"text-sm font-medium",children:"Mes Magasins"}),o.length>0?K.jsx("div",{className:"mt-2 space-y-2",children:o.map(e=>K.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/50",children:[K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx("span",{className:"font-medium",children:e.name}),e.code&&K.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",e.code,")"]})]}),K.jsxs("div",{className:"flex items-center gap-2",children:[e.is_primary&&K.jsx(Jh,{variant:"secondary",children:"Principal"}),!e.is_active&&K.jsx(Jh,{variant:"outline",children:"Inactif"})]})]},e.id))}):K.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Aucun magasin assign"})]})]})})]})]})})]})]})}const pb=()=>{const e=vo();return Ke.useEffect(()=>{},[e.pathname]),K.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:K.jsxs("div",{className:"text-center",children:[K.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),K.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),K.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},fb=new ki,xb=()=>K.jsx(Ci,{client:fb,children:K.jsxs(Ln,{children:[K.jsx(za,{}),K.jsx(dn,{}),K.jsx($o,{children:K.jsx(Wu,{children:K.jsxs(Do,{children:[K.jsx(Po,{path:"/",element:K.jsx(Mh,{})}),K.jsx(Po,{path:"/login",element:K.jsx(Uh,{})}),K.jsx(Po,{path:"/pending",element:K.jsx(jj,{})}),K.jsx(Po,{path:"/admin",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(Vh,{})})})}),K.jsx(Po,{path:"/dashboard",element:K.jsx(Vu,{allowedRoles:["Vendeur","Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(tp,{})})})}),K.jsx(Po,{path:"/products",element:K.jsx(Vu,{allowedRoles:["Vendeur","Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(ny,{})})})}),K.jsx(Po,{path:"/arrivals",element:K.jsx(Vu,{allowedRoles:["Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(ly,{})})})}),K.jsx(Po,{path:"/purchases",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(uy,{})})})}),K.jsx(Po,{path:"/sales",element:K.jsx(Vu,{allowedRoles:["Vendeur","Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(fy,{})})})}),K.jsx(Po,{path:"/returns",element:K.jsx(Vu,{allowedRoles:["Vendeur","Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(gy,{})})})}),K.jsx(Po,{path:"/transfers",element:K.jsx(Vu,{allowedRoles:["Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(gj,{})})})}),K.jsx(Po,{path:"/inventory",element:K.jsx(Vu,{allowedRoles:["Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(yy,{})})})}),K.jsx(Po,{path:"/users",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(qy,{})})})}),K.jsx(Po,{path:"/stores",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(rj,{})})})}),K.jsx(Po,{path:"/suppliers",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(nj,{})})})}),K.jsx(Po,{path:"/financial",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(oj,{})})})}),K.jsx(Po,{path:"/analytics",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(pj,{})})})}),K.jsx(Po,{path:"/reports",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(fj,{})})})}),K.jsx(Po,{path:"/settings",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(xj,{})})})}),K.jsx(Po,{path:"/configuration",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(yj,{})})})}),K.jsx(Po,{path:"/gamification",element:K.jsx(Vu,{allowedRoles:["Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(bj,{})})})}),K.jsx(Po,{path:"/profile",element:K.jsx(Vu,{allowedRoles:["Vendeur","Manager","Admin","SuperAdmin"],children:K.jsx(Eh,{children:K.jsx(mb,{})})})}),K.jsx(Po,{path:"*",element:K.jsx(pb,{})})]})})})]})});$(document.getElementById("root")).render(K.jsx(xb,{}));
